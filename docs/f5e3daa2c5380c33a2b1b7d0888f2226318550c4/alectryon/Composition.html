<!DOCTYPE html>
<html class="alectryon-standalone"><head><title>Composition.v</title><meta charset="utf-8"><meta content="Alectryon v1.0" name="generator"><link href="alectryon.css" rel="stylesheet"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" /><script src="alectryon.js"></script><style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight .c { color: #555753; font-style: italic } /* Comment */
.highlight .err { color: #a40000; border: 1px solid #cc0000 } /* Error */
.highlight .g { color: #000000 } /* Generic */
.highlight .k { color: #8f5902 } /* Keyword */
.highlight .l { color: #2e3436 } /* Literal */
.highlight .n { color: #000000 } /* Name */
.highlight .o { color: #000000 } /* Operator */
.highlight .x { color: #2e3436 } /* Other */
.highlight .p { color: #000000 } /* Punctuation */
.highlight .ch { color: #555753; font-weight: bold; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #555753; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #3465a4; font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: #555753; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #555753; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3465a4; font-weight: bold; font-style: italic } /* Comment.Special */
.highlight .gd { color: #a40000 } /* Generic.Deleted */
.highlight .ge { color: #000000; font-style: italic } /* Generic.Emph */
.highlight .gr { color: #a40000 } /* Generic.Error */
.highlight .gh { color: #a40000; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #4e9a06 } /* Generic.Inserted */
.highlight .go { color: #000000; font-style: italic } /* Generic.Output */
.highlight .gp { color: #8f5902 } /* Generic.Prompt */
.highlight .gs { color: #000000; font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #000000; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #000000; font-style: italic } /* Generic.Traceback */
.highlight .kc { color: #204a87; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #4e9a06; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #4e9a06; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #204a87 } /* Keyword.Pseudo */
.highlight .kr { color: #8f5902 } /* Keyword.Reserved */
.highlight .kt { color: #204a87 } /* Keyword.Type */
.highlight .ld { color: #2e3436 } /* Literal.Date */
.highlight .m { color: #2e3436 } /* Literal.Number */
.highlight .s { color: #ad7fa8 } /* Literal.String */
.highlight .na { color: #c4a000 } /* Name.Attribute */
.highlight .nb { color: #75507b } /* Name.Builtin */
.highlight .nc { color: #204a87 } /* Name.Class */
.highlight .no { color: #ce5c00 } /* Name.Constant */
.highlight .nd { color: #3465a4; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #c4a000; text-decoration: underline } /* Name.Entity */
.highlight .ne { color: #cc0000 } /* Name.Exception */
.highlight .nf { color: #a40000 } /* Name.Function */
.highlight .nl { color: #3465a4; font-weight: bold } /* Name.Label */
.highlight .nn { color: #000000 } /* Name.Namespace */
.highlight .nx { color: #000000 } /* Name.Other */
.highlight .py { color: #000000 } /* Name.Property */
.highlight .nt { color: #a40000 } /* Name.Tag */
.highlight .nv { color: #ce5c00 } /* Name.Variable */
.highlight .ow { color: #8f5902 } /* Operator.Word */
.highlight .w { color: #d3d7cf; text-decoration: underline } /* Text.Whitespace */
.highlight .mb { color: #2e3436 } /* Literal.Number.Bin */
.highlight .mf { color: #2e3436 } /* Literal.Number.Float */
.highlight .mh { color: #2e3436 } /* Literal.Number.Hex */
.highlight .mi { color: #2e3436 } /* Literal.Number.Integer */
.highlight .mo { color: #2e3436 } /* Literal.Number.Oct */
.highlight .sa { color: #ad7fa8 } /* Literal.String.Affix */
.highlight .sb { color: #ad7fa8 } /* Literal.String.Backtick */
.highlight .sc { color: #ad7fa8; font-weight: bold } /* Literal.String.Char */
.highlight .dl { color: #ad7fa8 } /* Literal.String.Delimiter */
.highlight .sd { color: #ad7fa8 } /* Literal.String.Doc */
.highlight .s2 { color: #ad7fa8 } /* Literal.String.Double */
.highlight .se { color: #ad7fa8; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #ad7fa8; text-decoration: underline } /* Literal.String.Heredoc */
.highlight .si { color: #ce5c00 } /* Literal.String.Interpol */
.highlight .sx { color: #ad7fa8 } /* Literal.String.Other */
.highlight .sr { color: #ad7fa8 } /* Literal.String.Regex */
.highlight .s1 { color: #ad7fa8 } /* Literal.String.Single */
.highlight .ss { color: #8f5902 } /* Literal.String.Symbol */
.highlight .bp { color: #5c35cc } /* Name.Builtin.Pseudo */
.highlight .fm { color: #a40000 } /* Name.Function.Magic */
.highlight .vc { color: #ce5c00 } /* Name.Variable.Class */
.highlight .vg { color: #ce5c00; text-decoration: underline } /* Name.Variable.Global */
.highlight .vi { color: #ce5c00 } /* Name.Variable.Instance */
.highlight .vm { color: #ce5c00 } /* Name.Variable.Magic */
.highlight .il { color: #2e3436 } /* Literal.Number.Integer.Long */</style></head><body><article class="alectryon-root alectryon-centered alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc alectryon-coqdoc"><div class="alectryon-header">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running <a href="https://coq.inria.fr/">Coq</a>+<a href="https://github.com/ejgallego/coq-serapi">SerAPI</a> v8.12.0+0.12.0. Coq sources are in this panel; goals and messages will appear in the other. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus.</div><pre class="alectryon-io"><!-- Generator: Alectryon v1.0 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Require Import</span>
  List Coq.Vectors.Fin FinFun
  Arith.Compare_dec Lia
  Program
  .</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Import</span> ListNotations.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">From</span> CasperCBC
  <span class="kn">Require Import</span>
    Preamble ListExtras FinExtras FinFunExtras
    VLSM.Common VLSM.Composition VLSM.Equivocation
    VLSM.Equivocators.Common VLSM.Equivocators.Projections
    VLSM.Equivocators.MessageProperties
    .</span></span></span></pre><div class="doc">
<a id="lab1"></a><h2 class="section">equivocator composition</h2>
<div class="paragraph"> </div>

Given a composition <tt>X</tt> of VLSMs, we can model equivocator behavior by
creating a <i>equivocator composition</i> which replaces each component of <tt>X</tt>
<div class="paragraph"> </div>

with its equivocator version and strengthens the composition constraint to
allow no (additional) equivocations, that is, all messages being received
must have been previously sent by one of the (equivocator) VLSMs in the
composition.

</div><pre class="alectryon-io"><!-- Generator: Alectryon v1.0 --></pre><div class="doc">
<a id="lab2"></a><h2 class="section">Extracting equivocator traces from equivocator composition traces</h2>

To recover the equivocator trace for the regular composition <tt>X</tt> from
the traces of the equivocator composition, we'll assume that only the
first state copy of each machine is observable in the composition
and we ignore the activity corresponding to any other state copy,
including the forks.

<div class="paragraph"> </div>

This amounts to removing from the trace all transitions in which the
state copy index is not 1, forgetting the additional components of
the label, and keeping only the copy of index 1 for each machine.

<div class="paragraph"> </div>
</div><pre class="alectryon-io"><!-- Generator: Alectryon v1.0 --><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">fully_equivocating_composition</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Context</span> {<span class="nv">message</span> : <span class="kt">Type</span>}
  {<span class="nv">index</span> <span class="nv">equiv_index</span> <span class="nv">nequiv_index</span> : <span class="kt">Type</span>}
  (<span class="nv">partition</span> : index -&gt; equiv_index + nequiv_index)
  (<span class="nv">rpartition</span> : equiv_index + nequiv_index -&gt; index)
  (<span class="nv">Hlpartition</span> : <span class="kr">forall</span> <span class="nv">i</span> : index, i = rpartition (partition i))
  (<span class="nv">Hrpartition</span> : <span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index, partition (rpartition i) = i)
  {<span class="nv">IndEqDec</span> : EqDecision index}
  (<span class="nv">IM</span> : index -&gt; VLSM message)
  (<span class="nv">Hbs</span> : <span class="kr">forall</span> <span class="nv">i</span> : index, has_been_sent_capability (IM i))
  (<span class="nv">i0</span> : index)
  (<span class="nv">X</span> := free_composite_vlsm IM i0)
  .</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
<span class="c">(* TODO: this follows from sumbool instance *)</span>
</span></span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chk0" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chk0"><span class="highlight"><span class="kn">Instance</span> <span class="nf">partition_eq_dec</span> : EqDecision (equiv_index + nequiv_index).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqDecision (equiv_index + nequiv_index)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chk1" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chk1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqDecision (equiv_index + nequiv_index)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chk2" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chk2"><span class="highlight"><span class="nb">intros</span> x y.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(equiv_index + nequiv_index)%type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Decision (x = y)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chk3" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chk3"><span class="highlight"><span class="nb">destruct</span> (decide (rpartition x = rpartition y)).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(equiv_index + nequiv_index)%type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">rpartition x = rpartition y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Decision (x = y)</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Composition-v-chk4" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(equiv_index + nequiv_index)%type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">rpartition x &lt;&gt; rpartition y</span></span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Composition-v-chk4"><hr></label><div class="goal-conclusion"><span class="highlight">Decision (x = y)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chk5" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chk5"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(equiv_index + nequiv_index)%type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">rpartition x = rpartition y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Decision (x = y)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chk6" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chk6"><span class="highlight"><span class="nb">left</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(equiv_index + nequiv_index)%type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">rpartition x = rpartition y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x = y</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chk7" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chk7"><span class="highlight"><span class="nb">apply</span> (<span class="nb">f_equal</span> partition) <span class="kr">in</span> e.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(equiv_index + nequiv_index)%type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">partition (rpartition x) =
partition (rpartition y)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x = y</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">    </span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chk8" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chk8"><span class="highlight"><span class="kp">repeat</span> <span class="nb">rewrite</span> Hrpartition <span class="kr">in</span> e.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(equiv_index + nequiv_index)%type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">e</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x = y</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">assumption</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chk9" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chk9"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(equiv_index + nequiv_index)%type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">rpartition x &lt;&gt; rpartition y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Decision (x = y)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chka" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chka"><span class="highlight"><span class="nb">right</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(equiv_index + nequiv_index)%type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">rpartition x &lt;&gt; rpartition y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x &lt;&gt; y</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chkb" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chkb"><span class="highlight"><span class="nb">intro</span> contra; <span class="nb">elim</span> n.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(equiv_index + nequiv_index)%type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">rpartition x &lt;&gt; rpartition y</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">contra</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">rpartition x = rpartition y</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chkc" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chkc"><span class="highlight"><span class="nb">subst</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(equiv_index + nequiv_index)%type</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">rpartition y &lt;&gt; rpartition y</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">rpartition y = rpartition y</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Defined</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">equivocator_IM</span>
  (<span class="nv">i</span> : index)
  : VLSM message
  :=
  <span class="kr">match</span> (partition i) <span class="kr">with</span>
  | inl _ =&gt; equivocator_vlsm (IM i)
  | inr _ =&gt; (IM i)
  <span class="kr">end</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chkd" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chkd"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">equivocator_Hbs</span>
  (<span class="nv">i</span> : index)
  :  has_been_sent_capability (equivocator_IM i).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">has_been_sent_capability (equivocator_IM i)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chke" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chke"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">has_been_sent_capability (equivocator_IM i)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chkf" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chkf"><span class="highlight"><span class="nb">unfold</span> equivocator_IM.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">has_been_sent_capability
  <span class="kr">match</span> partition i <span class="kr">with</span>
  | inl _ =&gt; equivocator_vlsm (IM i)
  | inr _ =&gt; IM i
  <span class="kr">end</span></span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chk10" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chk10"><span class="highlight"><span class="nb">destruct</span> (partition i) <span class="kr">as</span> [eqv | neqv] <span class="nb">eqn</span>:Hi.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">eqv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">partition i = inl eqv</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">has_been_sent_capability (equivocator_vlsm (IM i))</span></div></blockquote><div class="coq-extra-goals"><input class="coq-extra-goal-toggle" id="Composition-v-chk11" style="display: none" type="checkbox"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">neqv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">partition i = inr neqv</span></span></span></span></div></div><label class="goal-separator coq-extra-goal-label" for="Composition-v-chk11"><hr></label><div class="goal-conclusion"><span class="highlight">has_been_sent_capability (IM i)</span></div></blockquote></div></div></div></small><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chk12" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chk12"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">eqv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">partition i = inl eqv</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">has_been_sent_capability (equivocator_vlsm (IM i))</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chk13" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chk13"><span class="highlight"><span class="nb">apply</span> equivocator_has_been_sent_capability.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">eqv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">partition i = inl eqv</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">has_been_sent_capability (IM i)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Hbs.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp">  </span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chk14" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chk14"><span class="highlight">-</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">neqv</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">partition i = inr neqv</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">has_been_sent_capability (IM i)</span></div></blockquote></div></div></small><span class="coq-wsp"> </span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="nb">apply</span> Hbs.</span></span><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">

</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Context</span>
  (<span class="nv">index_listing</span> : list index)
  (<span class="nv">finite_index</span> : Listing index_listing)
  .</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">equivocators_no_equivocations_constraint</span>
  (<span class="nv">l</span> : composite_label equivocator_IM)
  (<span class="nv">som</span> : composite_state equivocator_IM * option message)
  : <span class="kt">Prop</span>
  :=
  no_equivocations equivocator_IM i0 (free_constraint equivocator_IM) finite_index equivocator_Hbs l som.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">equivocators_no_equivocations_vlsm</span>
  : VLSM message
  :=
  composite_vlsm equivocator_IM i0 equivocators_no_equivocations_constraint.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">equivocators_state_project</span>
  (<span class="nv">s</span> : vstate equivocators_no_equivocations_vlsm)
  (<span class="nv">i</span> : index)
  : vstate (IM i)
  :=
  <span class="kr">match</span> (partition i) <span class="kr">as</span> s1
    <span class="kr">return</span> (vstate <span class="kr">match</span> s1 <span class="kr">with</span>
         | inl _ =&gt; equivocator_vlsm (IM i)
         | inr _ =&gt; IM i
         <span class="kr">end</span> -&gt; vstate (IM i))
  <span class="kr">with</span>
  | inl _ =&gt;
      <span class="kr">fun</span> <span class="nv">si0</span> : vstate (equivocator_vlsm (IM i)) =&gt;
      projT2 si0 (of_nat_lt (Hzero (IM i) si0))
  | inr _ =&gt; <span class="kr">fun</span> <span class="nv">si0</span> : vstate (IM i) =&gt; si0
  <span class="kr">end</span> (s i).</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">equivocators_label_project</span>
  (<span class="nv">l</span> : vlabel equivocators_no_equivocations_vlsm)
  : option (vlabel X)
  :=
  <span class="kr">let</span> (<span class="nv">i</span>, li) := l <span class="kr">in</span>
  <span class="kr">match</span> (partition i) <span class="kr">as</span> s1
    <span class="kr">return</span> (vlabel <span class="kr">match</span> s1 <span class="kr">with</span>
         | inl _ =&gt; equivocator_vlsm (IM i)
         | inr _ =&gt; IM i
         <span class="kr">end</span> -&gt; option (vlabel X))
  <span class="kr">with</span>
  | inl _ =&gt;
      <span class="kr">fun</span> <span class="nv">li0</span> : vlabel (equivocator_vlsm (IM i)) =&gt;
      <span class="kr">let</span> (<span class="nv">lj</span>, dj) := li0 <span class="kr">in</span>
      <span class="kr">match</span> dj <span class="kr">with</span>
      | Existing _ <span class="mi">0</span> false =&gt;
        Some (existT _ i lj)
      | _ =&gt; None
      <span class="kr">end</span>
  | inr _ =&gt; <span class="kr">fun</span> <span class="nv">li0</span> : vlabel (IM i) =&gt;
    Some (existT _ i li0)
  <span class="kr">end</span> li.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">equivocators_transition_item_project</span>
  (<span class="nv">item</span> : vtransition_item equivocators_no_equivocations_vlsm)
  : option (vtransition_item X)
  :=
  <span class="kr">match</span> item <span class="kr">with</span> {| l := el; input := iom; output := oom; destination := s |} =&gt;
    <span class="kr">match</span>  equivocators_label_project el <span class="kr">with</span>
    | None =&gt; None
    | Some lx =&gt;
      <span class="kr">let</span> <span class="nv">sx</span> := equivocators_state_project s <span class="kr">in</span>
      Some {| l := lx; input := iom; output := oom; destination := sx |}
    <span class="kr">end</span>
  <span class="kr">end</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">equivocators_trace_project</span>
  (<span class="nv">tr</span> : list (vtransition_item equivocators_no_equivocations_vlsm))
  : list (vtransition_item X)
  := map_option equivocators_transition_item_project tr.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chk15" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chk15"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">equivocators_initial_state_project</span>
  (<span class="nv">es</span> : vstate equivocators_no_equivocations_vlsm)
  (<span class="nv">Hes</span> : vinitial_state_prop equivocators_no_equivocations_vlsm es)
  : vinitial_state_prop X (equivocators_state_project es).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">index_listing</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">finite_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Listing index_listing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">es</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">vstate equivocators_no_equivocations_vlsm</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hes</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">vinitial_state_prop
  equivocators_no_equivocations_vlsm es</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">vinitial_state_prop X (equivocators_state_project es)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chk16" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chk16"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">index_listing</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">finite_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Listing index_listing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">es</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">vstate equivocators_no_equivocations_vlsm</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hes</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">vinitial_state_prop
  equivocators_no_equivocations_vlsm es</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">vinitial_state_prop X (equivocators_state_project es)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Admitted</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chk17" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chk17"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">equivocators_protocol_state_project</span>
  (<span class="nv">es</span> : vstate equivocators_no_equivocations_vlsm)
  (<span class="nv">om</span> : option message)
  (<span class="nv">Hes</span> : protocol_prop equivocators_no_equivocations_vlsm (es, om))
  : protocol_state_prop X (equivocators_state_project es)
  /\ option_protocol_message_prop X om.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">index_listing</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">finite_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Listing index_listing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">es</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">vstate equivocators_no_equivocations_vlsm</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">om</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">option message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hes</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">protocol_prop equivocators_no_equivocations_vlsm
  (es, om)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">protocol_state_prop X (equivocators_state_project es) /\
option_protocol_message_prop X om</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chk18" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chk18"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">index_listing</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">finite_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Listing index_listing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">es</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">vstate equivocators_no_equivocations_vlsm</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">om</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">option message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hes</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">protocol_prop equivocators_no_equivocations_vlsm
  (es, om)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">protocol_state_prop X (equivocators_state_project es) /\
option_protocol_message_prop X om</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Admitted</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chk19" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chk19"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">equivocators_protocol_trace_project</span>
  (<span class="nv">is</span> : vstate equivocators_no_equivocations_vlsm)
  (<span class="nv">tr</span> : list (vtransition_item equivocators_no_equivocations_vlsm))
  (<span class="nv">Htr</span> : finite_protocol_trace_from equivocators_no_equivocations_vlsm <span class="kr">is</span> tr)
  : finite_protocol_trace_from X
    (equivocators_state_project <span class="kr">is</span>) (equivocators_trace_project tr).</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">index_listing</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">finite_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Listing index_listing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">is</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">vstate equivocators_no_equivocations_vlsm</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">tr</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list
  (vtransition_item
     equivocators_no_equivocations_vlsm)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Htr</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finite_protocol_trace_from
  equivocators_no_equivocations_vlsm <span class="kr">is</span> tr</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">finite_protocol_trace_from X
  (equivocators_state_project <span class="kr">is</span>)
  (equivocators_trace_project tr)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><input class="coq-toggle" id="Composition-v-chk1a" style="display: none" type="checkbox"><label class="coq-input" for="Composition-v-chk1a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="coq-output"><div class="coq-output-sticky-wrapper"><div class="coq-goals"><blockquote class="coq-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">message, index, equiv_index, nequiv_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">partition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; equiv_index + nequiv_index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">rpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">equiv_index + nequiv_index -&gt; index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
i = rpartition (partition i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hrpartition</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : equiv_index + nequiv_index,
partition (rpartition i) = i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IndEqDec</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqDecision index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IM</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index -&gt; VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hbs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : index,
has_been_sent_capability (IM i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">X</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">free_composite_vlsm IM i0</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">VLSM message</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">index_listing</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list index</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">finite_index</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Listing index_listing</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">is</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">vstate equivocators_no_equivocations_vlsm</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">tr</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list
  (vtransition_item
     equivocators_no_equivocations_vlsm)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Htr</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finite_protocol_trace_from
  equivocators_no_equivocations_vlsm <span class="kr">is</span> tr</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">finite_protocol_trace_from X
  (equivocators_state_project <span class="kr">is</span>)
  (equivocators_trace_project tr)</span></div></blockquote></div></div></small><span class="coq-wsp">
</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">Admitted</span>.</span></span><span class="coq-wsp">
</span></span><span class="coq-wsp"><span class="highlight">  

</span></span><span class="coq-sentence"><span class="coq-input"><span class="highlight"><span class="kn">End</span> <span class="nf">fully_equivocating_composition</span>.</span></span></span></pre></article></body></html>