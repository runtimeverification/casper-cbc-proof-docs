
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module CasperCBC.VLSM.Plans</title>
<meta name="description" content="Documentation of Coq module CasperCBC.VLSM.Plans" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module CasperCBC.VLSM.Plans</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Import</span> <span class="id">ListNotations</span>.<br/>
<span class="id">From</span> <span class="id">CasperCBC</span><br/>
&nbsp;&nbsp;<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">ListExtras</span> <span class="id"><a href="CasperCBC.VLSM.Common.html">VLSM.Common</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="plans">plans</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">message</span> : <span class="kwd">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">T</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM_type">VLSM_type</a></span> <span class="id">message</span>}.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Record</span> <span class="id"><a name="plan_item">plan_item</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id"><a name="label_a">label_a</a></span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#label">label</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="input_a">input_a</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#plans.message">message</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#plans">plans</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="apply_plans">apply_plans</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">message</span> : <span class="kwd">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vplan_item">vplan_item</a></span> {<span class="id">message</span> : <span class="kwd">Type</span>} (<span class="id">X</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>) : <span class="kwd">Type</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= @<span class="id"><a href="CasperCBC.VLSM.Plans.html#plan_item">plan_item</a></span> <span class="id">message</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#type">type</a></span> <span class="id">X</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="vplan">vplan</a></span> {<span class="id">message</span> : <span class="kwd">Type</span>} (<span class="id">X</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>) : <span class="kwd">Type</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="CasperCBC.VLSM.Plans.html#vplan_item">vplan_item</a></span> <span class="id">X</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="apply_plan_folder">apply_plan_folder</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a</span> : <span class="id"><a href="CasperCBC.VLSM.Plans.html#vplan_item">vplan_item</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sl</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#vtransition_item">vtransition_item</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#vtransition_item">vtransition_item</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">s</span>, <span class="id">items</span>) := <span class="id">sl</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">a</span> <span class="kwd">with</span> {| <span class="id"><a href="CasperCBC.VLSM.Plans.html#label_a">label_a</a></span> := <span class="id">l</span>'; <span class="id"><a href="CasperCBC.VLSM.Plans.html#input_a">input_a</a></span> := <span class="id">input</span>' |} =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="kwd">dest</span>, <span class="id">out</span>) := (<span class="id"><a href="CasperCBC.VLSM.Common.html#vtransition">vtransition</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span> <span class="id">l</span>' (<span class="id">s</span>, <span class="id">input</span>')) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">dest</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, {| <span class="id"><a href="CasperCBC.VLSM.Common.html#l">l</a></span> := <span class="id">l</span>';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#input">input</a></span> := <span class="id">input</span>';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#output">output</a></span> := <span class="id">out</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#destination">destination</a></span> := <span class="kwd">dest</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|} :: <span class="id">items</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="apply_plan_folder_additive">apply_plan_folder_additive</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">start</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">aitems</span> : <span class="id"><a href="CasperCBC.VLSM.Plans.html#vplan">vplan</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">seed_items</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#vtransition_item">vtransition_item</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">let</span> (<span class="id">final</span>, <span class="id">items</span>) := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan_folder">apply_plan_folder</a></span> (<span class="id">start</span>, []) <span class="id">aitems</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan_folder">apply_plan_folder</a></span> (<span class="id">start</span>, <span class="id">seed_items</span>) <span class="id">aitems</span> = (<span class="id">final</span>, <span class="id">items</span> ++ <span class="id">seed_items</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof238')">Proof.</div>
<div class="proofscript" id="proof238">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="tactic">dependent</span> <span class="id">seed_items</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">aitems</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan_folder">apply_plan_folder</a></span> (<span class="id">start</span>, []) <span class="id">aitems</span>) <span class="kwd">as</span> (<span class="id">afinal</span>, <span class="id">aitemsX</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHaitems</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>. <span class="tactic">simpl</span>. <span class="tactic">destruct</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#vtransition">vtransition</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span> <span class="id">label_a0</span> (<span class="id">afinal</span>, <span class="id">input_a0</span>)) <span class="kwd">as</span> (<span class="kwd">dest</span>, <span class="id">out</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="apply_plan">apply_plan</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">start</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a</span> : <span class="id"><a href="CasperCBC.VLSM.Plans.html#vplan">vplan</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#vtransition_item">vtransition_item</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>) * <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">final</span>, <span class="id">items</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan_folder">apply_plan_folder</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#pair">pair</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>) <span class="id">_</span> <span class="id">start</span> []) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev">rev</a></span> <span class="id">a</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev">rev</a></span> <span class="id">items</span>, <span class="id">final</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="apply_plan_last">apply_plan_last</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">start</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a</span> : <span class="id"><a href="CasperCBC.VLSM.Plans.html#vplan">vplan</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">after_a</span> := <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan">apply_plan</a></span> <span class="id">start</span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#last">last</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#destination">destination</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">after_a</span>)) <span class="id">start</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">after_a</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof239')">Proof.</div>
<div class="proofscript" id="proof239">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">a</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev_ind">rev_ind</a></span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">after_a</span>. <span class="tactic">clear</span> <span class="id">after_a</span>. <span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan">apply_plan</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev_unit">rev_unit</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan">apply_plan</a></span> <span class="kwd">in</span> <span class="id">IHa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan_folder">apply_plan_folder</a></span> (<span class="id">start</span>, []) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev">rev</a></span> <span class="id">a</span>)) <span class="kwd">as</span> (<span class="id">final</span>, <span class="id">items</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eqn</span>:<span class="id">Happly</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IHa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#vtransition">vtransition</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span> <span class="id">label_a0</span> (<span class="id">final</span>, <span class="id">input_a0</span>)) <span class="kwd">as</span> (<span class="kwd">dest</span>,<span class="id">out</span>) <span class="id">eqn</span>:<span class="id">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#last_last">last_last</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="apply_plan_app">apply_plan_app</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">start</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a</span> <span class="id">a</span>' : <span class="id"><a href="CasperCBC.VLSM.Plans.html#vplan">vplan</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan">apply_plan</a></span> <span class="id">start</span> (<span class="id">a</span> ++ <span class="id">a</span>') =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">aitems</span>, <span class="id">afinal</span>) := <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan">apply_plan</a></span> <span class="id">start</span> <span class="id">a</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">a</span>'<span class="id">items</span>, <span class="id">a</span>'<span class="id">final</span>) := <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan">apply_plan</a></span> <span class="id">afinal</span> <span class="id">a</span>' <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">aitems</span> ++ <span class="id">a</span>'<span class="id">items</span>, <span class="id">a</span>'<span class="id">final</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof240')">Proof.</div>
<div class="proofscript" id="proof240">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan">apply_plan</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev_app_distr">rev_app_distr</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right_app">fold_right_app</a></span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan_folder">apply_plan_folder</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#pair">pair</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>) <span class="id">_</span> <span class="id">start</span> []) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev">rev</a></span>  <span class="id">a</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">afinal</span>, <span class="id">aitems</span>) <span class="id">eqn</span>:<span class="id">Ha</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">fold_right</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan_folder">apply_plan_folder</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#pair">pair</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>) <span class="id">_</span> <span class="id">afinal</span> []) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev">rev</a></span> <span class="id">a</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">final</span>, <span class="id">items</span>) <span class="id">eqn</span>:<span class="id">Ha</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> - <span class="id">Ha</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan_folder_additive">apply_plan_folder_additive</a></span> <span class="id">afinal</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev">rev</a></span> <span class="id">a</span>') <span class="id">aitems</span>) <span class="kwd">as</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Ha</span>' <span class="kwd">in</span> <span class="id">Hadd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hadd</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev_app_distr">rev_app_distr</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="finite_protocol_plan_from">finite_protocol_plan_from</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a</span> : <span class="id"><a href="CasperCBC.VLSM.Plans.html#vplan">vplan</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_from">finite_protocol_trace_from</a></span> <span class="id">_</span> <span class="id">s</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan">apply_plan</a></span> <span class="id">s</span> <span class="id">a</span>)).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="finite_protocol_plan_from_app_iff">finite_protocol_plan_from_app_iff</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a</span> <span class="id">b</span> : <span class="id"><a href="CasperCBC.VLSM.Plans.html#vplan">vplan</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s_a</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan">apply_plan</a></span> <span class="id">s</span> <span class="id">a</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Plans.html#finite_protocol_plan_from">finite_protocol_plan_from</a></span> <span class="id">s</span> <span class="id">a</span> /\ <span class="id"><a href="CasperCBC.VLSM.Plans.html#finite_protocol_plan_from">finite_protocol_plan_from</a></span> <span class="id">s_a</span> <span class="id">b</span> &lt;-&gt; <span class="id"><a href="CasperCBC.VLSM.Plans.html#finite_protocol_plan_from">finite_protocol_plan_from</a></span> <span class="id">s</span> (<span class="id">a</span> ++ <span class="id">b</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof241')">Proof.</div>
<div class="proofscript" id="proof241">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#finite_protocol_plan_from">finite_protocol_plan_from</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan_app">apply_plan_app</a></span> <span class="id">s</span> <span class="id">a</span> <span class="id">b</span>) <span class="kwd">as</span> <span class="id">Happ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan_last">apply_plan_last</a></span> <span class="id">s</span> <span class="id">a</span>) <span class="kwd">as</span> <span class="id">Hlst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan">apply_plan</a></span> <span class="id">s</span> <span class="id">a</span>) <span class="kwd">as</span> (<span class="id">aitems</span>, <span class="id">afinal</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">unfold</span> <span class="id">s_a</span> <span class="kwd">in</span> *. <span class="tactic">clear</span> <span class="id">s_a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan">apply_plan</a></span> <span class="id">afinal</span> <span class="id">b</span>) <span class="kwd">as</span> (<span class="id">bitems</span>, <span class="id">bfinal</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Happ</span>. <span class="tactic">simpl</span>. <span class="tactic">clear</span> <span class="id">Happ</span>. <span class="tactic">subst</span> <span class="id">afinal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_from_app_iff">finite_protocol_trace_from_app_iff</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="transition_item_to_plan_item">transition_item_to_plan_item</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">item</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vtransition_item">vtransition_item</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Plans.html#vplan_item">vplan_item</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= {| <span class="id"><a href="CasperCBC.VLSM.Plans.html#label_a">label_a</a></span> := <span class="id"><a href="CasperCBC.VLSM.Common.html#l">l</a></span> <span class="id">item</span>; <span class="id"><a href="CasperCBC.VLSM.Plans.html#input_a">input_a</a></span> := <span class="id"><a href="CasperCBC.VLSM.Common.html#input">input</a></span> <span class="id">item</span> |}.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="trace_to_plan">trace_to_plan</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">items</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#vtransition_item">vtransition_item</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Plans.html#vplan">vplan</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#transition_item_to_plan_item">transition_item_to_plan_item</a></span> <span class="id">items</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="trace_to_plan_to_trace">trace_to_plan_to_trace</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">tr</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#vtransition_item">vtransition_item</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Htr</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_from">finite_protocol_trace_from</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span> <span class="id">s</span> <span class="id">tr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan">apply_plan</a></span> <span class="id">s</span> (<span class="id"><a href="CasperCBC.VLSM.Plans.html#trace_to_plan">trace_to_plan</a></span> <span class="id">tr</span>)) = <span class="id">tr</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof242')">Proof.</div>
<div class="proofscript" id="proof242">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">tr</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev_ind">rev_ind</a></span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_from_app_iff">finite_protocol_trace_from_app_iff</a></span> <span class="kwd">in</span> <span class="id">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htr</span> <span class="kwd">as</span> [<span class="id">Htr</span> <span class="id">Hx</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtr</span> <span class="id">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#trace_to_plan">trace_to_plan</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan_app">apply_plan_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#trace_to_plan">trace_to_plan</a></span> <span class="kwd">in</span> <span class="id">IHtr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan_last">apply_plan_last</a></span> <span class="id">s</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#transition_item_to_plan_item">transition_item_to_plan_item</a></span> <span class="id">tr</span>)) <span class="kwd">as</span> <span class="id">Hlst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan">apply_plan</a></span> <span class="id">s</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#transition_item_to_plan_item">transition_item_to_plan_item</a></span> <span class="id">tr</span>)) <span class="kwd">as</span> (<span class="id">aitems</span>, <span class="id">afinal</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hx</span>. <span class="tactic">subst</span>. <span class="tactic">clear</span> -<span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#transition_item_to_plan_item">transition_item_to_plan_item</a></span>. <span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan">apply_plan</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span> <span class="kwd">as</span> [<span class="id">_</span> <span class="id">Ht</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="CasperCBC.VLSM.Common.html#vtransition">vtransition</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.message">message</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span> <span class="id">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#pair">pair</a></span> (@<span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.message">message</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#last">last</a></span> (@<span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.message">message</a></span> (@<span class="id"><a href="CasperCBC.VLSM.Common.html#type">type</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.message">message</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (@<span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.message">message</a></span> (@<span class="id"><a href="CasperCBC.VLSM.Common.html#type">type</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.message">message</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.message">message</a></span> (@<span class="id"><a href="CasperCBC.VLSM.Common.html#type">type</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.message">message</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id"><a href="CasperCBC.VLSM.Common.html#destination">destination</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.message">message</a></span> (@<span class="id"><a href="CasperCBC.VLSM.Common.html#type">type</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.message">message</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>)) <span class="id">tr</span>) <span class="id">s</span>) <span class="id">iom</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">s0</span>, <span class="id">oom</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="finite_protocol_trace_from_to_plan">finite_protocol_trace_from_to_plan</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">tr</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#vtransition_item">vtransition_item</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Htr</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_from">finite_protocol_trace_from</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span> <span class="id">s</span> <span class="id">tr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Plans.html#finite_protocol_plan_from">finite_protocol_plan_from</a></span> <span class="id">s</span> (<span class="id"><a href="CasperCBC.VLSM.Plans.html#trace_to_plan">trace_to_plan</a></span> <span class="id">tr</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof243')">Proof.</div>
<div class="proofscript" id="proof243">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#finite_protocol_plan_from">finite_protocol_plan_from</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#trace_to_plan_to_trace">trace_to_plan_to_trace</a></span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="finite_protocol_plan_iff">finite_protocol_plan_iff</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a</span> : <span class="id"><a href="CasperCBC.VLSM.Plans.html#vplan">vplan</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Plans.html#finite_protocol_plan_from">finite_protocol_plan_from</a></span> <span class="id">s</span> <span class="id">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span> <span class="id">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> (<span class="kwd">fun</span> <span class="id">ai</span> =&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#option_protocol_message_prop">option_protocol_message_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span> (<span class="id"><a href="CasperCBC.VLSM.Plans.html#input_a">input_a</a></span> <span class="id">ai</span>)) <span class="id">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="kwd">forall</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">prefa</span> <span class="id">suffa</span> : <span class="id"><a href="CasperCBC.VLSM.Plans.html#vplan">vplan</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ai</span> : <span class="id"><a href="CasperCBC.VLSM.Plans.html#vplan_item">vplan_item</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Heqa</span> : <span class="id">a</span> = <span class="id">prefa</span> ++ [<span class="id">ai</span>] ++ <span class="id">suffa</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">lst</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan">apply_plan</a></span> <span class="id">s</span> <span class="id">prefa</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#vvalid">vvalid</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span> (<span class="id"><a href="CasperCBC.VLSM.Plans.html#label_a">label_a</a></span> <span class="id">ai</span>) (<span class="id">lst</span>, <span class="id"><a href="CasperCBC.VLSM.Plans.html#input_a">input_a</a></span> <span class="id">ai</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof244')">Proof.</div>
<div class="proofscript" id="proof244">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">a</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev_ind">rev_ind</a></span>; <span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">intros</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( <span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#finite_protocol_plan_from_app_iff">finite_protocol_plan_from_app_iff</a></span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">Ha</span> <span class="id">Hx</span>]; <span class="tactic">apply</span> <span class="id">IHa</span> <span class="kwd">in</span> <span class="id">Ha</span> <span class="kwd">as</span> <span class="id">Ha</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">inversion</span> <span class="id">H</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">prefa</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Heqa</span>; <span class="tactic">discriminate</span> <span class="id">Heqa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">Hs</span> <span class="id">_</span>]. <span class="id">constructor</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">Ha</span>' <span class="kwd">as</span> [<span class="id">Hs</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">Ha</span>' <span class="kwd">as</span> [<span class="id">_</span> [<span class="id">Hmsgs</span> <span class="id">_</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_app">Forall_app</a></span>. <span class="tactic">split</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">constructor</span>. <span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#finite_protocol_plan_from">finite_protocol_plan_from</a></span> <span class="kwd">in</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan">apply_plan</a></span> <span class="id">s</span> <span class="id">a</span>)) <span class="kwd">as</span> <span class="id">lst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan">apply_plan</a></span> <span class="kwd">in</span> <span class="id">Hx</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ( <span class="id"><a href="CasperCBC.VLSM.Common.html#vtransition">vtransition</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span> <span class="id">label_a0</span> (<span class="id">lst</span>, <span class="id">input_a0</span>)) <span class="kwd">as</span> (<span class="kwd">dest</span>, <span class="id">out</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hx</span>. <span class="tactic">inversion</span> <span class="id">Hx</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H6</span> <span class="kwd">as</span> [[<span class="id">_</span> [<span class="id">Hom</span> <span class="id">_</span>]] <span class="id">_</span>]. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">assert</span> (<span class="id">Hsuffa</span> : <span class="id">suffa</span> = [] \/ <span class="id">suffa</span> &lt;&gt; []) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">destruct</span> <span class="id">suffa</span>; <span class="tactic">try</span> (<span class="id">left</span>; <span class="tactic">congruence</span>); <span class="id">right</span>; <span class="tactic">congruence</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hsuffa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">subst</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span> <span class="kwd">in</span> <span class="id">Heqa</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> <span class="id">Heqa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_inj_tail">app_inj_tail</a></span> <span class="kwd">in</span> <span class="id">Heqa</span>. <span class="tactic">destruct</span> <span class="id">Heqa</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">lst</span>. <span class="tactic">clear</span> <span class="id">lst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan">apply_plan</a></span> <span class="id">s</span> <span class="id">prefa</span>)) <span class="kwd">as</span> <span class="id">lst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#finite_protocol_plan_from">finite_protocol_plan_from</a></span> <span class="kwd">in</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan">apply_plan</a></span> <span class="kwd">in</span> <span class="id">Hx</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">ai</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> ( <span class="id"><a href="CasperCBC.VLSM.Common.html#vtransition">vtransition</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span> <span class="id">label_a0</span> (<span class="id">lst</span>, <span class="id">input_a0</span>)) <span class="kwd">as</span> (<span class="kwd">dest</span>, <span class="id">out</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hx</span>. <span class="tactic">inversion</span> <span class="id">Hx</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H6</span> <span class="kwd">as</span> [[<span class="id">_</span> [<span class="id">_</span> <span class="id">Hv</span>]] <span class="id">_</span>]. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#exists_last">exists_last</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">suffa</span>' [<span class="id">x</span>' <span class="id">Heq</span>]]. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span> <span class="kwd">in</span> <span class="id">Heqa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_inj_tail">app_inj_tail</a></span> <span class="kwd">in</span> <span class="id">Heqa</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span> <span class="kwd">in</span> <span class="id">Heqa</span>. <span class="tactic">destruct</span> <span class="id">Heqa</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Ha</span>' <span class="kwd">as</span> [<span class="id">_</span> [<span class="id">_</span> <span class="id">Ha</span>']].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Ha</span>' <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>). <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">Hs</span> [<span class="id">Hinput</span> <span class="id">Hvalid</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_app">Forall_app</a></span> <span class="kwd">in</span> <span class="id">Hinput</span>. <span class="tactic">destruct</span> <span class="id">Hinput</span> <span class="kwd">as</span> [<span class="id">Hinput</span> <span class="id">Hinput_ai</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#finite_protocol_plan_from_app_iff">finite_protocol_plan_from_app_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Ha</span> : <span class="id"><a href="CasperCBC.VLSM.Plans.html#finite_protocol_plan_from">finite_protocol_plan_from</a></span> <span class="id">s</span> <span class="id">a</span>); <span class="tactic">try</span> (<span class="tactic">split</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">IHa</span>; <span class="tactic">repeat</span> <span class="tactic">split</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hvalid</span> <span class="id">prefa</span> (<span class="id">suffa</span> ++ [<span class="id">x</span>]) <span class="id">ai</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> &lt;- <span class="id">Heqa</span> <span class="kwd">in</span> <span class="id">Hvalid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hvalid</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>). <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#finite_protocol_plan_from">finite_protocol_plan_from</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hvalid</span> <span class="id">a</span> [] <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_assoc">app_assoc</a></span> <span class="kwd">in</span> <span class="id">Hvalid</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_nil_r">app_nil_r</a></span> <span class="kwd">in</span> <span class="id">Hvalid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hvalid</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">remember</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan">apply_plan</a></span> <span class="id">s</span> <span class="id">a</span>)) <span class="kwd">as</span> <span class="id">sa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan">apply_plan</a></span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#vtransition">vtransition</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span> <span class="id">label_a0</span> (<span class="id">sa</span>, <span class="id">input_a0</span>)) <span class="kwd">as</span> (<span class="kwd">dest</span>, <span class="id">out</span>) <span class="id">eqn</span>:<span class="id">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Forall_inv">Forall_inv</a></span> <span class="kwd">in</span> <span class="id">Hinput_ai</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hinput_ai</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#finite_protocol_plan_from">finite_protocol_plan_from</a></span> <span class="kwd">in</span> <span class="id">Ha</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_ptrace_last_pstate">finite_ptrace_last_pstate</a></span> <span class="kwd">in</span> <span class="id">Ha</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plan_last">apply_plan_last</a></span> <span class="id">s</span> <span class="id">a</span>) <span class="kwd">as</span> <span class="id">Hlst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hlst</span>. <span class="tactic">rewrite</span> <span class="id">Hlst</span> <span class="kwd">in</span> <span class="id">Ha</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">Heqsa</span> <span class="kwd">in</span> <span class="id">Ha</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="id">constructor</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">out</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#pair">pair</a></span> (@<span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.message">message</a></span> (@<span class="id"><a href="CasperCBC.VLSM.Common.html#type">type</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.message">message</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.message">message</a></span>) <span class="kwd">dest</span> <span class="id">out</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#vtransition">vtransition</a></span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans.X">X</a></span> <span class="id">label_a0</span> (<span class="id">sa</span>, <span class="id">input_a0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Ha</span> <span class="kwd">as</span> [<span class="id">_oma</span> <span class="id">Hsa</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hinput_ai</span> <span class="kwd">as</span> [<span class="id">_s</span> <span class="id">Hinput_a0</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_generated">protocol_generated</a></span> <span class="kwd">with</span> <span class="id">_oma</span> <span class="id">_s</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CasperCBC.VLSM.Plans.html#apply_plans">apply_plans</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
