<!DOCTYPE html>
<html class="alectryon-standalone"><head><title>StreamExtras.v</title><meta charset="utf-8"><meta content="Alectryon" name="generator"><link href="alectryon.css" rel="stylesheet"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" /><script src="alectryon.js"></script><style type="text/css">pre { line-height: 125%; }
td.linenos pre { color: #000000; background-color: #f0f0f0; padding-left: 5px; padding-right: 5px; }
span.linenos { color: #000000; background-color: #f0f0f0; padding-left: 5px; padding-right: 5px; }
td.linenos pre.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight .c { color: #555753; font-style: italic } /* Comment */
.highlight .err { color: #a40000; border: 1px solid #cc0000 } /* Error */
.highlight .g { color: #000000 } /* Generic */
.highlight .k { color: #8f5902 } /* Keyword */
.highlight .l { color: #2e3436 } /* Literal */
.highlight .n { color: #000000 } /* Name */
.highlight .o { color: #000000 } /* Operator */
.highlight .x { color: #2e3436 } /* Other */
.highlight .p { color: #000000 } /* Punctuation */
.highlight .ch { color: #555753; font-weight: bold; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #555753; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #3465a4; font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: #555753; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #555753; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3465a4; font-weight: bold; font-style: italic } /* Comment.Special */
.highlight .gd { color: #a40000 } /* Generic.Deleted */
.highlight .ge { color: #000000; font-style: italic } /* Generic.Emph */
.highlight .gr { color: #a40000 } /* Generic.Error */
.highlight .gh { color: #a40000; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #4e9a06 } /* Generic.Inserted */
.highlight .go { color: #000000; font-style: italic } /* Generic.Output */
.highlight .gp { color: #8f5902 } /* Generic.Prompt */
.highlight .gs { color: #000000; font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #000000; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #000000; font-style: italic } /* Generic.Traceback */
.highlight .kc { color: #204a87; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #4e9a06; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #4e9a06; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #204a87 } /* Keyword.Pseudo */
.highlight .kr { color: #8f5902 } /* Keyword.Reserved */
.highlight .kt { color: #204a87 } /* Keyword.Type */
.highlight .ld { color: #2e3436 } /* Literal.Date */
.highlight .m { color: #2e3436 } /* Literal.Number */
.highlight .s { color: #ad7fa8 } /* Literal.String */
.highlight .na { color: #c4a000 } /* Name.Attribute */
.highlight .nb { color: #75507b } /* Name.Builtin */
.highlight .nc { color: #204a87 } /* Name.Class */
.highlight .no { color: #ce5c00 } /* Name.Constant */
.highlight .nd { color: #3465a4; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #c4a000; text-decoration: underline } /* Name.Entity */
.highlight .ne { color: #cc0000 } /* Name.Exception */
.highlight .nf { color: #a40000 } /* Name.Function */
.highlight .nl { color: #3465a4; font-weight: bold } /* Name.Label */
.highlight .nn { color: #000000 } /* Name.Namespace */
.highlight .nx { color: #000000 } /* Name.Other */
.highlight .py { color: #000000 } /* Name.Property */
.highlight .nt { color: #a40000 } /* Name.Tag */
.highlight .nv { color: #ce5c00 } /* Name.Variable */
.highlight .ow { color: #8f5902 } /* Operator.Word */
.highlight .w { color: #d3d7cf; text-decoration: underline } /* Text.Whitespace */
.highlight .mb { color: #2e3436 } /* Literal.Number.Bin */
.highlight .mf { color: #2e3436 } /* Literal.Number.Float */
.highlight .mh { color: #2e3436 } /* Literal.Number.Hex */
.highlight .mi { color: #2e3436 } /* Literal.Number.Integer */
.highlight .mo { color: #2e3436 } /* Literal.Number.Oct */
.highlight .sa { color: #ad7fa8 } /* Literal.String.Affix */
.highlight .sb { color: #ad7fa8 } /* Literal.String.Backtick */
.highlight .sc { color: #ad7fa8; font-weight: bold } /* Literal.String.Char */
.highlight .dl { color: #ad7fa8 } /* Literal.String.Delimiter */
.highlight .sd { color: #ad7fa8 } /* Literal.String.Doc */
.highlight .s2 { color: #ad7fa8 } /* Literal.String.Double */
.highlight .se { color: #ad7fa8; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #ad7fa8; text-decoration: underline } /* Literal.String.Heredoc */
.highlight .si { color: #ce5c00 } /* Literal.String.Interpol */
.highlight .sx { color: #ad7fa8 } /* Literal.String.Other */
.highlight .sr { color: #ad7fa8 } /* Literal.String.Regex */
.highlight .s1 { color: #ad7fa8 } /* Literal.String.Single */
.highlight .ss { color: #8f5902 } /* Literal.String.Symbol */
.highlight .bp { color: #5c35cc } /* Name.Builtin.Pseudo */
.highlight .fm { color: #a40000 } /* Name.Function.Magic */
.highlight .vc { color: #ce5c00 } /* Name.Variable.Class */
.highlight .vg { color: #ce5c00; text-decoration: underline } /* Name.Variable.Global */
.highlight .vi { color: #ce5c00 } /* Name.Variable.Instance */
.highlight .vm { color: #ce5c00 } /* Name.Variable.Magic */
.highlight .il { color: #2e3436 } /* Literal.Number.Integer.Long */</style></head><body><article class="alectryon-root alectryon-windowed alectryon-coqdoc"><pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Require Import</span> List Streams Coq.Arith.Compare_dec.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Require Import</span> Lia.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Import</span> ListNotations.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">From</span> CasperCBC
<span class="kn">Require Import</span> Lib.ListExtras Preamble.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">recons</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">s</span> : Stream A)
  : Cons (hd s) (tl s) = s.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Cons (hd s) (tl s) = s</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Cons (hd s) (tl s) = s</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk2"><span class="highlight"><span class="nb">case</span> s.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">s</span> : Stream A),
Cons (hd (Cons a s)) (tl (Cons a s)) = Cons a s</span></div></blockquote></div></div></small><span class="alectryon-wsp">  </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk3"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">map_Cons</span>
  {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>}
  (<span class="nv">f</span> : A -&gt; B)
  (<span class="nv">x</span> : A)
  (<span class="nv">s</span> : Stream A)
  : map f (Cons x s) = Cons (f x) (map f s).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map f (Cons x s) = Cons (f x) (map f s)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk4"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map f (Cons x s) = Cons (f x) (map f s)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk5"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">map f (Cons x s) = Cons (f x) (map f s)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk6"><span class="highlight"><span class="nb">rewrite</span> &lt;- (recons (map f (Cons x s))).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Cons (hd (map f (Cons x s))) (tl (map f (Cons x s))) =
Cons (f x) (map f s)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">stream_app</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">prefix</span> : list A)
  (<span class="nv">suffix</span> : Stream A)
  : Stream A
  :=
  fold_right (@Cons A) suffix prefix.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">stream_app_cons</span> {<span class="nv">A</span>}
  (<span class="nv">a</span> : A)
  (<span class="nv">l</span> : Stream A)
  : stream_app [a] l = Cons a l
  := eq_refl.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk7"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_app_assoc</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> <span class="nv">m</span> : list A)
  (<span class="nv">n</span> : Stream A)
  : stream_app l (stream_app m n) = stream_app (l ++ m) n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_app l (stream_app m n) = stream_app (l ++ m) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk8"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_app l (stream_app m n) = stream_app (l ++ m) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk9"><span class="highlight"><span class="nb">induction</span> l; <span class="kp">try</span> <span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app l (stream_app m n) = stream_app (l ++ m) n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_app (a :: l) (stream_app m n) =
stream_app ((a :: l) ++ m) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chka"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app l (stream_app m n) = stream_app (l ++ m) n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Cons a (stream_app l (stream_app m n)) =
Cons a (stream_app (l ++ m) n)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkb"><span class="highlight"><span class="nb">apply</span> <span class="nb">f_equal</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app l (stream_app m n) = stream_app (l ++ m) n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_app l (stream_app m n) = stream_app (l ++ m) n</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">assumption</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkc"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_app_f_equal</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l1</span> <span class="nv">l2</span> : list A)
  (<span class="nv">s1</span> <span class="nv">s2</span> : Stream A)
  (<span class="nv">Hl</span> : l1 = l2)
  (<span class="nv">Hs</span> : EqSt s1 s2)
  : EqSt (stream_app l1 s1) (stream_app l2 s2).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">l1 = l2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt s1 s2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt (stream_app l1 s1) (stream_app l2 s2)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkd"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">l1 = l2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt s1 s2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt (stream_app l1 s1) (stream_app l2 s2)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chke"><span class="highlight"><span class="nb">subst</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt s1 s2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt (stream_app l2 s1) (stream_app l2 s2)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkf"><span class="highlight"><span class="nb">induction</span> l2; <span class="kp">try</span> <span class="bp">assumption</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt s1 s2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt (stream_app l2 s1) (stream_app l2 s2)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt (stream_app (a :: l2) s1)
  (stream_app (a :: l2) s2)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk10"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt s1 s2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt (stream_app l2 s1) (stream_app l2 s2)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt (Cons a (stream_app l2 s1))
  (Cons a (stream_app l2 s2))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk11"><span class="highlight"><span class="nb">constructor</span>; <span class="kp">try</span> <span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt s1 s2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt (stream_app l2 s1) (stream_app l2 s2)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt (tl (Cons a (stream_app l2 s1)))
  (tl (Cons a (stream_app l2 s2)))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">assumption</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk12"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_app_inj_l</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l1</span> <span class="nv">l2</span> : list A)
  (<span class="nv">s</span> : Stream A)
  (<span class="nv">Heq</span> : stream_app l1 s = stream_app l2 s)
  (<span class="nv">Heq_len</span> : length l1 = length l2)
  : l1 = l2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app l1 s = stream_app l2 s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq_len</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length l1 = length l2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">l1 = l2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk13"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app l1 s = stream_app l2 s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq_len</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length l1 = length l2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">l1 = l2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk14"><span class="highlight"><span class="nb">generalize dependent</span> l2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">l2</span> : list A,
stream_app l1 s = stream_app l2 s -&gt;
length l1 = length l2 -&gt; l1 = l2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk15"><span class="highlight"><span class="nb">induction</span> l1; <span class="nb">intros</span>; <span class="nb">destruct</span> l2; <span class="kp">try</span> <span class="bp">reflexivity</span>; <span class="kp">try</span> <span class="nb">inversion</span> Heq_len.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l2</span> : list A,
stream_app l1 s = stream_app l2 s -&gt;
length l1 = length l2 -&gt; l1 = l2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (a :: l1) s = stream_app (a0 :: l2) s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq_len</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length (a :: l1) = length (a0 :: l2)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length l1 = length l2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a :: l1 = a0 :: l2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk16"><span class="highlight"><span class="nb">inversion</span> Heq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l2</span> : list A,
stream_app l1 s = stream_app l2 s -&gt;
length l1 = length l2 -&gt; l1 = l2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (a :: l1) s = stream_app (a0 :: l2) s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq_len</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length (a :: l1) = length (a0 :: l2)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length l1 = length l2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a = a0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app l1 s = stream_app l2 s</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a0 :: l1 = a0 :: l2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk17"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l2</span> : list A,
stream_app l1 s = stream_app l2 s -&gt;
length l1 = length l2 -&gt; l1 = l2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (a :: l1) s = stream_app (a0 :: l2) s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq_len</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length (a :: l1) = length (a0 :: l2)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length l1 = length l2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a = a0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app l1 s = stream_app l2 s</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">l1 = l2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk18"><span class="highlight"><span class="nb">specialize</span> (IHl1 l2 H2 H0).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">l1 = l2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (a :: l1) s = stream_app (a0 :: l2) s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq_len</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length (a :: l1) = length (a0 :: l2)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length l1 = length l2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a = a0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app l1 s = stream_app l2 s</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">l1 = l2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">assumption</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">stream_prefix</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n</span> : nat)
  : list A
  := <span class="kr">match</span> n,l <span class="kr">with</span>
  | <span class="mi">0</span>,_ =&gt; []
  | S n, Cons a l =&gt; a :: stream_prefix l n
  <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk19"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_prefix_nth</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">s</span> : Stream A)
  (<span class="nv">n</span> : nat)
  (<span class="nv">i</span> : nat)
  (<span class="nv">Hi</span> : i &lt; n)
  : nth_error (stream_prefix s n) i = Some (Str_nth i s).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt; n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (stream_prefix s n) i = Some (Str_nth i s)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt; n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (stream_prefix s n) i = Some (Str_nth i s)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1b"><span class="highlight"><span class="nb">generalize dependent</span> n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
i &lt; n -&gt;
nth_error (stream_prefix s n) i = Some (Str_nth i s)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1c"><span class="highlight"><span class="nb">generalize dependent</span> s.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A) (<span class="nv">n</span> : nat),
i &lt; n -&gt;
nth_error (stream_prefix s n) i = Some (Str_nth i s)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1d"><span class="highlight"><span class="nb">induction</span> i; <span class="nb">intros</span> [a s] [|n] Hi; <span class="kp">try</span> <span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; <span class="mi">0</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (stream_prefix (Cons a s) <span class="mi">0</span>) <span class="mi">0</span> =
Some (Str_nth <span class="mi">0</span> (Cons a s))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk1e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A) (<span class="nv">n</span> : nat),
i &lt; n -&gt; nth_error (stream_prefix s n) i = Some (Str_nth i s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S i &lt; <span class="mi">0</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chk1e"><hr></label><div class="goal-conclusion"><span class="highlight">nth_error (stream_prefix (Cons a s) <span class="mi">0</span>) (S i) =
Some (Str_nth (S i) (Cons a s))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk1f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A) (<span class="nv">n</span> : nat),
i &lt; n -&gt; nth_error (stream_prefix s n) i = Some (Str_nth i s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S i &lt; S n</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chk1f"><hr></label><div class="goal-conclusion"><span class="highlight">nth_error (stream_prefix (Cons a s) (S n)) (S i) =
Some (Str_nth (S i) (Cons a s))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk20"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; <span class="mi">0</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (stream_prefix (Cons a s) <span class="mi">0</span>) <span class="mi">0</span> =
Some (Str_nth <span class="mi">0</span> (Cons a s))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">inversion</span> Hi.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk21"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A) (<span class="nv">n</span> : nat),
i &lt; n -&gt; nth_error (stream_prefix s n) i = Some (Str_nth i s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S i &lt; <span class="mi">0</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (stream_prefix (Cons a s) <span class="mi">0</span>) (S i) =
Some (Str_nth (S i) (Cons a s))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">inversion</span> Hi.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk22"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A) (<span class="nv">n</span> : nat),
i &lt; n -&gt; nth_error (stream_prefix s n) i = Some (Str_nth i s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S i &lt; S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (stream_prefix (Cons a s) (S n)) (S i) =
Some (Str_nth (S i) (Cons a s))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk23"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A) (<span class="nv">n</span> : nat),
i &lt; n -&gt; nth_error (stream_prefix s n) i = Some (Str_nth i s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S i &lt; S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (stream_prefix s n) i =
Some (Str_nth (S i) (Cons a s))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk24"><span class="highlight"><span class="nb">assert</span> (Hi&#39;: i &lt; n) <span class="bp">by</span> <span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A) (<span class="nv">n</span> : nat),
i &lt; n -&gt; nth_error (stream_prefix s n) i = Some (Str_nth i s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S i &lt; S n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt; n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (stream_prefix s n) i =
Some (Str_nth (S i) (Cons a s))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk25"><span class="highlight"><span class="nb">specialize</span> (IHi s n Hi&#39;).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (stream_prefix s n) i = Some (Str_nth i s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S i &lt; S n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt; n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (stream_prefix s n) i =
Some (Str_nth (S i) (Cons a s))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk26"><span class="highlight"><span class="nb">rewrite</span> IHi.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (stream_prefix s n) i = Some (Str_nth i s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S i &lt; S n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt; n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Some (Str_nth i s) = Some (Str_nth (S i) (Cons a s))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk27"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_prefix_EqSt</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">s1</span> <span class="nv">s2</span> : Stream A)
  (<span class="nv">Heq</span> : EqSt s1 s2)
  : <span class="kr">forall</span> <span class="nv">n</span> : nat, stream_prefix s1 n = stream_prefix s2 n .</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt s1 s2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
stream_prefix s1 n = stream_prefix s2 n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk28"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt s1 s2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
stream_prefix s1 n = stream_prefix s2 n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk29"><span class="highlight"><span class="nb">intro</span> n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt s1 s2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix s1 n = stream_prefix s2 n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk2a"><span class="highlight"><span class="nb">generalize dependent</span> s2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">s2</span> : Stream A,
EqSt s1 s2 -&gt; stream_prefix s1 n = stream_prefix s2 n</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk2b"><span class="highlight"><span class="nb">generalize dependent</span> s1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">s1</span> <span class="nv">s2</span> : Stream A,
EqSt s1 s2 -&gt; stream_prefix s1 n = stream_prefix s2 n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk2c"><span class="highlight"><span class="nb">induction</span> n; <span class="kp">try</span> <span class="bp">reflexivity</span>; <span class="nb">intros</span> (a1, s1) (a2,s2) Heq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s1</span> <span class="nv">s2</span> : Stream A,
EqSt s1 s2 -&gt; stream_prefix s1 n = stream_prefix s2 n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt (Cons a1 s1) (Cons a2 s2)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (Cons a1 s1) (S n) =
stream_prefix (Cons a2 s2) (S n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk2d"><span class="highlight"><span class="nb">inversion</span> Heq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s1</span> <span class="nv">s2</span> : Stream A,
EqSt s1 s2 -&gt; stream_prefix s1 n = stream_prefix s2 n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt (Cons a1 s1) (Cons a2 s2)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Cons a1 s1) = hd (Cons a2 s2)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt (tl (Cons a1 s1)) (tl (Cons a2 s2))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (Cons a1 s1) (S n) =
stream_prefix (Cons a2 s2) (S n)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk2e"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> H; <span class="nb">subst</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s1</span> <span class="nv">s2</span> : Stream A,
EqSt s1 s2 -&gt; stream_prefix s1 n = stream_prefix s2 n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt (Cons a2 s1) (Cons a2 s2)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt (tl (Cons a2 s1)) (tl (Cons a2 s2))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (Cons a2 s1) (S n) =
stream_prefix (Cons a2 s2) (S n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk2f"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s1</span> <span class="nv">s2</span> : Stream A,
EqSt s1 s2 -&gt; stream_prefix s1 n = stream_prefix s2 n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt (Cons a2 s1) (Cons a2 s2)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt (tl (Cons a2 s1)) (tl (Cons a2 s2))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a2 :: stream_prefix s1 n = a2 :: stream_prefix s2 n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk30"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s1</span> <span class="nv">s2</span> : Stream A,
EqSt s1 s2 -&gt; stream_prefix s1 n = stream_prefix s2 n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt (Cons a2 s1) (Cons a2 s2)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt (tl (Cons a2 s1)) (tl (Cons a2 s2))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix s1 n = stream_prefix s2 n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk31"><span class="highlight"><span class="nb">apply</span> IHn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s1</span> <span class="nv">s2</span> : Stream A,
EqSt s1 s2 -&gt; stream_prefix s1 n = stream_prefix s2 n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt (Cons a2 s1) (Cons a2 s2)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt (tl (Cons a2 s1)) (tl (Cons a2 s2))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt s1 s2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">assumption</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk32"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">EqSt_stream_prefix</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">s1</span> <span class="nv">s2</span> : Stream A)
  (<span class="nv">Hpref</span> : <span class="kr">forall</span> <span class="nv">n</span> : nat, stream_prefix s1 n = stream_prefix s2 n)
  : EqSt s1 s2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
stream_prefix s1 n = stream_prefix s2 n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt s1 s2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk33"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
stream_prefix s1 n = stream_prefix s2 n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt s1 s2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk34"><span class="highlight"><span class="nb">apply</span> ntheq_eqst.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
stream_prefix s1 n = stream_prefix s2 n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, Str_nth n s1 = Str_nth n s2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk35"><span class="highlight"><span class="nb">intro</span> n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
stream_prefix s1 n = stream_prefix s2 n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth n s1 = Str_nth n s2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk36"><span class="highlight"><span class="nb">assert</span> (Hlt : n &lt; S n) <span class="bp">by</span> <span class="nb">constructor</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
stream_prefix s1 n = stream_prefix s2 n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth n s1 = Str_nth n s2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk37"><span class="highlight"><span class="nb">assert</span> (HSome : Some (Str_nth n s1) = Some (Str_nth n s2)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
stream_prefix s1 n = stream_prefix s2 n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Some (Str_nth n s1) = Some (Str_nth n s2)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk38" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
stream_prefix s1 n = stream_prefix s2 n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; S n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HSome</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Some (Str_nth n s1) = Some (Str_nth n s2)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chk38"><hr></label><div class="goal-conclusion"><span class="highlight">Str_nth n s1 = Str_nth n s2</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk39"><span class="highlight">{</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
stream_prefix s1 n = stream_prefix s2 n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Some (Str_nth n s1) = Some (Str_nth n s2)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk3a"><span class="highlight"><span class="nb">rewrite</span> &lt;- (stream_prefix_nth  s1 (S n) n Hlt).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
stream_prefix s1 n = stream_prefix s2 n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (stream_prefix s1 (S n)) n =
Some (Str_nth n s2)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk3b"><span class="highlight"><span class="nb">rewrite</span> &lt;- (stream_prefix_nth  s2 (S n) n Hlt).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
stream_prefix s1 n = stream_prefix s2 n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (stream_prefix s1 (S n)) n =
nth_error (stream_prefix s2 (S n)) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk3c"><span class="highlight"><span class="nb">specialize</span> (Hpref (S n)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix s1 (S n) =
stream_prefix s2 (S n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (stream_prefix s1 (S n)) n =
nth_error (stream_prefix s2 (S n)) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk3d"><span class="highlight"><span class="nb">rewrite</span> Hpref.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix s1 (S n) =
stream_prefix s2 (S n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (stream_prefix s2 (S n)) n =
nth_error (stream_prefix s2 (S n)) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk3e"><span class="highlight">}</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
stream_prefix s1 n = stream_prefix s2 n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; S n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HSome</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Some (Str_nth n s1) = Some (Str_nth n s2)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth n s1 = Str_nth n s2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk3f"><span class="highlight"><span class="nb">inversion</span> HSome.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
stream_prefix s1 n = stream_prefix s2 n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; S n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HSome</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Some (Str_nth n s1) = Some (Str_nth n s2)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth n s1 = Str_nth n s2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth n s1 = Str_nth n s1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk40"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_prefix_in</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n</span> : nat)
  (<span class="nv">a</span> : A)
  (<span class="nv">Hin</span> : In a (stream_prefix l n))
  : <span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; n /\ Str_nth k l = a.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hin</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">In a (stream_prefix l n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; n /\ Str_nth k l = a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk41"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hin</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">In a (stream_prefix l n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; n /\ Str_nth k l = a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk42"><span class="highlight"><span class="nb">generalize dependent</span> a.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A,
In a (stream_prefix l n) -&gt;
<span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; n /\ Str_nth k l = a</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk43"><span class="highlight"><span class="nb">generalize dependent</span> l.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
In a (stream_prefix l n) -&gt;
<span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; n /\ Str_nth k l = a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk44"><span class="highlight"><span class="nb">induction</span> n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
In a (stream_prefix l <span class="mi">0</span>) -&gt;
<span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; <span class="mi">0</span> /\ Str_nth k l = a</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk45" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
In a (stream_prefix l n) -&gt; <span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; n /\ Str_nth k l = a</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chk45"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
In a (stream_prefix l (S n)) -&gt;
<span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; S n /\ Str_nth k l = a</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk46"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
In a (stream_prefix l <span class="mi">0</span>) -&gt;
<span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; <span class="mi">0</span> /\ Str_nth k l = a</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk47"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
<span class="kt">False</span> -&gt; <span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; <span class="mi">0</span> /\ Str_nth k l = a</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk48"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hin</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">False</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; <span class="mi">0</span> /\ Str_nth k l = a</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">contradiction</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk49"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
In a (stream_prefix l n) -&gt; <span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; n /\ Str_nth k l = a</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
In a (stream_prefix l (S n)) -&gt;
<span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; S n /\ Str_nth k l = a</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk4a"><span class="highlight"><span class="nb">intros</span> (b, l) a; <span class="nb">simpl</span>; <span class="nb">intro</span> Hin.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
In a (stream_prefix l n) -&gt; <span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; n /\ Str_nth k l = a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hin</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">b = a \/ In a (stream_prefix l n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; S n /\ Str_nth k (Cons b l) = a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk4b"><span class="highlight"><span class="nb">destruct</span> Hin <span class="kr">as</span> [Heq | Hin]; <span class="nb">subst</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
In a (stream_prefix l n) -&gt; <span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; n /\ Str_nth k l = a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; S n /\ Str_nth k (Cons a l) = a</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk4c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
In a (stream_prefix l n) -&gt; <span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; n /\ Str_nth k l = a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hin</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">In a (stream_prefix l n)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chk4c"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; S n /\ Str_nth k (Cons b l) = a</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk4d"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
In a (stream_prefix l n) -&gt; <span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; n /\ Str_nth k l = a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; S n /\ Str_nth k (Cons a l) = a</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk4e"><span class="highlight"><span class="kr">exists</span> <span class="mi">0</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
In a (stream_prefix l n) -&gt; <span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; n /\ Str_nth k l = a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; S n /\ Str_nth <span class="mi">0</span> (Cons a l) = a</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk4f"><span class="highlight"><span class="nb">split</span>; <span class="kp">try</span> <span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
In a (stream_prefix l n) -&gt; <span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; n /\ Str_nth k l = a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; S n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk50"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : Stream A) (<span class="nv">a</span> : A),
In a (stream_prefix l n) -&gt; <span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; n /\ Str_nth k l = a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hin</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">In a (stream_prefix l n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; S n /\ Str_nth k (Cons b l) = a</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk51"><span class="highlight"><span class="nb">specialize</span> (IHn l a Hin).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; n /\ Str_nth k l = a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hin</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">In a (stream_prefix l n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; S n /\ Str_nth k (Cons b l) = a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk52"><span class="highlight"><span class="nb">destruct</span> IHn <span class="kr">as</span> [k [Hlt Heq]].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth k l = a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hin</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">In a (stream_prefix l n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat, k &lt; S n /\ Str_nth k (Cons b l) = a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk53"><span class="highlight"><span class="kr">exists</span> (<span class="nv">S</span> <span class="nv">k</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth k l = a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hin</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">In a (stream_prefix l n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">S k &lt; S n /\ Str_nth (S k) (Cons b l) = a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk54"><span class="highlight"><span class="nb">split</span>; <span class="kp">try</span> <span class="bp">assumption</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth k l = a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hin</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">In a (stream_prefix l n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">S k &lt; S n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk55"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_prefix_app_l</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : list A)
  (<span class="nv">s</span> : Stream A)
  (<span class="nv">n</span> : nat)
  (<span class="nv">Hle</span> : n &lt;= length l)
  : stream_prefix (stream_app l s) n = list_prefix l n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt;= length l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (stream_app l s) n = list_prefix l n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk56"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt;= length l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (stream_app l s) n = list_prefix l n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk57"><span class="highlight"><span class="nb">generalize dependent</span> n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
n &lt;= length l -&gt;
stream_prefix (stream_app l s) n = list_prefix l n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk58"><span class="highlight"><span class="nb">induction</span> l; <span class="nb">intros</span> [|n] Hle; <span class="kp">try</span> <span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n &lt;= length []</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (stream_app [] s) (S n) =
list_prefix [] (S n)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk59" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
n &lt;= length l -&gt; stream_prefix (stream_app l s) n = list_prefix l n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n &lt;= length (a :: l)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chk59"><hr></label><div class="goal-conclusion"><span class="highlight">stream_prefix (stream_app (a :: l) s) (S n) =
list_prefix (a :: l) (S n)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk5a"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n &lt;= length []</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (stream_app [] s) (S n) =
list_prefix [] (S n)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">inversion</span> Hle.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk5b"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
n &lt;= length l -&gt; stream_prefix (stream_app l s) n = list_prefix l n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n &lt;= length (a :: l)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (stream_app (a :: l) s) (S n) =
list_prefix (a :: l) (S n)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk5c"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> Hle.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
n &lt;= length l -&gt; stream_prefix (stream_app l s) n = list_prefix l n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n &lt;= S (length l)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (stream_app (a :: l) s) (S n) =
list_prefix (a :: l) (S n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk5d"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
n &lt;= length l -&gt; stream_prefix (stream_app l s) n = list_prefix l n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n &lt;= S (length l)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a :: stream_prefix (stream_app l s) n =
a :: list_prefix l n</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk5e"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
n &lt;= length l -&gt; stream_prefix (stream_app l s) n = list_prefix l n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n &lt;= S (length l)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (stream_app l s) n = list_prefix l n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk5f"><span class="highlight"><span class="nb">apply</span> IHl.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
n &lt;= length l -&gt; stream_prefix (stream_app l s) n = list_prefix l n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n &lt;= S (length l)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n &lt;= length l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk60"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_prefix_app_r</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : list A)
  (<span class="nv">s</span> : Stream A)
  (<span class="nv">n</span> : nat)
  (<span class="nv">Hge</span> : n &gt;= length l)
  : stream_prefix (stream_app l s) n = l ++ stream_prefix s (n - length l).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hge</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &gt;= length l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (stream_app l s) n =
l ++ stream_prefix s (n - length l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk61"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hge</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &gt;= length l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (stream_app l s) n =
l ++ stream_prefix s (n - length l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk62"><span class="highlight"><span class="nb">generalize dependent</span> l.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">l</span> : list A,
n &gt;= length l -&gt;
stream_prefix (stream_app l s) n =
l ++ stream_prefix s (n - length l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk63"><span class="highlight"><span class="nb">generalize dependent</span> s.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A) (<span class="nv">l</span> : list A),
n &gt;= length l -&gt;
stream_prefix (stream_app l s) n =
l ++ stream_prefix s (n - length l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk64"><span class="highlight"><span class="nb">induction</span> n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A) (<span class="nv">l</span> : list A),
<span class="mi">0</span> &gt;= length l -&gt;
stream_prefix (stream_app l s) <span class="mi">0</span> =
l ++ stream_prefix s (<span class="mi">0</span> - length l)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk65" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A) (<span class="nv">l</span> : list A),
n &gt;= length l -&gt;
stream_prefix (stream_app l s) n = l ++ stream_prefix s (n - length l)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chk65"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A) (<span class="nv">l</span> : list A),
S n &gt;= length l -&gt;
stream_prefix (stream_app l s) (S n) =
l ++ stream_prefix s (S n - length l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk66"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A) (<span class="nv">l</span> : list A),
<span class="mi">0</span> &gt;= length l -&gt;
stream_prefix (stream_app l s) <span class="mi">0</span> =
l ++ stream_prefix s (<span class="mi">0</span> - length l)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk67"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hge</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &gt;= length l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (stream_app l s) <span class="mi">0</span> =
l ++ stream_prefix s (<span class="mi">0</span> - length l)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk68"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hge</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &gt;= length l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[] = l ++ []</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk69"><span class="highlight"><span class="nb">destruct</span> l <span class="kr">as</span> [|a l]; <span class="kp">try</span> <span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hge</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &gt;= length (a :: l)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[] = (a :: l) ++ []</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk6a"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> Hge.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hge</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &gt;= S (length l)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[] = (a :: l) ++ []</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">inversion</span> Hge.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk6b"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A) (<span class="nv">l</span> : list A),
n &gt;= length l -&gt;
stream_prefix (stream_app l s) n = l ++ stream_prefix s (n - length l)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A) (<span class="nv">l</span> : list A),
S n &gt;= length l -&gt;
stream_prefix (stream_app l s) (S n) =
l ++ stream_prefix s (S n - length l)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk6c"><span class="highlight"><span class="nb">intros</span> s [| a l] Hge; <span class="kp">try</span> <span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A) (<span class="nv">l</span> : list A),
n &gt;= length l -&gt;
stream_prefix (stream_app l s) n = l ++ stream_prefix s (n - length l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hge</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n &gt;= length (a :: l)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (stream_app (a :: l) s) (S n) =
(a :: l) ++ stream_prefix s (S n - length (a :: l))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk6d"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A) (<span class="nv">l</span> : list A),
n &gt;= length l -&gt;
stream_prefix (stream_app l s) n = l ++ stream_prefix s (n - length l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hge</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n &gt;= length (a :: l)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a :: stream_prefix (stream_app l s) n =
a :: l ++ stream_prefix s (n - length l)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk6e"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A) (<span class="nv">l</span> : list A),
n &gt;= length l -&gt;
stream_prefix (stream_app l s) n = l ++ stream_prefix s (n - length l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hge</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n &gt;= length (a :: l)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (stream_app l s) n =
l ++ stream_prefix s (n - length l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk6f"><span class="highlight"><span class="nb">apply</span> IHn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A) (<span class="nv">l</span> : list A),
n &gt;= length l -&gt;
stream_prefix (stream_app l s) n = l ++ stream_prefix s (n - length l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hge</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n &gt;= length (a :: l)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n &gt;= length l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk70"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> Hge.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A) (<span class="nv">l</span> : list A),
n &gt;= length l -&gt;
stream_prefix (stream_app l s) n = l ++ stream_prefix s (n - length l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hge</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n &gt;= S (length l)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n &gt;= length l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk71"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_prefix_map</span>
  {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>}
  (<span class="nv">f</span> : A -&gt; B)
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n</span> : nat)
  : List.map f (stream_prefix l n) = stream_prefix (Streams.map f l) n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">List.map f (stream_prefix l n) =
stream_prefix (map f l) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk72"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">List.map f (stream_prefix l n) =
stream_prefix (map f l) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk73"><span class="highlight"><span class="nb">generalize dependent</span> l.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">l</span> : Stream A,
List.map f (stream_prefix l n) =
stream_prefix (map f l) n</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk74"><span class="highlight"><span class="nb">induction</span> n; <span class="nb">intros</span> [a l]; <span class="kp">try</span> <span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l</span> : Stream A,
List.map f (stream_prefix l n) = stream_prefix (map f l) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">List.map f (stream_prefix (Cons a l) (S n)) =
stream_prefix (map f (Cons a l)) (S n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk75"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l</span> : Stream A,
List.map f (stream_prefix l n) = stream_prefix (map f l) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f a :: List.map f (stream_prefix l n) =
f a
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream A) : Stream B :=
         Cons (f (hd s)) (map (tl s))) l) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk76"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l</span> : Stream A,
List.map f (stream_prefix l n) = stream_prefix (map f l) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">List.map f (stream_prefix l n) =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream A) : Stream B :=
      Cons (f (hd s)) (map (tl s))) l) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> IHn.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk77"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_prefix_length</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n</span> : nat)
  : length (stream_prefix l n) = n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">length (stream_prefix l n) = n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk78"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">length (stream_prefix l n) = n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk79"><span class="highlight"><span class="nb">generalize dependent</span> l.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">l</span> : Stream A, length (stream_prefix l n) = n</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk7a"><span class="highlight"><span class="nb">induction</span> n; <span class="nb">intros</span> [a l]; <span class="kp">try</span> <span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l</span> : Stream A, length (stream_prefix l n) = n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">length (stream_prefix (Cons a l) (S n)) = S n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk7b"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l</span> : Stream A, length (stream_prefix l n) = n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">S (length (stream_prefix l n)) = S n</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk7c"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l</span> : Stream A, length (stream_prefix l n) = n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">length (stream_prefix l n) = n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> IHn.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">stream_suffix</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n</span> : nat)
  : Stream A
  := Str_nth_tl n l.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk7d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_suffix_S</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n</span> : nat)
  : stream_suffix l n = Cons (Str_nth n l) (stream_suffix l (S n)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_suffix l n =
Cons (Str_nth n l) (stream_suffix l (S n))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk7e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_suffix l n =
Cons (Str_nth n l) (stream_suffix l (S n))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk7f"><span class="highlight"><span class="nb">generalize dependent</span> l.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">l</span> : Stream A,
stream_suffix l n =
Cons (Str_nth n l) (stream_suffix l (S n))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk80"><span class="highlight"><span class="nb">induction</span> n; <span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_suffix l <span class="mi">0</span> =
Cons (Str_nth <span class="mi">0</span> l) (stream_suffix l <span class="mi">1</span>)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk81" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l</span> : Stream A,
stream_suffix l n = Cons (Str_nth n l) (stream_suffix l (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chk81"><hr></label><div class="goal-conclusion"><span class="highlight">stream_suffix l (S n) =
Cons (Str_nth (S n) l) (stream_suffix l (S (S n)))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk82"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_suffix l <span class="mi">0</span> =
Cons (Str_nth <span class="mi">0</span> l) (stream_suffix l <span class="mi">1</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">destruct</span> l; <span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk83"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l</span> : Stream A,
stream_suffix l n = Cons (Str_nth n l) (stream_suffix l (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_suffix l (S n) =
Cons (Str_nth (S n) l) (stream_suffix l (S (S n)))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk84"><span class="highlight"><span class="nb">specialize</span> (IHn (tl l)); <span class="nb">simpl</span> <span class="kr">in</span> IHn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_suffix (tl l) n =
Cons (Str_nth n (tl l)) (stream_suffix (tl (tl l)) n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_suffix l (S n) =
Cons (Str_nth (S n) l) (stream_suffix l (S (S n)))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk85"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_suffix (tl l) n =
Cons (Str_nth n (tl l)) (stream_suffix (tl (tl l)) n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_suffix (tl l) n =
Cons (Str_nth (S n) l) (stream_suffix (tl (tl l)) n)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">assumption</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk86"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_suffix_nth</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">s</span> : Stream A)
  (<span class="nv">n</span> : nat)
  (<span class="nv">i</span> : nat)
  : Str_nth i (stream_suffix s n) = Str_nth (i + n) s.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth i (stream_suffix s n) = Str_nth (i + n) s</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk87"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth i (stream_suffix s n) = Str_nth (i + n) s</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> Str_nth_plus.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk88"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_prefix_suffix</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n</span> : nat)
  : stream_app (stream_prefix l n) (stream_suffix l n) = l.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_app (stream_prefix l n) (stream_suffix l n) = l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk89"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_app (stream_prefix l n) (stream_suffix l n) = l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk8a"><span class="highlight"><span class="nb">generalize dependent</span> l.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">l</span> : Stream A,
stream_app (stream_prefix l n) (stream_suffix l n) = l</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk8b"><span class="highlight"><span class="nb">unfold</span> stream_suffix.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">l</span> : Stream A,
stream_app (stream_prefix l n) (Str_nth_tl n l) = l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk8c"><span class="highlight"><span class="nb">induction</span> n; <span class="kp">try</span> <span class="bp">reflexivity</span>; <span class="nb">intros</span> [a l]; <span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l</span> : Stream A, stream_app (stream_prefix l n) (Str_nth_tl n l) = l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Cons a
  (stream_app (stream_prefix l n) (Str_nth_tl n l)) =
Cons a l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk8d"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l</span> : Stream A, stream_app (stream_prefix l n) (Str_nth_tl n l) = l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_app (stream_prefix l n) (Str_nth_tl n l) = l</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> IHn.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk8e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_prefix_prefix</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n1</span> <span class="nv">n2</span> : nat)
  (<span class="nv">Hn</span>: n1 &lt;= n2)
  : list_prefix (stream_prefix l n2) n1 = stream_prefix l n1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">list_prefix (stream_prefix l n2) n1 =
stream_prefix l n1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk8f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">list_prefix (stream_prefix l n2) n1 =
stream_prefix l n1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk90"><span class="highlight"><span class="nb">generalize dependent</span> n2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n2</span> : nat,
n1 &lt;= n2 -&gt;
list_prefix (stream_prefix l n2) n1 =
stream_prefix l n1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk91"><span class="highlight"><span class="nb">generalize dependent</span> l.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : Stream A) (<span class="nv">n2</span> : nat),
n1 &lt;= n2 -&gt;
list_prefix (stream_prefix l n2) n1 =
stream_prefix l n1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk92"><span class="highlight"><span class="nb">induction</span> n1; <span class="nb">intros</span> [a l]; <span class="nb">intros</span> [|n2] Hn; <span class="kp">try</span> <span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : Stream A) (<span class="nv">n2</span> : nat),
n1 &lt;= n2 -&gt;
list_prefix (stream_prefix l n2) n1 =
stream_prefix l n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n1 &lt;= <span class="mi">0</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">list_prefix (stream_prefix (Cons a l) <span class="mi">0</span>) (S n1) =
stream_prefix (Cons a l) (S n1)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk93" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : Stream A) (<span class="nv">n2</span> : nat),
n1 &lt;= n2 -&gt;
list_prefix (stream_prefix l n2) n1 =
stream_prefix l n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n1 &lt;= S n2</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chk93"><hr></label><div class="goal-conclusion"><span class="highlight">list_prefix (stream_prefix (Cons a l) (S n2)) (S n1) =
stream_prefix (Cons a l) (S n1)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk94"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : Stream A) (<span class="nv">n2</span> : nat),
n1 &lt;= n2 -&gt;
list_prefix (stream_prefix l n2) n1 =
stream_prefix l n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n1 &lt;= <span class="mi">0</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">list_prefix (stream_prefix (Cons a l) <span class="mi">0</span>) (S n1) =
stream_prefix (Cons a l) (S n1)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">inversion</span> Hn.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk95"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : Stream A) (<span class="nv">n2</span> : nat),
n1 &lt;= n2 -&gt;
list_prefix (stream_prefix l n2) n1 =
stream_prefix l n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n1 &lt;= S n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">list_prefix (stream_prefix (Cons a l) (S n2)) (S n1) =
stream_prefix (Cons a l) (S n1)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk96"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : Stream A) (<span class="nv">n2</span> : nat),
n1 &lt;= n2 -&gt;
list_prefix (stream_prefix l n2) n1 =
stream_prefix l n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n1 &lt;= S n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a :: list_prefix (stream_prefix l n2) n1 =
a :: stream_prefix l n1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk97"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : Stream A) (<span class="nv">n2</span> : nat),
n1 &lt;= n2 -&gt;
list_prefix (stream_prefix l n2) n1 =
stream_prefix l n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n1 &lt;= S n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">list_prefix (stream_prefix l n2) n1 =
stream_prefix l n1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk98"><span class="highlight"><span class="nb">apply</span> IHn1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">l</span> : Stream A) (<span class="nv">n2</span> : nat),
n1 &lt;= n2 -&gt;
list_prefix (stream_prefix l n2) n1 =
stream_prefix l n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n1 &lt;= S n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n1 &lt;= n2</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">stream_segment</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n1</span> <span class="nv">n2</span> : nat)
  : list A
  := list_suffix (stream_prefix l n2) n1.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk99"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_segment_nth</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n1</span> <span class="nv">n2</span> : nat)
  (<span class="nv">Hn</span> : n1 &lt;= n2)
  (<span class="nv">i</span> : nat)
  (<span class="nv">Hi1</span> : n1 &lt;= i)
  (<span class="nv">Hi2</span> : i &lt; n2)
  : nth_error (stream_segment l n1 n2) (i - n1) = Some (Str_nth i l).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt; n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (stream_segment l n1 n2) (i - n1) =
Some (Str_nth i l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk9a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt; n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (stream_segment l n1 n2) (i - n1) =
Some (Str_nth i l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk9b"><span class="highlight"><span class="nb">unfold</span> stream_segment.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt; n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (list_suffix (stream_prefix l n2) n1)
  (i - n1) = Some (Str_nth i l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk9c"><span class="highlight"><span class="nb">rewrite</span> list_suffix_nth; <span class="kp">try</span> <span class="bp">assumption</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt; n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (stream_prefix l n2) i = Some (Str_nth i l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk9d"><span class="highlight"><span class="nb">apply</span> stream_prefix_nth.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hi2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt; n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">i &lt; n2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">assumption</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">stream_segment_alt</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n1</span> <span class="nv">n2</span> : nat)
  : list A
  := stream_prefix (stream_suffix l n1) (n2 - n1).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk9e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_segment_alt_iff</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n1</span> <span class="nv">n2</span> : nat)
  : stream_segment l n1 n2 = stream_segment_alt l n1 n2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_segment l n1 n2 = stream_segment_alt l n1 n2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk9f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_segment l n1 n2 = stream_segment_alt l n1 n2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chka0"><span class="highlight"><span class="nb">apply</span> nth_error_eq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
nth_error (stream_segment l n1 n2) n =
nth_error (stream_segment_alt l n1 n2) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chka1"><span class="highlight"><span class="nb">intro</span> k.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (stream_segment l n1 n2) k =
nth_error (stream_segment_alt l n1 n2) k</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chka2"><span class="highlight"><span class="nb">unfold</span> stream_segment_alt.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (stream_segment l n1 n2) k =
nth_error
  (stream_prefix (stream_suffix l n1) (n2 - n1)) k</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chka3"><span class="highlight"><span class="nb">unfold</span> stream_segment.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (list_suffix (stream_prefix l n2) n1) k =
nth_error
  (stream_prefix (stream_suffix l n1) (n2 - n1)) k</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chka4"><span class="highlight"><span class="nb">destruct</span> (le_lt_dec (n2 - n1) k).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 - n1 &lt;= k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (list_suffix (stream_prefix l n2) n1) k =
nth_error
  (stream_prefix (stream_suffix l n1) (n2 - n1)) k</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chka5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n2 - n1</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chka5"><hr></label><div class="goal-conclusion"><span class="highlight">nth_error (list_suffix (stream_prefix l n2) n1) k =
nth_error
  (stream_prefix (stream_suffix l n1) (n2 - n1)) k</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chka6"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 - n1 &lt;= k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (list_suffix (stream_prefix l n2) n1) k =
nth_error
  (stream_prefix (stream_suffix l n1) (n2 - n1)) k</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chka7"><span class="highlight"><span class="nb">specialize</span> (nth_error_None (list_suffix (stream_prefix l n2) n1) k); <span class="nb">intros</span> [_ H].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 - n1 &lt;= k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length (list_suffix (stream_prefix l n2) n1) &lt;= k -&gt;
nth_error (list_suffix (stream_prefix l n2) n1) k =
None</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (list_suffix (stream_prefix l n2) n1) k =
nth_error
  (stream_prefix (stream_suffix l n1) (n2 - n1)) k</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chka8"><span class="highlight"><span class="nb">specialize</span> (nth_error_None (stream_prefix (stream_suffix l n1) (n2 - n1)) k); <span class="nb">intros</span> [_ H_alt].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 - n1 &lt;= k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length (list_suffix (stream_prefix l n2) n1) &lt;= k -&gt;
nth_error (list_suffix (stream_prefix l n2) n1) k =
None</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H_alt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length
  (stream_prefix (stream_suffix l n1)
     (n2 - n1)) &lt;= k -&gt;
nth_error
  (stream_prefix (stream_suffix l n1)
     (n2 - n1)) k = None</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (list_suffix (stream_prefix l n2) n1) k =
nth_error
  (stream_prefix (stream_suffix l n1) (n2 - n1)) k</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chka9"><span class="highlight"><span class="nb">rewrite</span> H, H_alt; <span class="kp">try</span> <span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 - n1 &lt;= k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length (list_suffix (stream_prefix l n2) n1) &lt;= k -&gt;
nth_error (list_suffix (stream_prefix l n2) n1) k =
None</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H_alt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length
  (stream_prefix (stream_suffix l n1)
     (n2 - n1)) &lt;= k -&gt;
nth_error
  (stream_prefix (stream_suffix l n1)
     (n2 - n1)) k = None</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">length (stream_prefix (stream_suffix l n1) (n2 - n1)) &lt;=
k</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chkaa" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 - n1 &lt;= k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length (list_suffix (stream_prefix l n2) n1) &lt;= k -&gt;
nth_error (list_suffix (stream_prefix l n2) n1) k =
None</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H_alt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length
  (stream_prefix (stream_suffix l n1)
     (n2 - n1)) &lt;= k -&gt;
nth_error
  (stream_prefix (stream_suffix l n1)
     (n2 - n1)) k = None</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chkaa"><hr></label><div class="goal-conclusion"><span class="highlight">length (list_suffix (stream_prefix l n2) n1) &lt;= k</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkab"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 - n1 &lt;= k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length (list_suffix (stream_prefix l n2) n1) &lt;= k -&gt;
nth_error (list_suffix (stream_prefix l n2) n1) k =
None</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H_alt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length
  (stream_prefix (stream_suffix l n1)
     (n2 - n1)) &lt;= k -&gt;
nth_error
  (stream_prefix (stream_suffix l n1)
     (n2 - n1)) k = None</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">length (stream_prefix (stream_suffix l n1) (n2 - n1)) &lt;=
k</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">rewrite</span> stream_prefix_length; <span class="bp">assumption</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkac"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 - n1 &lt;= k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length (list_suffix (stream_prefix l n2) n1) &lt;= k -&gt;
nth_error (list_suffix (stream_prefix l n2) n1) k =
None</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H_alt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length
  (stream_prefix (stream_suffix l n1)
     (n2 - n1)) &lt;= k -&gt;
nth_error
  (stream_prefix (stream_suffix l n1)
     (n2 - n1)) k = None</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">length (list_suffix (stream_prefix l n2) n1) &lt;= k</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkad"><span class="highlight"><span class="nb">rewrite</span> list_suffix_length.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 - n1 &lt;= k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length (list_suffix (stream_prefix l n2) n1) &lt;= k -&gt;
nth_error (list_suffix (stream_prefix l n2) n1) k =
None</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H_alt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length
  (stream_prefix (stream_suffix l n1)
     (n2 - n1)) &lt;= k -&gt;
nth_error
  (stream_prefix (stream_suffix l n1)
     (n2 - n1)) k = None</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">length (stream_prefix l n2) - n1 &lt;= k</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkae" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkae"><span class="highlight"><span class="nb">rewrite</span> stream_prefix_length.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 - n1 &lt;= k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length (list_suffix (stream_prefix l n2) n1) &lt;= k -&gt;
nth_error (list_suffix (stream_prefix l n2) n1) k =
None</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H_alt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length
  (stream_prefix (stream_suffix l n1)
     (n2 - n1)) &lt;= k -&gt;
nth_error
  (stream_prefix (stream_suffix l n1)
     (n2 - n1)) k = None</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n2 - n1 &lt;= k</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">assumption</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkaf"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n2 - n1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (list_suffix (stream_prefix l n2) n1) k =
nth_error
  (stream_prefix (stream_suffix l n1) (n2 - n1)) k</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkb0"><span class="highlight"><span class="nb">rewrite</span> stream_prefix_nth; <span class="kp">try</span> <span class="bp">assumption</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n2 - n1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (list_suffix (stream_prefix l n2) n1) k =
Some (Str_nth k (stream_suffix l n1))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkb1"><span class="highlight"><span class="nb">rewrite</span> stream_suffix_nth.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n2 - n1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (list_suffix (stream_prefix l n2) n1) k =
Some (Str_nth (k + n1) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkb2"><span class="highlight"><span class="nb">assert</span> (Hle : n1 &lt;= n1 + k) <span class="bp">by</span> <span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n2 - n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n1 + k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (list_suffix (stream_prefix l n2) n1) k =
Some (Str_nth (k + n1) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkb3"><span class="highlight"><span class="nb">specialize</span> (list_suffix_nth (stream_prefix l n2) n1 (n1 + k) Hle)
    ; <span class="nb">intro</span> Heq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n2 - n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n1 + k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (list_suffix (stream_prefix l n2) n1)
  (n1 + k - n1) =
nth_error (stream_prefix l n2) (n1 + k)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (list_suffix (stream_prefix l n2) n1) k =
Some (Str_nth (k + n1) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkb4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkb4"><span class="highlight"><span class="nb">clear</span> Hle.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n2 - n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (list_suffix (stream_prefix l n2) n1)
  (n1 + k - n1) =
nth_error (stream_prefix l n2) (n1 + k)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (list_suffix (stream_prefix l n2) n1) k =
Some (Str_nth (k + n1) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkb5"><span class="highlight"><span class="nb">assert</span> (Hs: n1 + k - n1 = k) <span class="bp">by</span> <span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n2 - n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (list_suffix (stream_prefix l n2) n1)
  (n1 + k - n1) =
nth_error (stream_prefix l n2) (n1 + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 + k - n1 = k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (list_suffix (stream_prefix l n2) n1) k =
Some (Str_nth (k + n1) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkb6"><span class="highlight"><span class="nb">rewrite</span> Hs <span class="kr">in</span> Heq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n2 - n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (list_suffix (stream_prefix l n2) n1)
  k = nth_error (stream_prefix l n2) (n1 + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 + k - n1 = k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (list_suffix (stream_prefix l n2) n1) k =
Some (Str_nth (k + n1) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkb7"><span class="highlight"><span class="nb">rewrite</span> Heq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n2 - n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (list_suffix (stream_prefix l n2) n1)
  k = nth_error (stream_prefix l n2) (n1 + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 + k - n1 = k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">nth_error (stream_prefix l n2) (n1 + k) =
Some (Str_nth (k + n1) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkb8"><span class="highlight"><span class="nb">rewrite</span> stream_prefix_nth.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n2 - n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (list_suffix (stream_prefix l n2) n1)
  k = nth_error (stream_prefix l n2) (n1 + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 + k - n1 = k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Some (Str_nth (n1 + k) l) = Some (Str_nth (k + n1) l)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chkb9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n2 - n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (list_suffix (stream_prefix l n2) n1)
  k = nth_error (stream_prefix l n2) (n1 + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 + k - n1 = k</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chkb9"><hr></label><div class="goal-conclusion"><span class="highlight">n1 + k &lt; n2</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkba"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n2 - n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (list_suffix (stream_prefix l n2) n1)
  k = nth_error (stream_prefix l n2) (n1 + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 + k - n1 = k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Some (Str_nth (n1 + k) l) = Some (Str_nth (k + n1) l)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">rewrite</span> Plus.plus_comm; <span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkbb"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n2 - n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (list_suffix (stream_prefix l n2) n1)
  k = nth_error (stream_prefix l n2) (n1 + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 + k - n1 = k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n1 + k &lt; n2</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkbc"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_prefix_segment</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n1</span> <span class="nv">n2</span> : nat)
  (<span class="nv">Hn</span> : n1 &lt;= n2)
  : stream_prefix l n1 ++ stream_segment l n1 n2 = stream_prefix l n2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix l n1 ++ stream_segment l n1 n2 =
stream_prefix l n2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkbd" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkbd"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix l n1 ++ stream_segment l n1 n2 =
stream_prefix l n2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkbe" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkbe"><span class="highlight"><span class="nb">unfold</span> stream_segment.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix l n1 ++
list_suffix (stream_prefix l n2) n1 =
stream_prefix l n2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkbf"><span class="highlight"><span class="nb">rewrite</span> &lt;- (list_prefix_suffix (stream_prefix l n2) n1) <span class="nb">at</span> <span class="mi">2</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix l n1 ++
list_suffix (stream_prefix l n2) n1 =
list_prefix (stream_prefix l n2) n1 ++
list_suffix (stream_prefix l n2) n1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkc0"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix l n1 =
list_prefix (stream_prefix l n2) n1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkc1" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkc1"><span class="highlight"><span class="nb">symmetry</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">list_prefix (stream_prefix l n2) n1 =
stream_prefix l n1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkc2"><span class="highlight"><span class="nb">apply</span> stream_prefix_prefix.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n1 &lt;= n2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">assumption</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkc3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkc3"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_prefix_segment_suffix</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n1</span> <span class="nv">n2</span> : nat)
  (<span class="nv">Hn</span> : n1 &lt;= n2)
  : stream_app
      ((stream_prefix l n1)
        ++
       (stream_segment l n1 n2)
      )
      (stream_suffix l n2)
  = l.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_app
  (stream_prefix l n1 ++ stream_segment l n1 n2)
  (stream_suffix l n2) = l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkc4"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_app
  (stream_prefix l n1 ++ stream_segment l n1 n2)
  (stream_suffix l n2) = l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkc5"><span class="highlight"><span class="nb">rewrite</span> &lt;- (stream_prefix_suffix l n2) <span class="nb">at</span> <span class="mi">4</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_app
  (stream_prefix l n1 ++ stream_segment l n1 n2)
  (stream_suffix l n2) =
stream_app (stream_prefix l n2) (stream_suffix l n2)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkc6" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkc6"><span class="highlight"><span class="nb">f_equal</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix l n1 ++ stream_segment l n1 n2 =
stream_prefix l n2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkc7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkc7"><span class="highlight"><span class="nb">apply</span> stream_prefix_segment.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n1 &lt;= n2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">assumption</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkc8"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_segment_app</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n1</span> <span class="nv">n2</span> <span class="nv">n3</span> : nat)
  (<span class="nv">H12</span> : n1 &lt;= n2)
  (<span class="nv">H23</span> : n2 &lt;= n3)
  : stream_segment l n1 n2 ++ stream_segment l n2 n3 = stream_segment l n1 n3.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, n3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H23</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 &lt;= n3</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkc9" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkc9"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, n3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H23</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 &lt;= n3</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkca" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkca"><span class="highlight"><span class="nb">assert</span> (Hle : n1 &lt;= n3) <span class="bp">by</span> <span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, n3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H23</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n3</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkcb" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkcb"><span class="highlight"><span class="nb">specialize</span> (stream_prefix_segment_suffix l n1 n3 Hle); <span class="nb">intro</span> Hl1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, n3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H23</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (stream_prefix l n1 ++ stream_segment l n1 n3)
(stream_suffix l n3) = l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkcc"><span class="highlight"><span class="nb">specialize</span> (stream_prefix_segment_suffix l n2 n3 H23); <span class="nb">intro</span> Hl2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, n3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H23</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (stream_prefix l n1 ++ stream_segment l n1 n3)
(stream_suffix l n3) = l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (stream_prefix l n2 ++ stream_segment l n2 n3)
(stream_suffix l n3) = l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkcd" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkcd"><span class="highlight"><span class="nb">rewrite</span> &lt;- Hl2 <span class="kr">in</span> Hl1 <span class="nb">at</span> <span class="mi">4</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, n3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H23</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (stream_prefix l n1 ++ stream_segment l n1 n3)
(stream_suffix l n3) =
stream_app (stream_prefix l n2 ++ stream_segment l n2 n3)
(stream_suffix l n3)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (stream_prefix l n2 ++ stream_segment l n2 n3)
(stream_suffix l n3) = l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkce"><span class="highlight"><span class="nb">clear</span> Hl2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, n3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H23</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (stream_prefix l n1 ++ stream_segment l n1 n3)
(stream_suffix l n3) =
stream_app (stream_prefix l n2 ++ stream_segment l n2 n3)
(stream_suffix l n3)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkcf" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkcf"><span class="highlight"><span class="nb">apply</span> stream_app_inj_l <span class="kr">in</span> Hl1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, n3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H23</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix l n1 ++ stream_segment l n1 n3 =
stream_prefix l n2 ++ stream_segment l n2 n3</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chkd0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, n3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H23</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (stream_prefix l n1 ++ stream_segment l n1 n3)
(stream_suffix l n3) =
stream_app (stream_prefix l n2 ++ stream_segment l n2 n3)
(stream_suffix l n3)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chkd0"><hr></label><div class="goal-conclusion"><span class="highlight">length (stream_prefix l n1 ++ stream_segment l n1 n3) =
length (stream_prefix l n2 ++ stream_segment l n2 n3)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkd1" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkd1"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, n3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H23</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix l n1 ++ stream_segment l n1 n3 =
stream_prefix l n2 ++ stream_segment l n2 n3</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkd2" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkd2"><span class="highlight"><span class="nb">specialize</span> (list_prefix_suffix (stream_prefix l n2) n1); <span class="nb">intro</span> Hl2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, n3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H23</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix l n1 ++ stream_segment l n1 n3 =
stream_prefix l n2 ++ stream_segment l n2 n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_prefix (stream_prefix l n2) n1 ++ list_suffix (stream_prefix l n2) n1 =
stream_prefix l n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkd3"><span class="highlight"><span class="nb">specialize</span> (stream_prefix_prefix l n1 n2 H12); <span class="nb">intro</span> Hl3.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, n3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H23</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix l n1 ++ stream_segment l n1 n3 =
stream_prefix l n2 ++ stream_segment l n2 n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_prefix (stream_prefix l n2) n1 ++ list_suffix (stream_prefix l n2) n1 =
stream_prefix l n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_prefix (stream_prefix l n2) n1 = stream_prefix l n1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkd4"><span class="highlight"><span class="nb">rewrite</span> Hl3 <span class="kr">in</span> Hl2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, n3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H23</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix l n1 ++ stream_segment l n1 n3 =
stream_prefix l n2 ++ stream_segment l n2 n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix l n1 ++ list_suffix (stream_prefix l n2) n1 =
stream_prefix l n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_prefix (stream_prefix l n2) n1 = stream_prefix l n1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkd5"><span class="highlight"><span class="nb">rewrite</span> &lt;- Hl2 <span class="kr">in</span> Hl1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, n3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H23</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix l n1 ++ stream_segment l n1 n3 =
(stream_prefix l n1 ++ list_suffix (stream_prefix l n2) n1) ++
stream_segment l n2 n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix l n1 ++ list_suffix (stream_prefix l n2) n1 =
stream_prefix l n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_prefix (stream_prefix l n2) n1 = stream_prefix l n1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkd6" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkd6"><span class="highlight"><span class="nb">rewrite</span> &lt;- app_assoc <span class="kr">in</span> Hl1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, n3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H23</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix l n1 ++ stream_segment l n1 n3 =
stream_prefix l n1 ++
list_suffix (stream_prefix l n2) n1 ++ stream_segment l n2 n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix l n1 ++ list_suffix (stream_prefix l n2) n1 =
stream_prefix l n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_prefix (stream_prefix l n2) n1 = stream_prefix l n1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkd7"><span class="highlight"><span class="nb">apply</span> app_inv_head <span class="kr">in</span> Hl1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, n3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H23</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_segment l n1 n3 =
list_suffix (stream_prefix l n2) n1 ++ stream_segment l n2 n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix l n1 ++ list_suffix (stream_prefix l n2) n1 =
stream_prefix l n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_prefix (stream_prefix l n2) n1 = stream_prefix l n1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_segment l n1 n2 ++ stream_segment l n2 n3 =
stream_segment l n1 n3</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkd8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkd8"><span class="highlight"><span class="nb">symmetry</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, n3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H23</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_segment l n1 n3 =
list_suffix (stream_prefix l n2) n1 ++ stream_segment l n2 n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix l n1 ++ list_suffix (stream_prefix l n2) n1 =
stream_prefix l n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_prefix (stream_prefix l n2) n1 = stream_prefix l n1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_segment l n1 n3 =
stream_segment l n1 n2 ++ stream_segment l n2 n3</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">assumption</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkd9"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, n3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H23</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (stream_prefix l n1 ++ stream_segment l n1 n3)
(stream_suffix l n3) =
stream_app (stream_prefix l n2 ++ stream_segment l n2 n3)
(stream_suffix l n3)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">length (stream_prefix l n1 ++ stream_segment l n1 n3) =
length (stream_prefix l n2 ++ stream_segment l n2 n3)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkda"><span class="highlight"><span class="kp">repeat</span> <span class="nb">rewrite</span> app_length.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, n3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H23</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (stream_prefix l n1 ++ stream_segment l n1 n3)
(stream_suffix l n3) =
stream_app (stream_prefix l n2 ++ stream_segment l n2 n3)
(stream_suffix l n3)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">length (stream_prefix l n1) +
length (stream_segment l n1 n3) =
length (stream_prefix l n2) +
length (stream_segment l n2 n3)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkdb" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkdb"><span class="highlight"><span class="nb">unfold</span> stream_segment.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, n3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H23</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (stream_prefix l n1 ++ stream_segment l n1 n3)
(stream_suffix l n3) =
stream_app (stream_prefix l n2 ++ stream_segment l n2 n3)
(stream_suffix l n3)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">length (stream_prefix l n1) +
length (list_suffix (stream_prefix l n3) n1) =
length (stream_prefix l n2) +
length (list_suffix (stream_prefix l n3) n2)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkdc" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkdc"><span class="highlight"><span class="kp">repeat</span> <span class="nb">rewrite</span> list_suffix_length.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, n3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H23</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (stream_prefix l n1 ++ stream_segment l n1 n3)
(stream_suffix l n3) =
stream_app (stream_prefix l n2 ++ stream_segment l n2 n3)
(stream_suffix l n3)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">length (stream_prefix l n1) +
(length (stream_prefix l n3) - n1) =
length (stream_prefix l n2) +
(length (stream_prefix l n3) - n2)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkdd" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkdd"><span class="highlight"><span class="kp">repeat</span> <span class="nb">rewrite</span> stream_prefix_length.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2, n3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H12</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H23</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n2 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt;= n3</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hl1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (stream_prefix l n1 ++ stream_segment l n1 n3)
(stream_suffix l n3) =
stream_app (stream_prefix l n2 ++ stream_segment l n2 n3)
(stream_suffix l n3)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n1 + (n3 - n1) = n2 + (n3 - n2)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">monotone_nat_stream_prop</span>
  (<span class="nv">s</span> : Stream nat)
  := <span class="kr">forall</span> <span class="nv">n1</span> <span class="nv">n2</span> : nat, n1 &lt; n2 -&gt; Str_nth n1 s &lt; Str_nth n2 s.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">monotone_nat_stream</span> :=
  {s : Stream nat | monotone_nat_stream_prop s}.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkde" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkde"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">monotone_nat_stream_tl</span>
  (<span class="nv">s</span> : Stream nat)
  (<span class="nv">Hs</span> : monotone_nat_stream_prop s)
  : monotone_nat_stream_prop (tl s).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop s</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">monotone_nat_stream_prop (tl s)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkdf"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop s</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">monotone_nat_stream_prop (tl s)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chke0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chke0"><span class="highlight"><span class="nb">intros</span> n1 n2 Hlt.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt; n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth n1 (tl s) &lt; Str_nth n2 (tl s)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chke1"><span class="highlight"><span class="nb">specialize</span> (Hs (S n1) (S n2)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n1 &lt; S n2 -&gt;
Str_nth (S n1) s &lt; Str_nth (S n2) s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt; n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth n1 (tl s) &lt; Str_nth n2 (tl s)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chke2"><span class="highlight"><span class="nb">apply</span> Hs.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n1 &lt; S n2 -&gt;
Str_nth (S n1) s &lt; Str_nth (S n2) s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt; n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">S n1 &lt; S n2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">nat_sequence_suffix</span>
  (<span class="nv">s</span> : Stream nat)
  :=
  Streams.map (<span class="kr">fun</span> <span class="nv">i</span> =&gt; i - (S (hd s))) (tl s).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chke3"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">monotone_nat_prop_suffix</span>
  (<span class="nv">ss</span> : monotone_nat_stream)
  : monotone_nat_stream_prop (nat_sequence_suffix (proj1_sig ss)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">monotone_nat_stream_prop
  (nat_sequence_suffix (proj1_sig ss))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chke4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chke4"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">monotone_nat_stream_prop
  (nat_sequence_suffix (proj1_sig ss))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chke5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chke5"><span class="highlight"><span class="nb">destruct</span> ss <span class="kr">as</span> [s Hs].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop s</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">monotone_nat_stream_prop
  (nat_sequence_suffix
     (proj1_sig
        (exist
           (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
            monotone_nat_stream_prop s) s Hs)))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chke6"><span class="highlight"><span class="nb">intros</span> n1 n2 Hlt.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt; n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth n1
  (nat_sequence_suffix
     (proj1_sig
        (exist
           (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
            monotone_nat_stream_prop s) s Hs))) &lt;
Str_nth n2
  (nat_sequence_suffix
     (proj1_sig
        (exist
           (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
            monotone_nat_stream_prop s) s Hs)))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chke7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chke7"><span class="highlight"><span class="nb">unfold</span> nat_sequence_suffix.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt; n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth n1
  (map
     (<span class="kr">fun</span> <span class="nv">i</span> : nat =&gt;
      i -
      S
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s) s Hs))))
     (tl
        (proj1_sig
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s) s Hs)))) &lt;
Str_nth n2
  (map
     (<span class="kr">fun</span> <span class="nv">i</span> : nat =&gt;
      i -
      S
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s) s Hs))))
     (tl
        (proj1_sig
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s) s Hs))))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chke8"><span class="highlight"><span class="nb">destruct</span> s <span class="kr">as</span> (a, s).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons a s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt; n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth n1
  (map
     (<span class="kr">fun</span> <span class="nv">i</span> : nat =&gt;
      i -
      S
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons a s) Hs))))
     (tl
        (proj1_sig
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s) (Cons a s)
              Hs)))) &lt;
Str_nth n2
  (map
     (<span class="kr">fun</span> <span class="nv">i</span> : nat =&gt;
      i -
      S
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons a s) Hs))))
     (tl
        (proj1_sig
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s) (Cons a s)
              Hs))))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chke9"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons a s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt; n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth n1 (map (<span class="kr">fun</span> <span class="nv">i</span> : nat =&gt; i - S a) s) &lt;
Str_nth n2 (map (<span class="kr">fun</span> <span class="nv">i</span> : nat =&gt; i - S a) s)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkea"><span class="highlight"><span class="kp">repeat</span> <span class="nb">rewrite</span> Str_nth_map.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons a s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt; n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth n1 s - S a &lt; Str_nth n2 s - S a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkeb" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkeb"><span class="highlight"><span class="nb">assert</span> (Hlt1 : <span class="mi">0</span> &lt; S n1) <span class="bp">by</span> <span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons a s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt; n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n1</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth n1 s - S a &lt; Str_nth n2 s - S a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkec"><span class="highlight"><span class="nb">pose proof</span> (Hs <span class="mi">0</span> (S n1) Hlt1) <span class="kr">as</span> Ha1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons a s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt; n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth <span class="mi">0</span> (Cons a s) &lt; Str_nth (S n1) (Cons a s)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth n1 s - S a &lt; Str_nth n2 s - S a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chked" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chked"><span class="highlight"><span class="nb">unfold</span> Str_nth <span class="kr">in</span> Ha1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons a s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt; n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl <span class="mi">0</span> (Cons a s)) &lt;
hd (Str_nth_tl (S n1) (Cons a s))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth n1 s - S a &lt; Str_nth n2 s - S a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkee" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkee"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> Ha1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons a s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt; n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt; hd (Str_nth_tl n1 s)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth n1 s - S a &lt; Str_nth n2 s - S a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkef" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkef"><span class="highlight"><span class="nb">assert</span> (Hlt2 : <span class="mi">0</span> &lt; S n2) <span class="bp">by</span> <span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons a s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt; n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt; hd (Str_nth_tl n1 s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth n1 s - S a &lt; Str_nth n2 s - S a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkf0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkf0"><span class="highlight"><span class="nb">pose proof</span> (Hs <span class="mi">0</span> (S n2) Hlt2) <span class="kr">as</span> Ha2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons a s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt; n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt; hd (Str_nth_tl n1 s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth <span class="mi">0</span> (Cons a s) &lt; Str_nth (S n2) (Cons a s)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth n1 s - S a &lt; Str_nth n2 s - S a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkf1" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkf1"><span class="highlight"><span class="nb">unfold</span> Str_nth <span class="kr">in</span> Ha2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons a s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt; n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt; hd (Str_nth_tl n1 s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl <span class="mi">0</span> (Cons a s)) &lt;
hd (Str_nth_tl (S n2) (Cons a s))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth n1 s - S a &lt; Str_nth n2 s - S a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkf2" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkf2"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> Ha2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons a s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt; n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt; hd (Str_nth_tl n1 s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt; hd (Str_nth_tl n2 s)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth n1 s - S a &lt; Str_nth n2 s - S a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkf3"><span class="highlight"><span class="nb">assert</span> (HltS : S n1 &lt; S n2) <span class="bp">by</span> <span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons a s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt; n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt; hd (Str_nth_tl n1 s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt; hd (Str_nth_tl n2 s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HltS</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n1 &lt; S n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth n1 s - S a &lt; Str_nth n2 s - S a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkf4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkf4"><span class="highlight"><span class="nb">specialize</span> (Hs (S n1) (S n2) HltS).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (S n1) (Cons a s) &lt;
Str_nth (S n2) (Cons a s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt; n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt; hd (Str_nth_tl n1 s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt; hd (Str_nth_tl n2 s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HltS</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n1 &lt; S n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth n1 s - S a &lt; Str_nth n2 s - S a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkf5"><span class="highlight"><span class="nb">unfold</span> Str_nth <span class="kr">in</span> Hs.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl (S n1) (Cons a s)) &lt;
hd (Str_nth_tl (S n2) (Cons a s))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt; n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt; hd (Str_nth_tl n1 s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt; hd (Str_nth_tl n2 s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HltS</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n1 &lt; S n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth n1 s - S a &lt; Str_nth n2 s - S a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkf6"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> Hs.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl n1 s) &lt; hd (Str_nth_tl n2 s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt; n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt; hd (Str_nth_tl n1 s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt; hd (Str_nth_tl n2 s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HltS</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n1 &lt; S n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth n1 s - S a &lt; Str_nth n2 s - S a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkf7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkf7"><span class="highlight"><span class="nb">unfold</span> Str_nth.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n1, n2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl n1 s) &lt; hd (Str_nth_tl n2 s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n1 &lt; n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt; hd (Str_nth_tl n1 s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Ha2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt; hd (Str_nth_tl n2 s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">HltS</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n1 &lt; S n2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">hd (Str_nth_tl n1 s) - S a &lt;
hd (Str_nth_tl n2 s) - S a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">monotone_nat_stream_suffix</span>
  (<span class="nv">ss</span> : monotone_nat_stream)
  : monotone_nat_stream
  :=
  exist
    monotone_nat_stream_prop
    (nat_sequence_suffix (proj1_sig ss))
    (monotone_nat_prop_suffix ss).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">filtering_subsequence</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">P</span> : A -&gt; <span class="kt">Prop</span>)
  (<span class="nv">s</span> : Stream A)
  (<span class="nv">ss</span> : monotone_nat_stream)
  (<span class="nv">ns</span> := proj1_sig ss)
  := <span class="kr">forall</span> <span class="nv">n</span> : nat, P (Str_nth n s) &lt;-&gt; <span class="kr">exists</span> <span class="nv">k</span> : nat, Str_nth k ns = n.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkf8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkf8"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">filtering_subsequence_witness</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">P</span> : A -&gt; <span class="kt">Prop</span>)
  (<span class="nv">s</span> : Stream A)
  (<span class="nv">ss</span> : monotone_nat_stream)
  (<span class="nv">Hfs</span> : filtering_subsequence P s ss)
  (<span class="nv">ns</span> := proj1_sig ss)
  (<span class="nv">k</span> : nat)
  : P (Str_nth (Str_nth k ns) s).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P s ss</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ns</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (Str_nth (Str_nth k ns) s)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkf9" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkf9"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P s ss</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ns</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (Str_nth (Str_nth k ns) s)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkfa" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkfa"><span class="highlight"><span class="nb">specialize</span> (Hfs (Str_nth k ns)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ns</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (Str_nth k ns) s) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (proj1_sig ss) = Str_nth k ns)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (Str_nth (Str_nth k ns) s)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkfb" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkfb"><span class="highlight"><span class="nb">apply</span> Hfs.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ns</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (Str_nth k ns) s) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (proj1_sig ss) = Str_nth k ns)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k0</span> : nat,
  Str_nth k0 (proj1_sig ss) = Str_nth k ns</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkfc" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkfc"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ns</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (Str_nth k ns) s) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (proj1_sig ss) = Str_nth k ns)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k (proj1_sig ss) = Str_nth k ns</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkfd" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkfd"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">filtering_subsequence_suffix</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">P</span> : A -&gt; <span class="kt">Prop</span>)
  (<span class="nv">ss</span> : Stream A)
  (<span class="nv">kss</span> : monotone_nat_stream)
  (<span class="nv">ks</span> := proj1_sig kss)
  (<span class="nv">Hfs</span> : filtering_subsequence P ss kss)
  (<span class="nv">kss&#39;</span> := monotone_nat_stream_suffix kss)
  : filtering_subsequence
    P (stream_suffix ss (S (hd ks))) kss&#39; .</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss kss</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">filtering_subsequence P (stream_suffix ss (S (hd ks)))
  kss&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkfe" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkfe"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss kss</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">filtering_subsequence P (stream_suffix ss (S (hd ks)))
  kss&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chkff"><span class="highlight"><span class="nb">intro</span> n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss kss</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (Str_nth n (stream_suffix ss (S (hd ks)))) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k</span> : nat, Str_nth k (proj1_sig kss&#39;) = n)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk100" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk100"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss kss</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (Str_nth n (stream_suffix (tl ss) (hd ks))) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k</span> : nat,
   Str_nth k (nat_sequence_suffix (proj1_sig kss)) = n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk101" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk101"><span class="highlight"><span class="nb">rewrite</span> stream_suffix_nth.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss kss</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (Str_nth (n + hd ks) (tl ss)) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k</span> : nat,
   Str_nth k (nat_sequence_suffix (proj1_sig kss)) = n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk102" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk102"><span class="highlight"><span class="nb">specialize</span> (Hfs (S (n + hd ks))).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (S (n + hd ks)) ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k</span> : nat,
   Str_nth k (proj1_sig kss) = S (n + hd ks))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (Str_nth (n + hd ks) (tl ss)) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k</span> : nat,
   Str_nth k (nat_sequence_suffix (proj1_sig kss)) = n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk103" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk103"><span class="highlight"><span class="nb">split</span>; <span class="nb">intro</span> H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (S (n + hd ks)) ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k</span> : nat,
   Str_nth k (proj1_sig kss) = S (n + hd ks))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (n + hd ks) (tl ss))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat,
  Str_nth k (nat_sequence_suffix (proj1_sig kss)) = n</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk104" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (S (n + hd ks)) ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k</span> : nat,
   Str_nth k (proj1_sig kss) = S (n + hd ks))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat,
  Str_nth k (nat_sequence_suffix (proj1_sig kss)) =
  n</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chk104"><hr></label><div class="goal-conclusion"><span class="highlight">P (Str_nth (n + hd ks) (tl ss))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk105" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk105"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (S (n + hd ks)) ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k</span> : nat,
   Str_nth k (proj1_sig kss) = S (n + hd ks))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (n + hd ks) (tl ss))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat,
  Str_nth k (nat_sequence_suffix (proj1_sig kss)) = n</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk106" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk106"><span class="highlight"><span class="nb">apply</span> proj1 <span class="kr">in</span> Hfs.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (S (n + hd ks)) ss) -&gt;
<span class="kr">exists</span> <span class="nv">k</span> : nat,
  Str_nth k (proj1_sig kss) = S (n + hd ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (n + hd ks) (tl ss))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat,
  Str_nth k (nat_sequence_suffix (proj1_sig kss)) = n</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk107" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk107"><span class="highlight"><span class="nb">specialize</span> (Hfs H).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat,
  Str_nth k (proj1_sig kss) = S (n + hd ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (n + hd ks) (tl ss))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat,
  Str_nth k (nat_sequence_suffix (proj1_sig kss)) = n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk108" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk108"><span class="highlight"><span class="nb">destruct</span> Hfs <span class="kr">as</span> [k0 Heq].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth k0 (proj1_sig kss) = S (n + hd ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (n + hd ks) (tl ss))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat,
  Str_nth k (nat_sequence_suffix (proj1_sig kss)) = n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk109" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk109"><span class="highlight"><span class="nb">unfold</span> ks <span class="kr">in</span> *; <span class="nb">clear</span> ks.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth k0 (proj1_sig kss) =
S (n + hd (proj1_sig kss))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (n + hd (proj1_sig kss)) (tl ss))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat,
  Str_nth k (nat_sequence_suffix (proj1_sig kss)) = n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk10a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk10a"><span class="highlight"><span class="nb">destruct</span> kss <span class="kr">as</span> [(k, ks) Hseq]; <span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth k0 (Cons k ks) = S (n + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (n + k) (tl ss))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k0</span> : nat,
  Str_nth k0 (nat_sequence_suffix (Cons k ks)) = n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk10b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk10b"><span class="highlight"><span class="nb">destruct</span> k0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth <span class="mi">0</span> (Cons k ks) = S (n + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (n + k) (tl ss))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k0</span> : nat,
  Str_nth k0 (nat_sequence_suffix (Cons k ks)) = n</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk10c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (S k0) (Cons k ks) = S (n + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (n + k) (tl ss))</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chk10c"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k0</span> : nat,
  Str_nth k0 (nat_sequence_suffix (Cons k ks)) = n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk10d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk10d"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth <span class="mi">0</span> (Cons k ks) = S (n + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (n + k) (tl ss))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k0</span> : nat,
  Str_nth k0 (nat_sequence_suffix (Cons k ks)) = n</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk10e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk10e"><span class="highlight"><span class="nb">elim</span> (Plus.succ_plus_discr k n).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth <span class="mi">0</span> (Cons k ks) = S (n + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (n + k) (tl ss))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">k = S (n + k)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">assumption</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk10f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk10f"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (S k0) (Cons k ks) = S (n + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (n + k) (tl ss))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k0</span> : nat,
  Str_nth k0 (nat_sequence_suffix (Cons k ks)) = n</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk110" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk110"><span class="highlight"><span class="kr">exists</span> <span class="nv">k0</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (S k0) (Cons k ks) = S (n + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (n + k) (tl ss))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k0 (nat_sequence_suffix (Cons k ks)) = n</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk111" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk111"><span class="highlight"><span class="nb">unfold</span> nat_sequence_suffix.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (S k0) (Cons k ks) = S (n + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (n + k) (tl ss))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k0
  (map (<span class="kr">fun</span> <span class="nv">i</span> : nat =&gt; i - S (hd (Cons k ks)))
     (tl (Cons k ks))) = n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk112" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk112"><span class="highlight"><span class="nb">rewrite</span> Str_nth_map .</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (S k0) (Cons k ks) = S (n + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (n + k) (tl ss))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k0 (tl (Cons k ks)) - S (hd (Cons k ks)) = n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk113" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk113"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (S k0) (Cons k ks) = S (n + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (n + k) (tl ss))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k0 ks - S k = n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk114" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk114"><span class="highlight"><span class="nb">unfold</span> Str_nth <span class="kr">in</span> Heq; <span class="nb">simpl</span> <span class="kr">in</span> Heq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl k0 ks) = S (n + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (n + k) (tl ss))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k0 ks - S k = n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk115" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk115"><span class="highlight"><span class="nb">assert</span> (Hlt0 : <span class="mi">0</span> &lt; (S k0)) <span class="bp">by</span> <span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl k0 ks) = S (n + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (n + k) (tl ss))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S k0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k0 ks - S k = n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk116" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk116"><span class="highlight"><span class="nb">clear</span> kss&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl k0 ks) = S (n + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (n + k) (tl ss))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S k0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k0 ks - S k = n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk117" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk117"><span class="highlight"><span class="nb">specialize</span> (Hseq <span class="mi">0</span> (S k0) Hlt0).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth <span class="mi">0</span> (Cons k ks) &lt;
Str_nth (S k0) (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl k0 ks) = S (n + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (n + k) (tl ss))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S k0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k0 ks - S k = n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk118" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk118"><span class="highlight"><span class="nb">unfold</span> Str_nth <span class="kr">in</span> Hseq; <span class="nb">simpl</span> <span class="kr">in</span> Hseq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; hd (Str_nth_tl k0 ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl k0 ks) = S (n + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (n + k) (tl ss))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S k0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k0 ks - S k = n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk119" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk119"><span class="highlight"><span class="nb">unfold</span> Str_nth.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; hd (Str_nth_tl k0 ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl k0 ks) = S (n + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (n + k) (tl ss))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S k0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">hd (Str_nth_tl k0 ks) - S k = n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk11a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk11a"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (S (n + hd ks)) ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k</span> : nat,
   Str_nth k (proj1_sig kss) = S (n + hd ks))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat,
  Str_nth k (nat_sequence_suffix (proj1_sig kss)) =
  n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (Str_nth (n + hd ks) (tl ss))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk11b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk11b"><span class="highlight"><span class="nb">apply</span> proj2 <span class="kr">in</span> Hfs.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">exists</span> <span class="nv">k</span> : nat,
   Str_nth k (proj1_sig kss) = S (n + hd ks)) -&gt;
P (Str_nth (S (n + hd ks)) ss)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat,
  Str_nth k (nat_sequence_suffix (proj1_sig kss)) =
  n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (Str_nth (n + hd ks) (tl ss))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk11c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk11c"><span class="highlight"><span class="nb">apply</span> Hfs.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">exists</span> <span class="nv">k</span> : nat,
   Str_nth k (proj1_sig kss) = S (n + hd ks)) -&gt;
P (Str_nth (S (n + hd ks)) ss)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat,
  Str_nth k (nat_sequence_suffix (proj1_sig kss)) =
  n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat,
  Str_nth k (proj1_sig kss) = S (n + hd ks)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk11d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk11d"><span class="highlight"><span class="nb">clear</span> Hfs.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat,
  Str_nth k (nat_sequence_suffix (proj1_sig kss)) =
  n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat,
  Str_nth k (proj1_sig kss) = S (n + hd ks)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk11e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk11e"><span class="highlight"><span class="nb">destruct</span> H <span class="kr">as</span> [k Heq].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth k (nat_sequence_suffix (proj1_sig kss)) =
n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span> : nat,
  Str_nth k (proj1_sig kss) = S (n + hd ks)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk11f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk11f"><span class="highlight"><span class="kr">exists</span> (<span class="nv">S</span> <span class="nv">k</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth k (nat_sequence_suffix (proj1_sig kss)) =
n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (S k) (proj1_sig kss) = S (n + hd ks)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk120" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk120"><span class="highlight"><span class="nb">unfold</span> nat_sequence_suffix <span class="kr">in</span> Heq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth k
  (map
     (<span class="kr">fun</span> <span class="nv">i</span> : nat =&gt; i - S (hd (proj1_sig kss)))
     (tl (proj1_sig kss))) = n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (S k) (proj1_sig kss) = S (n + hd ks)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk121" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk121"><span class="highlight"><span class="nb">rewrite</span> Str_nth_map <span class="kr">in</span> Heq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">proj1_sig kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth k (tl (proj1_sig kss)) -
S (hd (proj1_sig kss)) = n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (S k) (proj1_sig kss) = S (n + hd ks)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk122" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk122"><span class="highlight"><span class="nb">unfold</span> ks <span class="kr">in</span> *; <span class="nb">clear</span> ks.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth k (tl (proj1_sig kss)) -
S (hd (proj1_sig kss)) = n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (S k) (proj1_sig kss) =
S (n + hd (proj1_sig kss))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk123" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk123"><span class="highlight"><span class="nb">destruct</span> kss <span class="kr">as</span> [(k0, ks) Hseq]; <span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k0 ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k0 ks) Hseq)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth k ks - S k0 = n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (S k) (Cons k0 ks) = S (n + k0)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk124" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk124"><span class="highlight"><span class="nb">assert</span> (Hlt : <span class="mi">0</span> &lt; (S k)) <span class="bp">by</span> <span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k0 ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k0 ks) Hseq)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth k ks - S k0 = n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (S k) (Cons k0 ks) = S (n + k0)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk125" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk125"><span class="highlight"><span class="nb">clear</span> kss&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k0 ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth k ks - S k0 = n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (S k) (Cons k0 ks) = S (n + k0)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk126" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk126"><span class="highlight"><span class="nb">specialize</span> (Hseq <span class="mi">0</span> (S k) Hlt).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth <span class="mi">0</span> (Cons k0 ks) &lt;
Str_nth (S k) (Cons k0 ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth k ks - S k0 = n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (S k) (Cons k0 ks) = S (n + k0)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk127" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk127"><span class="highlight"><span class="nb">unfold</span> Str_nth <span class="kr">in</span> *; <span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k0 &lt; hd (Str_nth_tl k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl k ks) - S k0 = n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">hd (Str_nth_tl k ks) = S (n + k0)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">stream_subsequence</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">s</span> : Stream A)
  (<span class="nv">ss</span> : monotone_nat_stream)
  (<span class="nv">ns</span> := proj1_sig ss)
  : Stream A
  := Streams.map (<span class="kr">fun</span> <span class="nv">k</span> =&gt; Str_nth k s) ns.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk128" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk128"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_subsequence_suffix</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">ss</span> : Stream A)
  (<span class="nv">kss</span> : monotone_nat_stream)
  (<span class="nv">k</span> := (hd (proj1_sig kss)))
  (<span class="nv">n</span> := Str_nth k ss)
  (<span class="nv">ss&#39;</span> := stream_suffix ss (S k))
  (<span class="nv">kss&#39;</span> := monotone_nat_stream_suffix kss)
  : EqSt
    (stream_subsequence ss kss)
    (Cons n (stream_subsequence ss&#39; kss&#39;)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">hd (proj1_sig kss)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth k ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt (stream_subsequence ss kss)
  (Cons n (stream_subsequence ss&#39; kss&#39;))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk129" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk129"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">hd (proj1_sig kss)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth k ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt (stream_subsequence ss kss)
  (Cons n (stream_subsequence ss&#39; kss&#39;))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk12a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk12a"><span class="highlight"><span class="nb">apply</span> ntheq_eqst.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">hd (proj1_sig kss)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth k ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n0</span> : nat,
Str_nth n0 (stream_subsequence ss kss) =
Str_nth n0 (Cons n (stream_subsequence ss&#39; kss&#39;))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk12b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk12b"><span class="highlight"><span class="nb">intros</span> [|n&#39;]; <span class="kp">try</span> <span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">hd (proj1_sig kss)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth k ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (S n&#39;) (stream_subsequence ss kss) =
Str_nth (S n&#39;) (Cons n (stream_subsequence ss&#39; kss&#39;))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk12c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk12c"><span class="highlight"><span class="nb">unfold</span> stream_subsequence <span class="nb">at</span> <span class="mi">1</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">hd (proj1_sig kss)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth k ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (S n&#39;)
  (map (<span class="kr">fun</span> <span class="nv">k</span> : nat =&gt; Str_nth k ss) (proj1_sig kss)) =
Str_nth (S n&#39;) (Cons n (stream_subsequence ss&#39; kss&#39;))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk12d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk12d"><span class="highlight"><span class="nb">rewrite</span> Str_nth_map.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">hd (proj1_sig kss)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth k ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (Str_nth (S n&#39;) (proj1_sig kss)) ss =
Str_nth (S n&#39;) (Cons n (stream_subsequence ss&#39; kss&#39;))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk12e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk12e"><span class="highlight"><span class="nb">unfold</span> Str_nth <span class="nb">at</span> <span class="mi">3</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">hd (proj1_sig kss)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth k ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (Str_nth (S n&#39;) (proj1_sig kss)) ss =
hd
  (Str_nth_tl (S n&#39;)
     (Cons n (stream_subsequence ss&#39; kss&#39;)))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk12f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk12f"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">hd (proj1_sig kss)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth k ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (Str_nth (S n&#39;) (proj1_sig kss)) ss =
hd (Str_nth_tl n&#39; (stream_subsequence ss&#39; kss&#39;))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk130" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk130"><span class="highlight"><span class="nb">assert</span>
    (Heq :
      hd (Str_nth_tl n&#39; (stream_subsequence ss&#39; kss&#39;))
      =
      Str_nth n&#39; (stream_subsequence ss&#39; kss&#39;)
    ) <span class="bp">by</span> <span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">hd (proj1_sig kss)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth k ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl n&#39; (stream_subsequence ss&#39; kss&#39;)) =
Str_nth n&#39; (stream_subsequence ss&#39; kss&#39;)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (Str_nth (S n&#39;) (proj1_sig kss)) ss =
hd (Str_nth_tl n&#39; (stream_subsequence ss&#39; kss&#39;))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk131" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk131"><span class="highlight"><span class="nb">rewrite</span> Heq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">hd (proj1_sig kss)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth k ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl n&#39; (stream_subsequence ss&#39; kss&#39;)) =
Str_nth n&#39; (stream_subsequence ss&#39; kss&#39;)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (Str_nth (S n&#39;) (proj1_sig kss)) ss =
Str_nth n&#39; (stream_subsequence ss&#39; kss&#39;)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk132" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk132"><span class="highlight"><span class="nb">unfold</span> stream_subsequence.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">hd (proj1_sig kss)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth k ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl n&#39; (stream_subsequence ss&#39; kss&#39;)) =
Str_nth n&#39; (stream_subsequence ss&#39; kss&#39;)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (Str_nth (S n&#39;) (proj1_sig kss)) ss =
Str_nth n&#39;
  (map (<span class="kr">fun</span> <span class="nv">k</span> : nat =&gt; Str_nth k ss&#39;) (proj1_sig kss&#39;))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk133" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk133"><span class="highlight"><span class="nb">rewrite</span> Str_nth_map.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">hd (proj1_sig kss)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth k ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl n&#39; (stream_subsequence ss&#39; kss&#39;)) =
Str_nth n&#39; (stream_subsequence ss&#39; kss&#39;)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (Str_nth (S n&#39;) (proj1_sig kss)) ss =
Str_nth (Str_nth n&#39; (proj1_sig kss&#39;)) ss&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk134" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk134"><span class="highlight"><span class="nb">unfold</span> ss&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">hd (proj1_sig kss)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth k ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl n&#39; (stream_subsequence ss&#39; kss&#39;)) =
Str_nth n&#39; (stream_subsequence ss&#39; kss&#39;)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (Str_nth (S n&#39;) (proj1_sig kss)) ss =
Str_nth (Str_nth n&#39; (proj1_sig kss&#39;))
  (stream_suffix ss (S k))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk135" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk135"><span class="highlight"><span class="nb">rewrite</span> stream_suffix_nth.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">hd (proj1_sig kss)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth k ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix kss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl n&#39; (stream_subsequence ss&#39; kss&#39;)) =
Str_nth n&#39; (stream_subsequence ss&#39; kss&#39;)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (Str_nth (S n&#39;) (proj1_sig kss)) ss =
Str_nth (Str_nth n&#39; (proj1_sig kss&#39;) + S k) ss</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk136" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk136"><span class="highlight"><span class="nb">destruct</span> kss <span class="kr">as</span> [ks Hks]; <span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">hd
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) ks Hks))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth k ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) ks Hks)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl n&#39; (stream_subsequence ss&#39; kss&#39;)) =
Str_nth n&#39; (stream_subsequence ss&#39; kss&#39;)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (Str_nth (S n&#39;) ks) ss =
Str_nth (Str_nth n&#39; (nat_sequence_suffix ks) + S k) ss</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk137" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk137"><span class="highlight"><span class="nb">unfold</span> nat_sequence_suffix.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">hd
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) ks Hks))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth k ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) ks Hks)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl n&#39; (stream_subsequence ss&#39; kss&#39;)) =
Str_nth n&#39; (stream_subsequence ss&#39; kss&#39;)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (Str_nth (S n&#39;) ks) ss =
Str_nth
  (Str_nth n&#39;
     (map (<span class="kr">fun</span> <span class="nv">i</span> : nat =&gt; i - S (hd ks)) (tl ks)) +
   S k) ss</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk138" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk138"><span class="highlight"><span class="nb">rewrite</span> Str_nth_map.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">hd
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) ks Hks))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth k ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) ks Hks)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl n&#39; (stream_subsequence ss&#39; kss&#39;)) =
Str_nth n&#39; (stream_subsequence ss&#39; kss&#39;)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (Str_nth (S n&#39;) ks) ss =
Str_nth (Str_nth n&#39; (tl ks) - S (hd ks) + S k) ss</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk139" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk139"><span class="highlight"><span class="nb">unfold</span> k <span class="kr">in</span> *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">hd
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) ks Hks))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth
  (hd
     (proj1_sig
        (exist
           (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
            monotone_nat_stream_prop s) ks Hks)))
  ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix ss
  (S
     (hd
        (proj1_sig
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s) ks Hks))))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) ks Hks)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl n&#39; (stream_subsequence ss&#39; kss&#39;)) =
Str_nth n&#39; (stream_subsequence ss&#39; kss&#39;)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (Str_nth (S n&#39;) ks) ss =
Str_nth
  (Str_nth n&#39; (tl ks) - S (hd ks) +
   S
     (hd
        (proj1_sig
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s) ks Hks))))
  ss</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk13a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk13a"><span class="highlight"><span class="nb">clear</span> k.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth
  (hd
     (proj1_sig
        (exist
           (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
            monotone_nat_stream_prop s) ks Hks)))
  ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix ss
  (S
     (hd
        (proj1_sig
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s) ks Hks))))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) ks Hks)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl n&#39; (stream_subsequence ss&#39; kss&#39;)) =
Str_nth n&#39; (stream_subsequence ss&#39; kss&#39;)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (Str_nth (S n&#39;) ks) ss =
Str_nth
  (Str_nth n&#39; (tl ks) - S (hd ks) +
   S
     (hd
        (proj1_sig
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s) ks Hks))))
  ss</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk13b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk13b"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth
  (hd
     (proj1_sig
        (exist
           (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
            monotone_nat_stream_prop s) ks Hks)))
  ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix ss
  (S
     (hd
        (proj1_sig
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s) ks Hks))))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) ks Hks)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl n&#39; (stream_subsequence ss&#39; kss&#39;)) =
Str_nth n&#39; (stream_subsequence ss&#39; kss&#39;)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (Str_nth (S n&#39;) ks) ss =
Str_nth (Str_nth n&#39; (tl ks) - S (hd ks) + S (hd ks))
  ss</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk13c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk13c"><span class="highlight"><span class="nb">unfold</span> n <span class="kr">in</span> *; <span class="nb">clear</span> n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix ss
  (S
     (hd
        (proj1_sig
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s) ks Hks))))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) ks Hks)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl n&#39; (stream_subsequence ss&#39; kss&#39;)) =
Str_nth n&#39; (stream_subsequence ss&#39; kss&#39;)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (Str_nth (S n&#39;) ks) ss =
Str_nth (Str_nth n&#39; (tl ks) - S (hd ks) + S (hd ks))
  ss</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk13d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk13d"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> ss&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix (tl ss) (hd ks)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) ks Hks)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl n&#39; (stream_subsequence ss&#39; kss&#39;)) =
Str_nth n&#39; (stream_subsequence ss&#39; kss&#39;)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (Str_nth (S n&#39;) ks) ss =
Str_nth (Str_nth n&#39; (tl ks) - S (hd ks) + S (hd ks))
  ss</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk13e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk13e"><span class="highlight"><span class="nb">clear</span> Heq kss&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix (tl ss) (hd ks)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (Str_nth (S n&#39;) ks) ss =
Str_nth (Str_nth n&#39; (tl ks) - S (hd ks) + S (hd ks))
  ss</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk13f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk13f"><span class="highlight"><span class="nb">assert</span> (Hlt : <span class="mi">0</span> &lt; S n&#39;) <span class="bp">by</span> <span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix (tl ss) (hd ks)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (Str_nth (S n&#39;) ks) ss =
Str_nth (Str_nth n&#39; (tl ks) - S (hd ks) + S (hd ks))
  ss</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk140" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk140"><span class="highlight"><span class="nb">specialize</span> (Hks <span class="mi">0</span> (S n&#39;) Hlt).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth <span class="mi">0</span> ks &lt; Str_nth (S n&#39;) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix (tl ss) (hd ks)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (Str_nth (S n&#39;) ks) ss =
Str_nth (Str_nth n&#39; (tl ks) - S (hd ks) + S (hd ks))
  ss</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk141" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk141"><span class="highlight"><span class="nb">replace</span> (Str_nth n&#39; (tl ks) - S (hd ks) + S (hd ks)) <span class="kr">with</span> (Str_nth (S n&#39;) ks)
  ; <span class="kp">try</span> <span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth <span class="mi">0</span> ks &lt; Str_nth (S n&#39;) ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix (tl ss) (hd ks)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (S n&#39;) ks =
Str_nth n&#39; (tl ks) - S (hd ks) + S (hd ks)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk142" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk142"><span class="highlight"><span class="nb">unfold</span> Str_nth <span class="kr">in</span> Hks; <span class="nb">simpl</span> <span class="kr">in</span> Hks.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd ks &lt; hd (Str_nth_tl n&#39; (tl ks))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix (tl ss) (hd ks)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (S n&#39;) ks =
Str_nth n&#39; (tl ks) - S (hd ks) + S (hd ks)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk143" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk143"><span class="highlight"><span class="nb">unfold</span> Str_nth; <span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd ks &lt; hd (Str_nth_tl n&#39; (tl ks))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_suffix (tl ss) (hd ks)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">hd (Str_nth_tl n&#39; (tl ks)) =
hd (Str_nth_tl n&#39; (tl ks)) - S (hd ks) + S (hd ks)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk144" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk144"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">all_ForAll_hd</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">P</span> : A -&gt; <span class="kt">Prop</span>)
  (<span class="nv">s</span> : Stream A)
  (<span class="nv">Hall</span> : <span class="kr">forall</span> <span class="nv">n</span> : nat, P (Str_nth n s))
  : ForAll (<span class="kr">fun</span> <span class="nv">str</span> =&gt; P (hd str)) s.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hall</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, P (Str_nth n s)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk145" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk145"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hall</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, P (Str_nth n s)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk146" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk146"><span class="highlight"><span class="nb">apply</span> ForAll_coind <span class="kr">with</span> (<span class="kr">fun</span> <span class="nv">s</span> : Stream A =&gt; <span class="kr">forall</span> <span class="nv">n</span> : nat, P (Str_nth n s))
  ; <span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hall</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, P (Str_nth n s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, P (Str_nth n x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (hd x)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk147" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hall</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, P (Str_nth n s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, P (Str_nth n x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chk147"><hr></label><div class="goal-conclusion"><span class="highlight">P (Str_nth n (tl x))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk148" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hall</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, P (Str_nth n s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chk148"><hr></label><div class="goal-conclusion"><span class="highlight">P (Str_nth n s)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk149" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk149"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hall</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, P (Str_nth n s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, P (Str_nth n x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (hd x)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk14a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk14a"><span class="highlight"><span class="nb">specialize</span> (H <span class="mi">0</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hall</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, P (Str_nth n s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth <span class="mi">0</span> x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (hd x)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">assumption</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk14b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk14b"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hall</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, P (Str_nth n s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, P (Str_nth n x)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (Str_nth n (tl x))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk14c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk14c"><span class="highlight"><span class="nb">specialize</span> (H (S n)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hall</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, P (Str_nth n s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (S n) x)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (Str_nth n (tl x))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">assumption</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk14d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk14d"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hall</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, P (Str_nth n s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (Str_nth n s)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> Hall.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk14e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk14e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_filter_Forall</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">P</span> : A -&gt; <span class="kt">Prop</span>)
  (<span class="nv">s</span> : Stream A)
  (<span class="nv">ss</span> : monotone_nat_stream)
  (<span class="nv">s&#39;</span> := stream_subsequence s ss)
  (<span class="nv">Hfs</span> : filtering_subsequence P s ss)
  : ForAll (<span class="kr">fun</span> <span class="nv">str</span> =&gt; P (hd str)) s&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_subsequence s ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P s ss</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk14f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk14f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_subsequence s ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P s ss</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk150" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk150"><span class="highlight"><span class="nb">apply</span> all_ForAll_hd.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_subsequence s ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P s ss</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, P (Str_nth n s&#39;)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk151" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk151"><span class="highlight"><span class="nb">intro</span> n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_subsequence s ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P s ss</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (Str_nth n s&#39;)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk152" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk152"><span class="highlight"><span class="nb">unfold</span> s&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_subsequence s ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P s ss</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (Str_nth n (stream_subsequence s ss))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk153" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk153"><span class="highlight"><span class="nb">unfold</span> stream_subsequence.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_subsequence s ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P s ss</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P
  (Str_nth n
     (map (<span class="kr">fun</span> <span class="nv">k</span> : nat =&gt; Str_nth k s) (proj1_sig ss)))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk154" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk154"><span class="highlight"><span class="nb">rewrite</span> Str_nth_map.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_subsequence s ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P s ss</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (Str_nth (Str_nth n (proj1_sig ss)) s)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk155" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk155"><span class="highlight"><span class="nb">apply</span> filtering_subsequence_witness.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s'</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_subsequence s ss</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P s ss</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">filtering_subsequence (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; P a) s ss</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">assumption</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">CoFixpoint</span> <span class="nf">stream_annotate</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">P</span> : A -&gt; <span class="kt">Prop</span>)
  (<span class="nv">s</span> : Stream A)
  (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> =&gt; P (hd str)) s)
  : Stream (sig P) :=
  <span class="kr">match</span> Hs <span class="kr">with</span>
  | HereAndFurther _ H Hs&#39;
    =&gt; Cons (exist _ (hd s) H) (stream_annotate P (tl s) Hs&#39;)
  <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk156" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk156"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_prefix_Forall</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">P</span> : A -&gt; <span class="kt">Prop</span>)
  (<span class="nv">s</span> : Stream A)
  (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> =&gt; P (hd str)) s)
  : <span class="kr">forall</span> <span class="nv">n</span> : nat, Forall P (stream_prefix s n).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, Forall P (stream_prefix s n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk157" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk157"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, Forall P (stream_prefix s n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk158" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk158"><span class="highlight"><span class="nb">intros</span> n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall P (stream_prefix s n)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk159" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk159"><span class="highlight"><span class="nb">generalize dependent</span> s.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s -&gt;
Forall P (stream_prefix s n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk15a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk15a"><span class="highlight"><span class="nb">induction</span> n; <span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall P (stream_prefix s <span class="mi">0</span>)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk15b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s -&gt; Forall P (stream_prefix s n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chk15b"><hr></label><div class="goal-conclusion"><span class="highlight">Forall P (stream_prefix s (S n))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk15c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk15c"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall P (stream_prefix s <span class="mi">0</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">constructor</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk15d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk15d"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s -&gt; Forall P (stream_prefix s n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall P (stream_prefix s (S n))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk15e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk15e"><span class="highlight"><span class="nb">destruct</span> s <span class="kr">as</span> (a,s).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s -&gt; Forall P (stream_prefix s n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (Cons a s)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall P (stream_prefix (Cons a s) (S n))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk15f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk15f"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s -&gt; Forall P (stream_prefix s n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (Cons a s)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall P (a :: stream_prefix s n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk160" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk160"><span class="highlight"><span class="nb">inversion</span> Hs.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s -&gt; Forall P (stream_prefix s n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (Cons a s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (hd (Cons a s))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (tl (Cons a s))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall P (a :: stream_prefix s n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk161" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk161"><span class="highlight"><span class="nb">constructor</span>; <span class="kp">try</span> <span class="bp">assumption</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s -&gt; Forall P (stream_prefix s n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (Cons a s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (hd (Cons a s))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (tl (Cons a s))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall P (stream_prefix s n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk162" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk162"><span class="highlight"><span class="nb">apply</span> IHn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s -&gt; Forall P (stream_prefix s n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (Cons a s)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (hd (Cons a s))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (tl (Cons a s))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">assumption</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk163" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk163"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_prefix_Forall_rev</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">P</span> : A -&gt; <span class="kt">Prop</span>)
  (<span class="nv">s</span> : Stream A)
  (<span class="nv">Hpref</span>: <span class="kr">forall</span> <span class="nv">n</span> : nat, Forall P (stream_prefix s n))
  : ForAll (<span class="kr">fun</span> <span class="nv">str</span> =&gt; P (hd str)) s.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, Forall P (stream_prefix s n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk164" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk164"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat, Forall P (stream_prefix s n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk165" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk165"><span class="highlight"><span class="nb">generalize dependent</span> s.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
(<span class="kr">forall</span> <span class="nv">n</span> : nat, Forall P (stream_prefix s n)) -&gt;
ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk166" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk166"><span class="highlight"><span class="kr">cofix</span> H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
(<span class="kr">forall</span> <span class="nv">n</span> : nat, Forall P (stream_prefix s n)) -&gt;
ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
(<span class="kr">forall</span> <span class="nv">n</span> : nat, Forall P (stream_prefix s n)) -&gt;
ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk167" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk167"><span class="highlight"><span class="nb">intros</span> (a, s) Hpref.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
(<span class="kr">forall</span> <span class="nv">n</span> : nat, Forall P (stream_prefix s n)) -&gt;
ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
Forall P (stream_prefix (Cons a s) n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) (Cons a s)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk168" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk168"><span class="highlight"><span class="nb">constructor</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
(<span class="kr">forall</span> <span class="nv">n</span> : nat, Forall P (stream_prefix s n)) -&gt;
ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
Forall P (stream_prefix (Cons a s) n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (hd (Cons a s))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk169" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
(<span class="kr">forall</span> <span class="nv">n</span> : nat, Forall P (stream_prefix s n)) -&gt;
ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
Forall P (stream_prefix (Cons a s) n)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chk169"><hr></label><div class="goal-conclusion"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (tl (Cons a s))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk16a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk16a"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
(<span class="kr">forall</span> <span class="nv">n</span> : nat, Forall P (stream_prefix s n)) -&gt;
ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
Forall P (stream_prefix (Cons a s) n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (hd (Cons a s))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk16b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk16b"><span class="highlight"><span class="nb">specialize</span> (Hpref <span class="mi">1</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
(<span class="kr">forall</span> <span class="nv">n</span> : nat, Forall P (stream_prefix s n)) -&gt;
ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall P (stream_prefix (Cons a s) <span class="mi">1</span>)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (hd (Cons a s))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk16c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk16c"><span class="highlight"><span class="nb">inversion</span> Hpref.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
(<span class="kr">forall</span> <span class="nv">n</span> : nat, Forall P (stream_prefix s n)) -&gt;
ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall P (stream_prefix (Cons a s) <span class="mi">1</span>)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall P []</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">l = []</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (hd (Cons a s))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">assumption</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk16d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk16d"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
(<span class="kr">forall</span> <span class="nv">n</span> : nat, Forall P (stream_prefix s n)) -&gt;
ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
Forall P (stream_prefix (Cons a s) n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (tl (Cons a s))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk16e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk16e"><span class="highlight"><span class="nb">apply</span> H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
(<span class="kr">forall</span> <span class="nv">n</span> : nat, Forall P (stream_prefix s n)) -&gt;
ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
Forall P (stream_prefix (Cons a s) n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
Forall P (stream_prefix (tl (Cons a s)) n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk16f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk16f"><span class="highlight"><span class="nb">intro</span> n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
(<span class="kr">forall</span> <span class="nv">n</span> : nat, Forall P (stream_prefix s n)) -&gt;
ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
Forall P (stream_prefix (Cons a s) n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall P (stream_prefix (tl (Cons a s)) n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk170" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk170"><span class="highlight"><span class="nb">specialize</span> (Hpref (S n)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
(<span class="kr">forall</span> <span class="nv">n</span> : nat, Forall P (stream_prefix s n)) -&gt;
ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall P (stream_prefix (Cons a s) (S n))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall P (stream_prefix (tl (Cons a s)) n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk171" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk171"><span class="highlight"><span class="nb">inversion</span> Hpref.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
(<span class="kr">forall</span> <span class="nv">n</span> : nat, Forall P (stream_prefix s n)) -&gt;
ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall P (stream_prefix (Cons a s) (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall P (stream_prefix s n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">l = stream_prefix s n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall P (stream_prefix (tl (Cons a s)) n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">assumption</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk172" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk172"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_prefix_annotate</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">P</span> : A -&gt; <span class="kt">Prop</span>)
  (<span class="nv">s</span> : Stream A)
  (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> =&gt; P (hd str)) s)
  (<span class="nv">n</span> : nat)
  : <span class="kr">exists</span> <span class="nv">Hs&#39;</span>, stream_prefix (stream_annotate P s Hs) n
  = list_annotate P (stream_prefix s n) Hs&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">Hs&#39;</span> : Forall P (stream_prefix s n),
  stream_prefix (stream_annotate P s Hs) n =
  list_annotate P (stream_prefix s n) Hs&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk173" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk173"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">Hs&#39;</span> : Forall P (stream_prefix s n),
  stream_prefix (stream_annotate P s Hs) n =
  list_annotate P (stream_prefix s n) Hs&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk174" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk174"><span class="highlight"><span class="nb">generalize dependent</span> s.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A)
  (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s),
<span class="kr">exists</span> <span class="nv">Hs&#39;</span> : Forall P (stream_prefix s n),
  stream_prefix (stream_annotate P s Hs) n =
  list_annotate P (stream_prefix s n) Hs&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk175" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk175"><span class="highlight"><span class="nb">induction</span> n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A)
  (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s),
<span class="kr">exists</span> <span class="nv">Hs&#39;</span> : Forall P (stream_prefix s <span class="mi">0</span>),
  stream_prefix (stream_annotate P s Hs) <span class="mi">0</span> =
  list_annotate P (stream_prefix s <span class="mi">0</span>) Hs&#39;</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk176" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A) (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s),
<span class="kr">exists</span> <span class="nv">Hs&#39;</span> : Forall P (stream_prefix s n),
stream_prefix (stream_annotate P s Hs) n =
list_annotate P (stream_prefix s n) Hs&#39;</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chk176"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A)
  (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s),
<span class="kr">exists</span> <span class="nv">Hs&#39;</span> : Forall P (stream_prefix s (S n)),
  stream_prefix (stream_annotate P s Hs) (S n) =
  list_annotate P (stream_prefix s (S n)) Hs&#39;</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk177" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk177"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A)
  (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s),
<span class="kr">exists</span> <span class="nv">Hs&#39;</span> : Forall P (stream_prefix s <span class="mi">0</span>),
  stream_prefix (stream_annotate P s Hs) <span class="mi">0</span> =
  list_annotate P (stream_prefix s <span class="mi">0</span>) Hs&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk178" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk178"><span class="highlight"><span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">Hs&#39;</span> : Forall P (stream_prefix s <span class="mi">0</span>),
  stream_prefix (stream_annotate P s Hs) <span class="mi">0</span> =
  list_annotate P (stream_prefix s <span class="mi">0</span>) Hs&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk179" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk179"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">_</span> : Forall P [], [] = []</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk17a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk17a"><span class="highlight"><span class="kr">exists</span> (<span class="nv">Forall_nil</span> <span class="nv">P</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[] = []</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk17b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk17b"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A) (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s),
<span class="kr">exists</span> <span class="nv">Hs&#39;</span> : Forall P (stream_prefix s n),
stream_prefix (stream_annotate P s Hs) n =
list_annotate P (stream_prefix s n) Hs&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A)
  (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s),
<span class="kr">exists</span> <span class="nv">Hs&#39;</span> : Forall P (stream_prefix s (S n)),
  stream_prefix (stream_annotate P s Hs) (S n) =
  list_annotate P (stream_prefix s (S n)) Hs&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk17c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk17c"><span class="highlight"><span class="nb">intros</span> (a, s) (H, H0).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A) (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s),
<span class="kr">exists</span> <span class="nv">Hs&#39;</span> : Forall P (stream_prefix s n),
stream_prefix (stream_annotate P s Hs) n =
list_annotate P (stream_prefix s n) Hs&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (hd (Cons a s))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (tl (Cons a s))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span>
  <span class="nv">Hs&#39;</span> : Forall P (stream_prefix (Cons a s) (S n)),
  stream_prefix
    (stream_annotate P (Cons a s)
       (HereAndFurther (Cons a s) H H0)) (S n) =
  list_annotate P (stream_prefix (Cons a s) (S n)) Hs&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk17d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk17d"><span class="highlight"><span class="nb">specialize</span> (IHn s H0).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (tl (Cons a s))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">exists</span> <span class="nv">Hs&#39;</span> : Forall P (stream_prefix s n),
stream_prefix (stream_annotate P s H0) n =
list_annotate P (stream_prefix s n) Hs&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (hd (Cons a s))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span>
  <span class="nv">Hs&#39;</span> : Forall P (stream_prefix (Cons a s) (S n)),
  stream_prefix
    (stream_annotate P (Cons a s)
       (HereAndFurther (Cons a s) H H0)) (S n) =
  list_annotate P (stream_prefix (Cons a s) (S n)) Hs&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk17e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk17e"><span class="highlight"><span class="nb">destruct</span> IHn <span class="kr">as</span> [Hs&#39; Heq].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (tl (Cons a s))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall P (stream_prefix s n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix (stream_annotate P s H0) n =
list_annotate P (stream_prefix s n) Hs&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (hd (Cons a s))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span>
  <span class="nv">Hs&#39;</span> : Forall P (stream_prefix (Cons a s) (S n)),
  stream_prefix
    (stream_annotate P (Cons a s)
       (HereAndFurther (Cons a s) H H0)) (S n) =
  list_annotate P (stream_prefix (Cons a s) (S n)) Hs&#39;</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk17f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk17f"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (tl (Cons a s))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall P (stream_prefix s n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix (stream_annotate P s H0) n =
list_annotate P (stream_prefix s n) Hs&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (hd (Cons a s))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">Hs&#39;</span> : Forall P (a :: stream_prefix s n),
  exist P a H
  :: stream_prefix (stream_annotate P s H0) n =
  exist P a (Forall_hd Hs&#39;)
  :: list_annotate P (stream_prefix s n)
       (Forall_tl Hs&#39;)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk180" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk180"><span class="highlight"><span class="nb">rewrite</span> Heq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (tl (Cons a s))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall P (stream_prefix s n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix (stream_annotate P s H0) n =
list_annotate P (stream_prefix s n) Hs&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (hd (Cons a s))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">Hs&#39;0</span> : Forall P (a :: stream_prefix s n),
  exist P a H
  :: list_annotate P (stream_prefix s n) Hs&#39; =
  exist P a (Forall_hd Hs&#39;0)
  :: list_annotate P (stream_prefix s n)
       (Forall_tl Hs&#39;0)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk181" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk181"><span class="highlight"><span class="kr">exists</span> (@Forall_cons A P _ _ H Hs&#39;).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (tl (Cons a s))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall P (stream_prefix s n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix (stream_annotate P s H0) n =
list_annotate P (stream_prefix s n) Hs&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (hd (Cons a s))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">exist P a H :: list_annotate P (stream_prefix s n) Hs&#39; =
exist P a
  (Forall_hd (Forall_cons (hd (Cons a s)) H Hs&#39;))
:: list_annotate P (stream_prefix s n)
     (Forall_tl (Forall_cons (hd (Cons a s)) H Hs&#39;))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk182" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk182"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (tl (Cons a s))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Forall P (stream_prefix s n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix (stream_annotate P s H0) n =
list_annotate P (stream_prefix s n) Hs&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (hd (Cons a s))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">exist P a H :: list_annotate P (stream_prefix s n) Hs&#39; =
exist P a
  (eq_ind_r
     (<span class="kr">fun</span> <span class="nv">a0</span> : A =&gt;
      stream_prefix s n = stream_prefix s n -&gt;
      P a0 -&gt; Forall P (stream_prefix s n) -&gt; P a)
     (<span class="kr">fun</span> <span class="nv">H0</span> : stream_prefix s n = stream_prefix s n
      =&gt;
      eq_ind_r
        (<span class="kr">fun</span> <span class="nv">l</span> : list A =&gt; P a -&gt; Forall P l -&gt; P a)
        (<span class="kr">fun</span> (<span class="nv">H1</span> : P a)
           (<span class="nv">_</span> : Forall P (stream_prefix s n)) =&gt; H1)
        H0) eq_refl eq_refl H Hs&#39;)
:: list_annotate P (stream_prefix s n)
     (eq_ind_r
        (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt;
         stream_prefix s n = stream_prefix s n -&gt;
         P a -&gt;
         Forall P (stream_prefix s n) -&gt;
         Forall P (stream_prefix s n))
        (<span class="kr">fun</span>
           <span class="nv">H0</span> : stream_prefix s n = stream_prefix s n
         =&gt;
         eq_ind_r
           (<span class="kr">fun</span> <span class="nv">l</span> : list A =&gt;
            P a -&gt;
            Forall P l -&gt; Forall P (stream_prefix s n))
           (<span class="kr">fun</span> (<span class="nv">_</span> : P a)
              (<span class="nv">H2</span> : Forall P (stream_prefix s n)) =&gt;
            H2) H0) eq_refl eq_refl H Hs&#39;)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">f_equal</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk183" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk183"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_annotate_proj</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">P</span> : A -&gt; <span class="kt">Prop</span>)
  : <span class="kr">forall</span>
    (<span class="nv">s</span> : Stream A)
    (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> =&gt; P (hd str)) s)
    , EqSt s (map (@proj1_sig _ _) (stream_annotate P s Hs)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A)
  (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s),
EqSt s
  (map (proj1_sig (P:=P)) (stream_annotate P s Hs))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk184" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk184"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A)
  (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s),
EqSt s
  (map (proj1_sig (P:=P)) (stream_annotate P s Hs))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk185" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk185"><span class="highlight"><span class="kr">cofix</span> cf.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A)
  (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
          s),
EqSt s
  (map (proj1_sig (P:=P))
     (stream_annotate P s Hs))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A)
  (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str)) s),
EqSt s
  (map (proj1_sig (P:=P)) (stream_annotate P s Hs))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk186" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk186"><span class="highlight"><span class="nb">intros</span> (x, s) Hs.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A)
  (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
          s),
EqSt s
  (map (proj1_sig (P:=P))
     (stream_annotate P s Hs))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (Cons x s)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt (Cons x s)
  (map (proj1_sig (P:=P))
     (stream_annotate P (Cons x s) Hs))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk187" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk187"><span class="highlight"><span class="nb">constructor</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A)
  (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
          s),
EqSt s
  (map (proj1_sig (P:=P))
     (stream_annotate P s Hs))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (Cons x s)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">hd (Cons x s) =
hd
  (map (proj1_sig (P:=P))
     (stream_annotate P (Cons x s) Hs))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk188" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A)
  (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
          s),
EqSt s
  (map (proj1_sig (P:=P))
     (stream_annotate P s Hs))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (Cons x s)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chk188"><hr></label><div class="goal-conclusion"><span class="highlight">EqSt (tl (Cons x s))
  (tl
     (map (proj1_sig (P:=P))
        (stream_annotate P (Cons x s) Hs)))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk189" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk189"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A)
  (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
          s),
EqSt s
  (map (proj1_sig (P:=P))
     (stream_annotate P s Hs))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (Cons x s)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">hd (Cons x s) =
hd
  (map (proj1_sig (P:=P))
     (stream_annotate P (Cons x s) Hs))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk18a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk18a"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A)
  (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
          s),
EqSt s
  (map (proj1_sig (P:=P))
     (stream_annotate P s Hs))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (Cons x s)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x =
proj1_sig
  <span class="kr">match</span>
    <span class="kr">match</span> Hs <span class="kr">with</span>
    | HereAndFurther _ H Hs&#39; =&gt;
        Cons (exist P x H) (stream_annotate P s Hs&#39;)
    <span class="kr">end</span>
  <span class="kr">with</span>
  | Cons a _ =&gt; a
  <span class="kr">end</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk18b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk18b"><span class="highlight"><span class="nb">destruct</span> Hs.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A)
  (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
          s),
EqSt s
  (map (proj1_sig (P:=P))
     (stream_annotate P s Hs))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (hd (Cons x s))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (tl (Cons x s))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x = proj1_sig (exist P x p)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">trivial</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk18c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk18c"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A)
  (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
          s),
EqSt s
  (map (proj1_sig (P:=P))
     (stream_annotate P s Hs))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (Cons x s)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt (tl (Cons x s))
  (tl
     (map (proj1_sig (P:=P))
        (stream_annotate P (Cons x s) Hs)))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk18d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk18d"><span class="highlight"><span class="nb">destruct</span> Hs.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A)
  (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
          s),
EqSt s
  (map (proj1_sig (P:=P))
     (stream_annotate P s Hs))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (hd (Cons x s))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (tl (Cons x s))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt (tl (Cons x s))
  (tl
     (map (proj1_sig (P:=P))
        (stream_annotate P (Cons x s)
           (HereAndFurther (Cons x s) p Hs))))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk18e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk18e"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">s</span> : Stream A)
  (<span class="nv">Hs</span> : ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
          s),
EqSt s
  (map (proj1_sig (P:=P))
     (stream_annotate P s Hs))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (hd (Cons x s))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ForAll (<span class="kr">fun</span> <span class="nv">str</span> : Stream A =&gt; P (hd str))
  (tl (Cons x s))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt s
  ((<span class="kr">cofix</span> map (s : Stream {x : A | P x}) : Stream A :=
      Cons (proj1_sig (hd s)) (map (tl s)))
     (stream_annotate P s Hs))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> cf.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk18f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk18f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_prefix_succ</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">s</span> : Stream A)
  (<span class="nv">n</span> : nat)
  : stream_prefix s (S n) = stream_prefix s n ++ [Str_nth n s].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix s (S n) =
stream_prefix s n ++ [Str_nth n s]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk190" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk190"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix s (S n) =
stream_prefix s n ++ [Str_nth n s]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk191" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk191"><span class="highlight"><span class="nb">specialize</span> (stream_prefix_suffix s n).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_app (stream_prefix s n) (stream_suffix s n) = s -&gt;
stream_prefix s (S n) =
stream_prefix s n ++ [Str_nth n s]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk192" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk192"><span class="highlight"><span class="nb">rewrite</span> stream_suffix_S.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_app (stream_prefix s n)
  (Cons (Str_nth n s) (stream_suffix s (S n))) = s -&gt;
stream_prefix s (S n) =
stream_prefix s n ++ [Str_nth n s]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk193" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk193"><span class="highlight"><span class="nb">rewrite</span> &lt;- stream_app_cons.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_app (stream_prefix s n)
  (stream_app [Str_nth n s] (stream_suffix s (S n))) =
s -&gt;
stream_prefix s (S n) =
stream_prefix s n ++ [Str_nth n s]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk194" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk194"><span class="highlight"><span class="nb">rewrite</span> stream_app_assoc.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_app (stream_prefix s n ++ [Str_nth n s])
  (stream_suffix s (S n)) = s -&gt;
stream_prefix s (S n) =
stream_prefix s n ++ [Str_nth n s]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk195" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk195"><span class="highlight"><span class="nb">intros</span> Hn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (stream_prefix s n ++ [Str_nth n s])
  (stream_suffix s (S n)) = s</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix s (S n) =
stream_prefix s n ++ [Str_nth n s]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk196" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk196"><span class="highlight"><span class="nb">specialize</span> (stream_prefix_suffix s (S n)); <span class="nb">intros</span> Hsn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (stream_prefix s n ++ [Str_nth n s])
  (stream_suffix s (S n)) = s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (stream_prefix s (S n)) (stream_suffix s (S n)) = s</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix s (S n) =
stream_prefix s n ++ [Str_nth n s]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk197" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk197"><span class="highlight"><span class="nb">rewrite</span> &lt;- Hsn <span class="kr">in</span> Hn <span class="nb">at</span> <span class="mi">4</span>; <span class="nb">clear</span> Hsn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (stream_prefix s n ++ [Str_nth n s])
  (stream_suffix s (S n)) =
stream_app (stream_prefix s (S n))
  (stream_suffix s (S n))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix s (S n) =
stream_prefix s n ++ [Str_nth n s]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk198" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk198"><span class="highlight"><span class="nb">specialize</span>
    (stream_app_inj_l
      (stream_prefix s n ++ [Str_nth n s])
      (stream_prefix s (S n))
      (stream_suffix s (S n))
      Hn
    ); <span class="nb">intros</span> Hinj.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (stream_prefix s n ++ [Str_nth n s])
  (stream_suffix s (S n)) =
stream_app (stream_prefix s (S n))
  (stream_suffix s (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hinj</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length (stream_prefix s n ++ [Str_nth n s]) =
length (stream_prefix s (S n)) -&gt;
stream_prefix s n ++ [Str_nth n s] =
stream_prefix s (S n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix s (S n) =
stream_prefix s n ++ [Str_nth n s]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk199" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk199"><span class="highlight"><span class="nb">symmetry</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (stream_prefix s n ++ [Str_nth n s])
  (stream_suffix s (S n)) =
stream_app (stream_prefix s (S n))
  (stream_suffix s (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hinj</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length (stream_prefix s n ++ [Str_nth n s]) =
length (stream_prefix s (S n)) -&gt;
stream_prefix s n ++ [Str_nth n s] =
stream_prefix s (S n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix s n ++ [Str_nth n s] =
stream_prefix s (S n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk19a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk19a"><span class="highlight"><span class="nb">apply</span> Hinj.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (stream_prefix s n ++ [Str_nth n s])
  (stream_suffix s (S n)) =
stream_app (stream_prefix s (S n))
  (stream_suffix s (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hinj</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length (stream_prefix s n ++ [Str_nth n s]) =
length (stream_prefix s (S n)) -&gt;
stream_prefix s n ++ [Str_nth n s] =
stream_prefix s (S n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">length (stream_prefix s n ++ [Str_nth n s]) =
length (stream_prefix s (S n))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk19b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk19b"><span class="highlight"><span class="nb">rewrite</span> app_length.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (stream_prefix s n ++ [Str_nth n s])
  (stream_suffix s (S n)) =
stream_app (stream_prefix s (S n))
  (stream_suffix s (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hinj</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length (stream_prefix s n ++ [Str_nth n s]) =
length (stream_prefix s (S n)) -&gt;
stream_prefix s n ++ [Str_nth n s] =
stream_prefix s (S n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">length (stream_prefix s n) + length [Str_nth n s] =
length (stream_prefix s (S n))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk19c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk19c"><span class="highlight"><span class="kp">repeat</span> (<span class="nb">rewrite</span> stream_prefix_length).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (stream_prefix s n ++ [Str_nth n s])
  (stream_suffix s (S n)) =
stream_app (stream_prefix s (S n))
  (stream_suffix s (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hinj</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length (stream_prefix s n ++ [Str_nth n s]) =
length (stream_prefix s (S n)) -&gt;
stream_prefix s n ++ [Str_nth n s] =
stream_prefix s (S n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n + length [Str_nth n s] = S n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk19d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk19d"><span class="highlight"><span class="nb">rewrite</span> Plus.plus_comm.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_app (stream_prefix s n ++ [Str_nth n s])
  (stream_suffix s (S n)) =
stream_app (stream_prefix s (S n))
  (stream_suffix s (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hinj</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length (stream_prefix s n ++ [Str_nth n s]) =
length (stream_prefix s (S n)) -&gt;
stream_prefix s n ++ [Str_nth n s] =
stream_prefix s (S n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">length [Str_nth n s] + n = S n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk19e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk19e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_filter_prefix_0</span>
  `{<span class="kr">forall</span> (<span class="nv">a</span> : A), Decision (P a)}
  (ss : Stream A)
  (ks : monotone_nat_stream)
  (Hfs : filtering_subsequence P ss ks)
  (kn := Str_nth <span class="mi">0</span> (proj1_sig ks))
  (ss_to_kn := stream_prefix ss (S kn))
  : stream_prefix (stream_subsequence ss ks) (S <span class="mi">0</span>)
    = filter (<span class="kr">fun</span> <span class="nv">a</span> =&gt; bool_decide (P a)) ss_to_kn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth <span class="mi">0</span> (proj1_sig ks)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (stream_subsequence ss ks) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk19f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk19f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth <span class="mi">0</span> (proj1_sig ks)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (stream_subsequence ss ks) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1a0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1a0"><span class="highlight"><span class="nb">generalize dependent</span> ks.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">ks</span> : monotone_nat_stream,
filtering_subsequence P ss ks -&gt;
<span class="kr">let</span> <span class="nv">kn</span> := Str_nth <span class="mi">0</span> (proj1_sig ks) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix (stream_subsequence ss ks) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1a1" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1a1"><span class="highlight"><span class="nb">intros</span> [(k, ks) Hseq]; <span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth <span class="mi">0</span>
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1a2" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1a2"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> kn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth <span class="mi">0</span> (Cons k ks)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1a3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1a3"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth <span class="mi">0</span> (Cons k ks)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[Str_nth k ss] =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1a4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1a4"><span class="highlight"><span class="nb">unfold</span> Str_nth <span class="kr">in</span> kn; <span class="nb">simpl</span> <span class="kr">in</span> kn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">k</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[Str_nth k ss] =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1a5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1a5"><span class="highlight"><span class="nb">unfold</span> kn <span class="kr">in</span> *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">k</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[Str_nth k ss] =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1a6" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1a6"><span class="highlight"><span class="nb">clear</span> kn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[Str_nth k ss] =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1a7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1a7"><span class="highlight"><span class="nb">unfold</span> filtering_subsequence <span class="kr">in</span> Hfs.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat,
   Str_nth k0
     (proj1_sig
        (exist
           (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
            monotone_nat_stream_prop s)
           (Cons k ks) Hseq)) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[Str_nth k ss] =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1a8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1a8"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> Hfs.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[Str_nth k ss] =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1a9" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1a9"><span class="highlight"><span class="nb">unfold</span> ss_to_kn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[Str_nth k ss] =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss (S k))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1aa" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1aa"><span class="highlight"><span class="nb">rewrite</span> stream_prefix_succ.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[Str_nth k ss] =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss k ++ [Str_nth k ss])</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1ab" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1ab"><span class="highlight"><span class="nb">rewrite</span> filter_app.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[Str_nth k ss] =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss k) ++
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) [Str_nth k ss]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1ac" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1ac"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[Str_nth k ss] =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss k) ++
(<span class="kr">if</span> bool_decide (P (Str_nth k ss))
 <span class="kr">then</span> [Str_nth k ss]
 <span class="kr">else</span> [])</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1ad" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1ad"><span class="highlight"><span class="nb">rewrite</span> &lt;- decide_bool_decide.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[Str_nth k ss] =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss k) ++
(<span class="kr">if</span> decide (P (Str_nth k ss))
 <span class="kr">then</span> [Str_nth k ss]
 <span class="kr">else</span> [])</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1ae" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1ae"><span class="highlight"><span class="nb">assert</span> (P (Str_nth k ss)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (Str_nth k ss)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk1af" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chk1af"><hr></label><div class="goal-conclusion"><span class="highlight">[Str_nth k ss] =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss k) ++
(<span class="kr">if</span> decide (P (Str_nth k ss))
 <span class="kr">then</span> [Str_nth k ss]
 <span class="kr">else</span> [])</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1b0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1b0"><span class="highlight">{</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (Str_nth k ss)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1b1" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1b1"><span class="highlight"><span class="nb">destruct</span> (decide (P (Str_nth k ss))).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (Str_nth k ss)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk1b2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ P (Str_nth k ss)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chk1b2"><hr></label><div class="goal-conclusion"><span class="highlight">P (Str_nth k ss)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1b3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1b3"><span class="highlight"><span class="bp">assumption</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ P (Str_nth k ss)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (Str_nth k ss)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1b4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1b4"><span class="highlight"><span class="nb">specialize</span> (Hfs k).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ P (Str_nth k ss)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">P (Str_nth k ss)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1b5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1b5"><span class="highlight"><span class="nb">apply</span> Hfs.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ P (Str_nth k ss)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = k</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1b6" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1b6"><span class="highlight"><span class="kr">exists</span> <span class="mi">0</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ P (Str_nth k ss)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth <span class="mi">0</span> (Cons k ks) = k</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1b7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1b7"><span class="highlight">}</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[Str_nth k ss] =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss k) ++
(<span class="kr">if</span> decide (P (Str_nth k ss))
 <span class="kr">then</span> [Str_nth k ss]
 <span class="kr">else</span> [])</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1b8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1b8"><span class="highlight"><span class="nb">destruct</span> (decide (P (Str_nth k ss))); [|<span class="bp">tauto</span>].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[Str_nth k ss] =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss k) ++ [
Str_nth k ss]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1b9" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1b9"><span class="highlight"><span class="nb">replace</span> (filter _ (stream_prefix ss k)) <span class="kr">with</span> (@nil A)
  ; <span class="kp">try</span> <span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[] =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss k)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1ba" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1ba"><span class="highlight"><span class="nb">symmetry</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss k) = []</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1bb" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1bb"><span class="highlight"><span class="nb">apply</span> filter_nil.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Forall (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a) = false)
  (stream_prefix ss k)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1bc" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1bc"><span class="highlight"><span class="nb">rewrite</span> Forall_forall.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : A,
In x (stream_prefix ss k) -&gt; bool_decide (P x) = false</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1bd" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1bd"><span class="highlight"><span class="nb">intros</span> a Hin.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hin</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">In a (stream_prefix ss k)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">bool_decide (P a) = false</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1be" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1be"><span class="highlight"><span class="nb">rewrite</span> bool_decide_decide.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hin</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">In a (stream_prefix ss k)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> decide (P a) <span class="kr">then</span> true <span class="kr">else</span> false) = false</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1bf" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1bf"><span class="highlight"><span class="nb">destruct</span> (decide (P a)); [|<span class="bp">reflexivity</span>].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hin</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">In a (stream_prefix ss k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P a</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">true = false</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1c0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1c0"><span class="highlight"><span class="nb">exfalso</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hin</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">In a (stream_prefix ss k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P a</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1c1" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1c1"><span class="highlight"><span class="nb">apply</span> stream_prefix_in <span class="kr">in</span> Hin.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hin</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">exists</span> <span class="nv">k0</span> : nat, k0 &lt; k /\ Str_nth k0 ss = a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P a</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1c2" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1c2"><span class="highlight"><span class="nb">destruct</span> Hin <span class="kr">as</span> [k0 [Hlt Heq]]; <span class="nb">subst</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
P (Str_nth n ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat, Str_nth k0 (Cons k ks) = n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k0 &lt; k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k0 ss)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1c3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1c3"><span class="highlight"><span class="nb">specialize</span> (Hfs k0).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k0 ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k1</span> : nat, Str_nth k1 (Cons k ks) = k0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k0 &lt; k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k0 ss)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1c4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1c4"><span class="highlight"><span class="nb">apply</span> Hfs <span class="kr">in</span> p0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k0 ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k1</span> : nat, Str_nth k1 (Cons k ks) = k0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k0 &lt; k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">exists</span> <span class="nv">k1</span> : nat, Str_nth k1 (Cons k ks) = k0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1c5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1c5"><span class="highlight"><span class="nb">destruct</span> p0 <span class="kr">as</span> [i Heqki].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k0 ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k1</span> : nat, Str_nth k1 (Cons k ks) = k0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k0 &lt; k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqki</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth i (Cons k ks) = k0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1c6" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1c6"><span class="highlight"><span class="nb">specialize</span> (Hseq <span class="mi">0</span> i).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; i -&gt;
Str_nth <span class="mi">0</span> (Cons k ks) &lt; Str_nth i (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k0 ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k1</span> : nat, Str_nth k1 (Cons k ks) = k0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k0 &lt; k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqki</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth i (Cons k ks) = k0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kt">False</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1c7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1c7"><span class="highlight"><span class="nb">specialize</span> (Lt.lt_irrefl k0); <span class="nb">intro</span> Hk0; <span class="nb">elim</span> Hk0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; i -&gt;
Str_nth <span class="mi">0</span> (Cons k ks) &lt; Str_nth i (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k0 ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k1</span> : nat, Str_nth k1 (Cons k ks) = k0)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k0 &lt; k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqki</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth i (Cons k ks) = k0</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hk0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~ k0 &lt; k0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">k0 &lt; k0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1c8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1c8"><span class="highlight"><span class="nb">destruct</span> i; <span class="nb">subst</span>; <span class="kp">try</span> <span class="bp">assumption</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S i -&gt;
Str_nth <span class="mi">0</span> (Cons k ks) &lt;
Str_nth (S i) (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (Str_nth (S i) (Cons k ks)) ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat,
   Str_nth k0 (Cons k ks) =
   Str_nth (S i) (Cons k ks))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (S i) (Cons k ks) &lt; k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hk0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~
Str_nth (S i) (Cons k ks) &lt;
Str_nth (S i) (Cons k ks)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth (S i) (Cons k ks) &lt; Str_nth (S i) (Cons k ks)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1c9" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1c9"><span class="highlight"><span class="nb">apply</span> Lt.lt_trans <span class="kr">with</span> k; <span class="kp">try</span> <span class="bp">assumption</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S i -&gt;
Str_nth <span class="mi">0</span> (Cons k ks) &lt;
Str_nth (S i) (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (Str_nth (S i) (Cons k ks)) ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat,
   Str_nth k0 (Cons k ks) =
   Str_nth (S i) (Cons k ks))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (S i) (Cons k ks) &lt; k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hk0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~
Str_nth (S i) (Cons k ks) &lt;
Str_nth (S i) (Cons k ks)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">k &lt; Str_nth (S i) (Cons k ks)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1ca" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1ca"><span class="highlight"><span class="nb">apply</span> Hseq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S i -&gt;
Str_nth <span class="mi">0</span> (Cons k ks) &lt;
Str_nth (S i) (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth (Str_nth (S i) (Cons k ks)) ss) &lt;-&gt;
(<span class="kr">exists</span> <span class="nv">k0</span> : nat,
   Str_nth k0 (Cons k ks) =
   Str_nth (S i) (Cons k ks))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S k)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (Str_nth k ss)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (S i) (Cons k ks) &lt; k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hk0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~
Str_nth (S i) (Cons k ks) &lt;
Str_nth (S i) (Cons k ks)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> &lt; S i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">auto with</span> arith.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">

</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1cb" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1cb"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_filter_prefix</span>
  `{<span class="kr">forall</span> (<span class="nv">a</span> : A), Decision (P a)}
  (ss : Stream A)
  (ks : monotone_nat_stream)
  (Hfs : filtering_subsequence P ss ks)
  (n : nat)
  (kn := Str_nth n (proj1_sig ks))
  (ss_to_kn := stream_prefix ss (S kn))
  : stream_prefix (stream_subsequence ss ks) (S n)
    = filter (<span class="kr">fun</span> <span class="nv">a</span> =&gt; bool_decide (P a)) ss_to_kn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth n (proj1_sig ks)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (stream_subsequence ss ks) (S n) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1cc" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1cc"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss ks</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth n (proj1_sig ks)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (stream_subsequence ss ks) (S n) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1cd" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1cd"><span class="highlight"><span class="nb">generalize dependent</span> ks.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">ks</span> : monotone_nat_stream,
filtering_subsequence P ss ks -&gt;
<span class="kr">let</span> <span class="nv">kn</span> := Str_nth n (proj1_sig ks) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix (stream_subsequence ss ks) (S n) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1ce" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1ce"><span class="highlight"><span class="nb">generalize dependent</span> ss.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">ss</span> : Stream A) (<span class="nv">ks</span> : monotone_nat_stream),
filtering_subsequence P ss ks -&gt;
<span class="kr">let</span> <span class="nv">kn</span> := Str_nth n (proj1_sig ks) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix (stream_subsequence ss ks) (S n) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1cf" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1cf"><span class="highlight"><span class="nb">induction</span> n; <span class="kp">try</span> <span class="nb">apply</span> stream_filter_prefix_0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">ss</span> : Stream A)
  (<span class="nv">ks</span> : monotone_nat_stream),
filtering_subsequence P ss ks -&gt;
<span class="kr">let</span> <span class="nv">kn</span> := Str_nth n (proj1_sig ks) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix (stream_subsequence ss ks) (S n) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> (<span class="nv">ss</span> : Stream A) (<span class="nv">ks</span> : monotone_nat_stream),
filtering_subsequence P ss ks -&gt;
<span class="kr">let</span> <span class="nv">kn</span> := Str_nth (S n) (proj1_sig ks) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix (stream_subsequence ss ks) (S (S n)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1d0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1d0"><span class="highlight"><span class="nb">intros</span> ss kss Hfs; <span class="nb">intros</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">ss</span> : Stream A)
  (<span class="nv">ks</span> : monotone_nat_stream),
filtering_subsequence P ss ks -&gt;
<span class="kr">let</span> <span class="nv">kn</span> := Str_nth n (proj1_sig ks) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix (stream_subsequence ss ks) (S n) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss kss</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n) (proj1_sig kss)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (stream_subsequence ss kss) (S (S n)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1d1" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1d1"><span class="highlight"><span class="nb">specialize</span> (stream_filter_prefix_0 ss kss Hfs); <span class="nb">intro</span> H0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">ss</span> : Stream A)
  (<span class="nv">ks</span> : monotone_nat_stream),
filtering_subsequence P ss ks -&gt;
<span class="kr">let</span> <span class="nv">kn</span> := Str_nth n (proj1_sig ks) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix (stream_subsequence ss ks) (S n) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss kss</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n) (proj1_sig kss)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> := Str_nth <span class="mi">0</span> (proj1_sig kss) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix (stream_subsequence ss kss) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (stream_subsequence ss kss) (S (S n)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1d2" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1d2"><span class="highlight"><span class="nb">remember</span> (Str_nth <span class="mi">0</span> (proj1_sig kss)) <span class="kr">as</span> k0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">ss</span> : Stream A)
  (<span class="nv">ks</span> : monotone_nat_stream),
filtering_subsequence P ss ks -&gt;
<span class="kr">let</span> <span class="nv">kn</span> := Str_nth n (proj1_sig ks) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix (stream_subsequence ss ks) (S n) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss kss</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n) (proj1_sig kss)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqk0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k0 = Str_nth <span class="mi">0</span> (proj1_sig kss)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> := k0 <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix (stream_subsequence ss kss) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (stream_subsequence ss kss) (S (S n)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1d3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1d3"><span class="highlight"><span class="nb">specialize</span> (filtering_subsequence_suffix P ss kss Hfs); <span class="nb">intros</span> Hfs&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">ss</span> : Stream A)
  (<span class="nv">ks</span> : monotone_nat_stream),
filtering_subsequence P ss ks -&gt;
<span class="kr">let</span> <span class="nv">kn</span> := Str_nth n (proj1_sig ks) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix (stream_subsequence ss ks) (S n) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss kss</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n) (proj1_sig kss)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqk0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k0 = Str_nth <span class="mi">0</span> (proj1_sig kss)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> := k0 <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix (stream_subsequence ss kss) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kss&#39;</span> := monotone_nat_stream_suffix kss <span class="kr">in</span>
filtering_subsequence P
  (stream_suffix ss (S (hd (proj1_sig kss))))
  kss&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (stream_subsequence ss kss) (S (S n)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1d4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1d4"><span class="highlight"><span class="nb">remember</span> (monotone_nat_stream_suffix kss) <span class="kr">as</span> kss&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">ss</span> : Stream A)
  (<span class="nv">ks</span> : monotone_nat_stream),
filtering_subsequence P ss ks -&gt;
<span class="kr">let</span> <span class="nv">kn</span> := Str_nth n (proj1_sig ks) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix (stream_subsequence ss ks) (S n) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss kss</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n) (proj1_sig kss)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqk0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k0 = Str_nth <span class="mi">0</span> (proj1_sig kss)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> := k0 <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix (stream_subsequence ss kss) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqkss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">kss&#39; = monotone_nat_stream_suffix kss</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kss&#39;</span> := kss&#39; <span class="kr">in</span>
filtering_subsequence P
  (stream_suffix ss (S (hd (proj1_sig kss))))
  kss&#39;</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (stream_subsequence ss kss) (S (S n)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1d5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1d5"><span class="highlight"><span class="nb">specialize</span> (stream_subsequence_suffix ss kss); <span class="nb">intros</span> Hsss; <span class="nb">simpl</span> <span class="kr">in</span> Hsss.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">ss</span> : Stream A)
  (<span class="nv">ks</span> : monotone_nat_stream),
filtering_subsequence P ss ks -&gt;
<span class="kr">let</span> <span class="nv">kn</span> := Str_nth n (proj1_sig ks) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix (stream_subsequence ss ks) (S n) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss kss</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n) (proj1_sig kss)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqk0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k0 = Str_nth <span class="mi">0</span> (proj1_sig kss)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> := k0 <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix (stream_subsequence ss kss) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqkss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">kss&#39; = monotone_nat_stream_suffix kss</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kss&#39;</span> := kss&#39; <span class="kr">in</span>
filtering_subsequence P
  (stream_suffix ss (S (hd (proj1_sig kss))))
  kss&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt (stream_subsequence ss kss)
  (Cons (Str_nth (hd (proj1_sig kss)) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss) (hd (proj1_sig kss)))
        (monotone_nat_stream_suffix kss)))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (stream_subsequence ss kss) (S (S n)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1d6" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1d6"><span class="highlight"><span class="nb">specialize</span> (stream_prefix_EqSt _ _ Hsss); <span class="nb">intro</span> Hpref.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">ss</span> : Stream A)
  (<span class="nv">ks</span> : monotone_nat_stream),
filtering_subsequence P ss ks -&gt;
<span class="kr">let</span> <span class="nv">kn</span> := Str_nth n (proj1_sig ks) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix (stream_subsequence ss ks) (S n) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss kss</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n) (proj1_sig kss)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqk0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k0 = Str_nth <span class="mi">0</span> (proj1_sig kss)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> := k0 <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix (stream_subsequence ss kss) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqkss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">kss&#39; = monotone_nat_stream_suffix kss</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kss&#39;</span> := kss&#39; <span class="kr">in</span>
filtering_subsequence P
  (stream_suffix ss (S (hd (proj1_sig kss))))
  kss&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt (stream_subsequence ss kss)
  (Cons (Str_nth (hd (proj1_sig kss)) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss) (hd (proj1_sig kss)))
        (monotone_nat_stream_suffix kss)))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
stream_prefix (stream_subsequence ss kss) n =
stream_prefix
  (Cons (Str_nth (hd (proj1_sig kss)) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss) (hd (proj1_sig kss)))
        (monotone_nat_stream_suffix kss))) n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix (stream_subsequence ss kss) (S (S n)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1d7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1d7"><span class="highlight"><span class="nb">destruct</span> kss <span class="kr">as</span> [(k, ks) Hseq].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">ss</span> : Stream A)
  (<span class="nv">ks</span> : monotone_nat_stream),
filtering_subsequence P ss ks -&gt;
<span class="kr">let</span> <span class="nv">kn</span> := Str_nth n (proj1_sig ks) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix (stream_subsequence ss ks) (S n) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqk0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k0 =
Str_nth <span class="mi">0</span>
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> := k0 <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqkss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">kss&#39; =
monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s)
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kss&#39;</span> := kss&#39; <span class="kr">in</span>
filtering_subsequence P
  (stream_suffix ss
     (S
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))))) kss&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) n =
stream_prefix
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop
                      s) 
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) 
  (S (S n)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1d8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1d8"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> Hfs&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">ss</span> : Stream A)
  (<span class="nv">ks</span> : monotone_nat_stream),
filtering_subsequence P ss ks -&gt;
<span class="kr">let</span> <span class="nv">kn</span> := Str_nth n (proj1_sig ks) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix (stream_subsequence ss ks) (S n) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqk0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k0 =
Str_nth <span class="mi">0</span>
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> := k0 <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqkss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">kss&#39; =
monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s)
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k) kss&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) n =
stream_prefix
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop
                      s) 
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) 
  (S (S n)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1d9" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1d9"><span class="highlight"><span class="nb">remember</span> (stream_suffix (tl ss) k) <span class="kr">as</span> ss&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> (<span class="nv">ss</span> : Stream A)
  (<span class="nv">ks</span> : monotone_nat_stream),
filtering_subsequence P ss ks -&gt;
<span class="kr">let</span> <span class="nv">kn</span> := Str_nth n (proj1_sig ks) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix (stream_subsequence ss ks) (S n) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqk0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k0 =
Str_nth <span class="mi">0</span>
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> := k0 <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqkss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">kss&#39; =
monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s)
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ss&#39; = stream_suffix (tl ss) k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss&#39; kss&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) n =
stream_prefix
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop
                      s) 
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) 
  (S (S n)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1da" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1da"><span class="highlight"><span class="nb">specialize</span> (IHn ss&#39; kss&#39; Hfs&#39;).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> := Str_nth n (proj1_sig kss&#39;) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss&#39; (S kn) <span class="kr">in</span>
stream_prefix (stream_subsequence ss&#39; kss&#39;)
  (S n) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqk0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k0 =
Str_nth <span class="mi">0</span>
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> := k0 <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqkss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">kss&#39; =
monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s)
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ss&#39; = stream_suffix (tl ss) k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss&#39; kss&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) n =
stream_prefix
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop
                      s) 
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) 
  (S (S n)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1db" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1db"><span class="highlight"><span class="nb">assert</span>
    (IHn&#39;:
      stream_prefix (stream_subsequence ss&#39; kss&#39;) (S n)
      = filter (<span class="kr">fun</span> <span class="nv">a</span> =&gt; bool_decide (P a)) (stream_prefix ss&#39; (S (Str_nth n (proj1_sig kss&#39;))))
    ) <span class="bp">by</span> <span class="bp">assumption</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> := Str_nth n (proj1_sig kss&#39;) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss&#39; (S kn) <span class="kr">in</span>
stream_prefix (stream_subsequence ss&#39; kss&#39;)
  (S n) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqk0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k0 =
Str_nth <span class="mi">0</span>
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> := k0 <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqkss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">kss&#39; =
monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s)
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ss&#39; = stream_suffix (tl ss) k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss&#39; kss&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) n =
stream_prefix
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop
                      s) 
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix (stream_subsequence ss&#39; kss&#39;)
  (S n) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss&#39;
     (S (Str_nth n (proj1_sig kss&#39;))))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) 
  (S (S n)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1dc" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1dc"><span class="highlight"><span class="nb">clear</span> IHn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss', ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqk0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k0 =
Str_nth <span class="mi">0</span>
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> := k0 <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqkss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">kss&#39; =
monotone_nat_stream_suffix
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s)
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqss'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ss&#39; = stream_suffix (tl ss) k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss&#39; kss&#39;</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) n =
stream_prefix
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop
                      s) 
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix (stream_subsequence ss&#39; kss&#39;)
  (S n) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss&#39;
     (S (Str_nth n (proj1_sig kss&#39;))))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) 
  (S (S n)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1dd" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1dd"><span class="highlight"><span class="nb">subst</span>; <span class="nb">simpl</span> <span class="kr">in</span> Hpref.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">n</span> : nat,
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) n =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence (stream_suffix (tl ss) k)
     (monotone_nat_stream_suffix
        (exist
           (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
            monotone_nat_stream_prop s)
           (Cons k ks) Hseq))) 
  (S n) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (proj1_sig
              (monotone_nat_stream_suffix
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) 
  (S (S n)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1de" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1de"><span class="highlight"><span class="nb">specialize</span> (Hpref (S (S n))).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence (stream_suffix (tl ss) k)
     (monotone_nat_stream_suffix
        (exist
           (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
            monotone_nat_stream_prop s)
           (Cons k ks) Hseq))) 
  (S n) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (proj1_sig
              (monotone_nat_stream_suffix
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) 
  (S (S n)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1df" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1df"><span class="highlight"><span class="nb">inversion</span> Hpref.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence (stream_suffix (tl ss) k)
     (monotone_nat_stream_suffix
        (exist
           (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
            monotone_nat_stream_prop s)
           (Cons k ks) Hseq))) 
  (S n) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (proj1_sig
              (monotone_nat_stream_suffix
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) 
  (S (S n)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1e0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1e0"><span class="highlight"><span class="nb">remember</span> (stream_prefix (stream_suffix (tl ss) k)) <span class="kr">as</span> sp.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqsp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">sp = stream_prefix (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence (stream_suffix (tl ss) k)
     (monotone_nat_stream_suffix
        (exist
           (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
            monotone_nat_stream_prop s)
           (Cons k ks) Hseq))) 
  (S n) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (sp
     (S
        (Str_nth n
           (proj1_sig
              (monotone_nat_stream_suffix
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) 
  (S (S n)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1e1" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1e1"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> IHn&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqsp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">sp = stream_prefix (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks - S k) (stream_suffix (tl ss) k)
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons
           (Str_nth (hd s)
              (stream_suffix (tl ss) k))
           (map (tl s)))
        ((<span class="kr">cofix</span> map (s : Stream nat) :
              Stream nat :=
            Cons (hd s - S k) (map (tl s)))
           (tl ks))) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (sp
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) 
  (S (S n)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1e2" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1e2"><span class="highlight"><span class="nb">rewrite</span> &lt;- H3 <span class="kr">in</span> IHn&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqsp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">sp = stream_prefix (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks - S k) (stream_suffix (tl ss) k)
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (sp
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) 
  (S (S n)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1e3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1e3"><span class="highlight"><span class="nb">rewrite</span> &lt;- H2 <span class="kr">in</span> IHn&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqsp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">sp = stream_prefix (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (sp
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) 
  (S (S n)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1e4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1e4"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqsp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">sp = stream_prefix (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (sp
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k ss
:: Str_nth (hd ks) ss
   :: stream_prefix
        ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
            Cons (Str_nth (hd s) ss) (map (tl s)))
           (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1e5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1e5"><span class="highlight"><span class="nb">rewrite</span> IHn&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqsp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">sp = stream_prefix (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (sp
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k ss
:: filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
     (sp
        (S
           (Str_nth n
              (nat_sequence_suffix (Cons k ks))))) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1e6" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1e6"><span class="highlight"><span class="nb">unfold</span> ss_to_kn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqsp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">sp = stream_prefix (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (sp
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k ss
:: filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
     (sp
        (S
           (Str_nth n
              (nat_sequence_suffix (Cons k ks))))) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss (S kn))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1e7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1e7"><span class="highlight"><span class="nb">unfold</span> nat_sequence_suffix.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqsp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">sp = stream_prefix (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (sp
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k ss
:: filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
     (sp
        (S
           (Str_nth n
              (map
                 (<span class="kr">fun</span> <span class="nv">i</span> : nat =&gt;
                  i - S (hd (Cons k ks)))
                 (tl (Cons k ks)))))) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss (S kn))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1e8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1e8"><span class="highlight"><span class="nb">rewrite</span> Str_nth_map.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqsp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">sp = stream_prefix (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (sp
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k ss
:: filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
     (sp
        (S
           (Str_nth n (tl (Cons k ks)) -
            S (hd (Cons k ks))))) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss (S kn))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1e9" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1e9"><span class="highlight"><span class="nb">remember</span> (S kn) <span class="kr">as</span> skn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">skn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqskn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">skn = S kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss skn</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqsp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">sp = stream_prefix (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (sp
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k ss
:: filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
     (sp
        (S
           (Str_nth n (tl (Cons k ks)) -
            S (hd (Cons k ks))))) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss skn)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1ea" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1ea"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">skn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqskn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">skn = S kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss skn</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqsp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">sp = stream_prefix (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (sp
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k ss
:: filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
     (sp (S (Str_nth n ks - S k))) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss skn)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1eb" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1eb"><span class="highlight"><span class="nb">subst</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k ss
:: filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
     (stream_prefix (stream_suffix (tl ss) k)
        (S (Str_nth n ks - S k))) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss (S kn))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1ec" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1ec"><span class="highlight"><span class="nb">specialize</span> (stream_segment_alt_iff ss (S k) (S (Str_nth n ks)));
  <span class="nb">unfold</span> stream_segment; <span class="nb">unfold</span> stream_segment_alt; <span class="nb">intro</span> Heq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix
  (stream_prefix ss (S (Str_nth n ks))) 
  (S k) =
stream_prefix (stream_suffix ss (S k))
  (S (Str_nth n ks) - S k)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k ss
:: filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
     (stream_prefix (stream_suffix (tl ss) k)
        (S (Str_nth n ks - S k))) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss (S kn))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1ed" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1ed"><span class="highlight"><span class="nb">remember</span> (S (Str_nth n ks)) <span class="kr">as</span> x; <span class="nb">simpl</span> <span class="kr">in</span> Heq; <span class="nb">subst</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix
  (stream_prefix ss (S (Str_nth n ks))) 
  (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks) - S k)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k ss
:: filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
     (stream_prefix (stream_suffix (tl ss) k)
        (S (Str_nth n ks - S k))) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss (S kn))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1ee" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1ee"><span class="highlight"><span class="nb">assert</span>  (Heq&#39; : S (Str_nth n ks) - S k = (S (Str_nth n ks - S k))).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix
  (stream_prefix ss (S (Str_nth n ks))) 
  (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks) - S k)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">S (Str_nth n ks) - S k = S (Str_nth n ks - S k)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk1ef" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix
  (stream_prefix ss (S (Str_nth n ks))) 
  (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks) - S k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S (Str_nth n ks) - S k = S (Str_nth n ks - S k)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chk1ef"><hr></label><div class="goal-conclusion"><span class="highlight">Str_nth k ss
:: filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
     (stream_prefix (stream_suffix (tl ss) k)
        (S (Str_nth n ks - S k))) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss (S kn))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1f0" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1f0"><span class="highlight">{</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix
  (stream_prefix ss (S (Str_nth n ks))) 
  (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks) - S k)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">S (Str_nth n ks) - S k = S (Str_nth n ks - S k)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1f1" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1f1"><span class="highlight"><span class="nb">assert</span> (Hle : <span class="mi">0</span> &lt; S n) <span class="bp">by</span> <span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix
  (stream_prefix ss (S (Str_nth n ks))) 
  (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks) - S k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">S (Str_nth n ks) - S k = S (Str_nth n ks - S k)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1f2" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1f2"><span class="highlight"><span class="nb">clear</span> Hfs kn ss_to_kn H0 Hfs&#39; Hsss Hpref.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix
  (stream_prefix ss (S (Str_nth n ks))) 
  (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks) - S k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">S (Str_nth n ks) - S k = S (Str_nth n ks - S k)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1f3" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1f3"><span class="highlight"><span class="nb">specialize</span> (Hseq <span class="mi">0</span> (S n) Hle).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth <span class="mi">0</span> (Cons k ks) &lt;
Str_nth (S n) (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix
  (stream_prefix ss (S (Str_nth n ks))) 
  (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks) - S k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">S (Str_nth n ks) - S k = S (Str_nth n ks - S k)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1f4" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1f4"><span class="highlight"><span class="nb">unfold</span> Str_nth <span class="kr">in</span> Hseq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">hd (Str_nth_tl <span class="mi">0</span> (Cons k ks)) &lt;
hd (Str_nth_tl (S n) (Cons k ks))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix
  (stream_prefix ss (S (Str_nth n ks))) 
  (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks) - S k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">S (Str_nth n ks) - S k = S (Str_nth n ks - S k)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1f5" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1f5"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> Hseq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; hd (Str_nth_tl n ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix
  (stream_prefix ss (S (Str_nth n ks))) 
  (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks) - S k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">S (Str_nth n ks) - S k = S (Str_nth n ks - S k)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1f6" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1f6"><span class="highlight"><span class="nb">unfold</span> Str_nth.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; hd (Str_nth_tl n ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix
  (stream_prefix ss (S (Str_nth n ks))) 
  (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks) - S k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">S (hd (Str_nth_tl n ks)) - S k =
S (hd (Str_nth_tl n ks) - S k)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1f7" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1f7"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; hd (Str_nth_tl n ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix
  (stream_prefix ss (S (Str_nth n ks))) 
  (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks) - S k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hle</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">hd (Str_nth_tl n ks) - k =
S (hd (Str_nth_tl n ks) - S k)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1f8" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1f8"><span class="highlight">}</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix
  (stream_prefix ss (S (Str_nth n ks))) 
  (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks) - S k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S (Str_nth n ks) - S k = S (Str_nth n ks - S k)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k ss
:: filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
     (stream_prefix (stream_suffix (tl ss) k)
        (S (Str_nth n ks - S k))) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss (S kn))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1f9" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1f9"><span class="highlight"><span class="nb">rewrite</span> Heq&#39; <span class="kr">in</span> Heq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix
  (stream_prefix ss (S (Str_nth n ks))) 
  (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks - S k))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S (Str_nth n ks) - S k = S (Str_nth n ks - S k)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k ss
:: filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
     (stream_prefix (stream_suffix (tl ss) k)
        (S (Str_nth n ks - S k))) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss (S kn))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1fa" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1fa"><span class="highlight"><span class="nb">rewrite</span> &lt;- Heq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix
  (stream_prefix ss (S (Str_nth n ks))) 
  (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks - S k))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S (Str_nth n ks) - S k = S (Str_nth n ks - S k)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k ss
:: filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
     (list_suffix
        (stream_prefix ss (S (Str_nth n ks))) 
        (S k)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss (S kn))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1fb" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1fb"><span class="highlight"><span class="nb">specialize</span> (list_prefix_suffix (stream_prefix ss (S kn)) (S k)); <span class="nb">intro</span> Hps.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix
  (stream_prefix ss (S (Str_nth n ks))) 
  (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks - S k))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S (Str_nth n ks) - S k = S (Str_nth n ks - S k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hps</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_prefix (stream_prefix ss (S kn)) (S k) ++
list_suffix (stream_prefix ss (S kn)) (S k) =
stream_prefix ss (S kn)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k ss
:: filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
     (list_suffix
        (stream_prefix ss (S (Str_nth n ks))) 
        (S k)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss (S kn))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1fc" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1fc"><span class="highlight"><span class="nb">rewrite</span> &lt;- Hps.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix
  (stream_prefix ss (S (Str_nth n ks))) 
  (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks - S k))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S (Str_nth n ks) - S k = S (Str_nth n ks - S k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hps</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_prefix (stream_prefix ss (S kn)) (S k) ++
list_suffix (stream_prefix ss (S kn)) (S k) =
stream_prefix ss (S kn)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k ss
:: filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
     (list_suffix
        (stream_prefix ss (S (Str_nth n ks))) 
        (S k)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (list_prefix (stream_prefix ss (S kn)) (S k) ++
   list_suffix (stream_prefix ss (S kn)) (S k))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1fd" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1fd"><span class="highlight"><span class="nb">rewrite</span> filter_app.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix
  (stream_prefix ss (S (Str_nth n ks))) 
  (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks - S k))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S (Str_nth n ks) - S k = S (Str_nth n ks - S k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hps</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_prefix (stream_prefix ss (S kn)) (S k) ++
list_suffix (stream_prefix ss (S kn)) (S k) =
stream_prefix ss (S kn)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k ss
:: filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
     (list_suffix
        (stream_prefix ss (S (Str_nth n ks))) 
        (S k)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (list_prefix (stream_prefix ss (S kn)) (S k)) ++
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (list_suffix (stream_prefix ss (S kn)) (S k))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk1fe" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk1fe"><span class="highlight"><span class="nb">rewrite</span> stream_prefix_prefix.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix
  (stream_prefix ss (S (Str_nth n ks))) 
  (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks - S k))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S (Str_nth n ks) - S k = S (Str_nth n ks - S k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hps</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_prefix (stream_prefix ss (S kn)) (S k) ++
list_suffix (stream_prefix ss (S kn)) (S k) =
stream_prefix ss (S kn)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k ss
:: filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
     (list_suffix
        (stream_prefix ss (S (Str_nth n ks))) 
        (S k)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss (S k)) ++
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (list_suffix (stream_prefix ss (S kn)) (S k))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="StreamExtras-v-chk1ff" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix
  (stream_prefix ss (S (Str_nth n ks))) 
  (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks - S k))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S (Str_nth n ks) - S k = S (Str_nth n ks - S k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hps</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_prefix (stream_prefix ss (S kn)) (S k) ++
list_suffix (stream_prefix ss (S kn)) (S k) =
stream_prefix ss (S kn)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="StreamExtras-v-chk1ff"><hr></label><div class="goal-conclusion"><span class="highlight">S k &lt;= S kn</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk200" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk200"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix
  (stream_prefix ss (S (Str_nth n ks))) 
  (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks - S k))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S (Str_nth n ks) - S k = S (Str_nth n ks - S k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hps</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_prefix (stream_prefix ss (S kn)) (S k) ++
list_suffix (stream_prefix ss (S kn)) (S k) =
stream_prefix ss (S kn)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k ss
:: filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
     (list_suffix
        (stream_prefix ss (S (Str_nth n ks))) 
        (S k)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss (S k)) ++
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (list_suffix (stream_prefix ss (S kn)) (S k))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk201" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk201"><span class="highlight"><span class="nb">assert</span> (H0&#39; : filter (<span class="kr">fun</span> <span class="nv">a</span> =&gt; bool_decide (P a)) (stream_prefix ss (S k)) = [Str_nth k ss])
    <span class="bp">by</span> (<span class="nb">symmetry</span>; <span class="nb">apply</span> H0).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix
  (stream_prefix ss (S (Str_nth n ks))) 
  (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks - S k))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S (Str_nth n ks) - S k = S (Str_nth n ks - S k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hps</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_prefix (stream_prefix ss (S kn)) (S k) ++
list_suffix (stream_prefix ss (S kn)) (S k) =
stream_prefix ss (S kn)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss (S k)) = [
Str_nth k ss]</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k ss
:: filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
     (list_suffix
        (stream_prefix ss (S (Str_nth n ks))) 
        (S k)) =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss (S k)) ++
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (list_suffix (stream_prefix ss (S kn)) (S k))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk202" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk202"><span class="highlight"><span class="nb">rewrite</span> H0&#39;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix
  (stream_prefix ss (S (Str_nth n ks))) 
  (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks - S k))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S (Str_nth n ks) - S k = S (Str_nth n ks - S k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hps</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_prefix (stream_prefix ss (S kn)) (S k) ++
list_suffix (stream_prefix ss (S kn)) (S k) =
stream_prefix ss (S kn)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix ss (S k)) = [
Str_nth k ss]</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k ss
:: filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
     (list_suffix
        (stream_prefix ss (S (Str_nth n ks))) 
        (S k)) =
[Str_nth k ss] ++
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (list_suffix (stream_prefix ss (S kn)) (S k))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk203" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk203"><span class="highlight"><span class="nb">remember</span> (stream_prefix ss) <span class="kr">as</span> spss.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">spss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqspss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">spss = stream_prefix ss</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">spss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := spss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix (spss (S (Str_nth n ks))) (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks - S k))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S (Str_nth n ks) - S k = S (Str_nth n ks - S k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hps</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_prefix (spss (S kn)) (S k) ++
list_suffix (spss (S kn)) (S k) = 
spss (S kn)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (spss (S k)) = [Str_nth k ss]</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k ss
:: filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
     (list_suffix (spss (S (Str_nth n ks))) (S k)) =
[Str_nth k ss] ++
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (list_suffix (spss (S kn)) (S k))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk204" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk204"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">spss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqspss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">spss = stream_prefix ss</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">spss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := spss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix (spss (S (Str_nth n ks))) (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks - S k))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S (Str_nth n ks) - S k = S (Str_nth n ks - S k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hps</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_prefix (spss (S kn)) (S k) ++
list_suffix (spss (S kn)) (S k) = 
spss (S kn)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (spss (S k)) = [Str_nth k ss]</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth k ss
:: filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
     (list_suffix (spss (S (Str_nth n ks))) (S k)) =
Str_nth k ss
:: filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
     (list_suffix (spss (S kn)) (S k))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">f_equal</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk205" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk205"><span class="highlight">+</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; <span class="kt">Prop</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">a</span> : A, Decision (P a)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P ss
  (exist
     (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
      monotone_nat_stream_prop s) 
     (Cons k ks) Hseq)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ss_to_kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">stream_prefix ss (S kn)</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">let</span> <span class="nv">kn</span> :=
  Str_nth <span class="mi">0</span>
    (proj1_sig
       (exist
          (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
           monotone_nat_stream_prop s)
          (Cons k ks) Hseq)) <span class="kr">in</span>
<span class="kr">let</span> <span class="nv">ss_to_kn</span> := stream_prefix ss (S kn) <span class="kr">in</span>
stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq)) <span class="mi">1</span> =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a)) ss_to_kn</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hfs'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">filtering_subsequence P
  (stream_suffix (tl ss) k)
  (monotone_nat_stream_suffix
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hsss</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">EqSt
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq))
  (Cons
     (Str_nth
        (hd
           (proj1_sig
              (exist
                 (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                  monotone_nat_stream_prop s)
                 (Cons k ks) Hseq))) ss)
     (stream_subsequence
        (stream_suffix 
           (tl ss)
           (hd
              (proj1_sig
                 (exist
                    (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
                     monotone_nat_stream_prop s)
                    (Cons k ks) Hseq))))
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  (stream_subsequence ss
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s)
        (Cons k ks) Hseq)) 
  (S (S n)) =
stream_prefix
  (Cons (Str_nth k ss)
     (stream_subsequence
        (stream_suffix (tl ss) k)
        (monotone_nat_stream_suffix
           (exist
              (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
               monotone_nat_stream_prop s)
              (Cons k ks) Hseq)))) 
  (S (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHn'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss
:: stream_prefix
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
         Cons (Str_nth (hd s) ss) (map (tl s)))
        (tl ks)) n =
filter (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; bool_decide (P a))
  (stream_prefix (stream_suffix (tl ss) k)
     (S
        (Str_nth n
           (nat_sequence_suffix (Cons k ks)))))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth (hd ks) ss =
Str_nth (hd ks - S k) (stream_suffix (tl ss) k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons (Str_nth (hd s) ss) (map (tl s)))
     (tl ks)) n =
stream_prefix
  ((<span class="kr">cofix</span> map (s : Stream nat) : Stream A :=
      Cons
        (Str_nth (hd s) (stream_suffix (tl ss) k))
        (map (tl s)))
     ((<span class="kr">cofix</span> map (s : Stream nat) : Stream nat :=
         Cons (hd s - S k) (map (tl s))) 
        (tl ks))) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_suffix
  (stream_prefix ss (S (Str_nth n ks))) 
  (S k) =
stream_prefix (stream_suffix (tl ss) k)
  (S (Str_nth n ks - S k))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heq'</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S (Str_nth n ks) - S k = S (Str_nth n ks - S k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hps</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list_prefix (stream_prefix ss (S kn)) (S k) ++
list_suffix (stream_prefix ss (S kn)) (S k) =
stream_prefix ss (S kn)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">S k &lt;= S kn</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk206" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk206"><span class="highlight"><span class="nb">clear</span> -Hseq.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">S k &lt;= S kn</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk207" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk207"><span class="highlight"><span class="nb">unfold</span> kn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">S k &lt;=
S
  (Str_nth (S n)
     (proj1_sig
        (exist
           (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
            monotone_nat_stream_prop s) 
           (Cons k ks) Hseq)))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk208" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk208"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kn</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">Str_nth (S n)
  (proj1_sig
     (exist
        (<span class="kr">fun</span> <span class="nv">s</span> : Stream nat =&gt;
         monotone_nat_stream_prop s) 
        (Cons k ks) Hseq))</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">S k &lt;= S (Str_nth (S n) (Cons k ks))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk209" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk209"><span class="highlight"><span class="nb">clear</span> kn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">S k &lt;= S (Str_nth (S n) (Cons k ks))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk20a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk20a"><span class="highlight"><span class="nb">assert</span> (Hlt : <span class="mi">0</span> &lt; S n) <span class="bp">by</span> <span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt; S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">S k &lt;= S (Str_nth (S n) (Cons k ks))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk20b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk20b"><span class="highlight"><span class="nb">apply</span> Hseq <span class="kr">in</span> Hlt.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth <span class="mi">0</span> (Cons k ks) &lt;
Str_nth (S n) (Cons k ks)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">S k &lt;= S (Str_nth (S n) (Cons k ks))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk20c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk20c"><span class="highlight"><span class="nb">unfold</span> Str_nth <span class="kr">in</span> *; <span class="nb">simpl</span> <span class="kr">in</span> *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">ks</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hseq</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">monotone_nat_stream_prop (Cons k ks)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; hd (Str_nth_tl n ks)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">S k &lt;= S (hd (Str_nth_tl n ks))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">lia</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk20d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk20d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_prefix_nth_last</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n</span> : nat)
  (<span class="nv">_last</span> : A)
  : <span class="nb">last</span> (stream_prefix l (S n)) _last = Str_nth n l.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">_last</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">last</span> (stream_prefix l (S n)) _last = Str_nth n l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk20e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk20e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">_last</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">last</span> (stream_prefix l (S n)) _last = Str_nth n l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk20f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk20f"><span class="highlight"><span class="nb">specialize</span> (nth_error_last (stream_prefix l (S n)) n); <span class="nb">intro</span> Hlast.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">_last</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n = length (stream_prefix l (S n)) -&gt;
<span class="kr">forall</span> <span class="nv">_last</span> : A,
nth_error (stream_prefix l (S n)) n =
Some (<span class="nb">last</span> (stream_prefix l (S n)) _last)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">last</span> (stream_prefix l (S n)) _last = Str_nth n l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk210" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk210"><span class="highlight"><span class="nb">specialize</span> (stream_prefix_length l (S n)); <span class="nb">intro</span> Hpref_len.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">_last</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n = length (stream_prefix l (S n)) -&gt;
<span class="kr">forall</span> <span class="nv">_last</span> : A,
nth_error (stream_prefix l (S n)) n =
Some (<span class="nb">last</span> (stream_prefix l (S n)) _last)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref_len</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length (stream_prefix l (S n)) = S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">last</span> (stream_prefix l (S n)) _last = Str_nth n l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk211" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk211"><span class="highlight"><span class="nb">symmetry in</span> Hpref_len.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">_last</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n = length (stream_prefix l (S n)) -&gt;
<span class="kr">forall</span> <span class="nv">_last</span> : A,
nth_error (stream_prefix l (S n)) n =
Some (<span class="nb">last</span> (stream_prefix l (S n)) _last)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref_len</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n = length (stream_prefix l (S n))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">last</span> (stream_prefix l (S n)) _last = Str_nth n l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk212" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk212"><span class="highlight"><span class="nb">specialize</span> (Hlast Hpref_len _last).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">_last</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (stream_prefix l (S n)) n =
Some (<span class="nb">last</span> (stream_prefix l (S n)) _last)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref_len</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n = length (stream_prefix l (S n))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">last</span> (stream_prefix l (S n)) _last = Str_nth n l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk213" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk213"><span class="highlight"><span class="nb">specialize</span> (stream_prefix_nth l (S n) n); <span class="nb">intro</span> Hnth.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">_last</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (stream_prefix l (S n)) n =
Some (<span class="nb">last</span> (stream_prefix l (S n)) _last)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref_len</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n = length (stream_prefix l (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hnth</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; S n -&gt;
nth_error (stream_prefix l (S n)) n =
Some (Str_nth n l)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">last</span> (stream_prefix l (S n)) _last = Str_nth n l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk214" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk214"><span class="highlight"><span class="nb">assert</span> (Hlt : n &lt; S n) <span class="bp">by</span> <span class="nb">constructor</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">_last</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (stream_prefix l (S n)) n =
Some (<span class="nb">last</span> (stream_prefix l (S n)) _last)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref_len</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n = length (stream_prefix l (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hnth</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; S n -&gt;
nth_error (stream_prefix l (S n)) n =
Some (Str_nth n l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">last</span> (stream_prefix l (S n)) _last = Str_nth n l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk215" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk215"><span class="highlight"><span class="nb">specialize</span> (Hnth Hlt).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">_last</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (stream_prefix l (S n)) n =
Some (<span class="nb">last</span> (stream_prefix l (S n)) _last)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref_len</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n = length (stream_prefix l (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hnth</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (stream_prefix l (S n)) n =
Some (Str_nth n l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">last</span> (stream_prefix l (S n)) _last = Str_nth n l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk216" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk216"><span class="highlight"><span class="nb">rewrite</span> Hnth <span class="kr">in</span> Hlast.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">_last</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Some (Str_nth n l) =
Some (<span class="nb">last</span> (stream_prefix l (S n)) _last)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref_len</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n = length (stream_prefix l (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hnth</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (stream_prefix l (S n)) n =
Some (Str_nth n l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">last</span> (stream_prefix l (S n)) _last = Str_nth n l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk217" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk217"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">_last</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Some (Str_nth n l) =
Some (<span class="nb">last</span> (stream_prefix l (S n)) _last)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref_len</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n = length (stream_prefix l (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hnth</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (stream_prefix l (S n)) n =
Some (Str_nth n l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; S n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="nb">last</span>
  <span class="kr">match</span> l <span class="kr">with</span>
  | Cons a l =&gt; a :: stream_prefix l n
  <span class="kr">end</span> _last = Str_nth n l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk218" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk218"><span class="highlight"><span class="nb">inversion</span> Hlast.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">_last</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Some (Str_nth n l) =
Some (<span class="nb">last</span> (stream_prefix l (S n)) _last)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hpref_len</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">S n = length (stream_prefix l (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hnth</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nth_error (stream_prefix l (S n)) n =
Some (Str_nth n l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; S n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Str_nth n l =
<span class="nb">last</span>
  <span class="kr">match</span> l <span class="kr">with</span>
  | Cons a l =&gt; a :: stream_prefix l n
  <span class="kr">end</span> _last</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">Str_nth n l = Str_nth n l</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk219" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk219"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">stream_segment_singleton</span>
  {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">l</span> : Stream A)
  (<span class="nv">n</span> : nat)
  : stream_segment l n (S n) = [Str_nth n l].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_segment l n (S n) = [Str_nth n l]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk21a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk21a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_segment l n (S n) = [Str_nth n l]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk21b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk21b"><span class="highlight"><span class="nb">remember</span> (Str_nth n l) <span class="kr">as</span> a.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a = Str_nth n l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">stream_segment l n (S n) = [a]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk21c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk21c"><span class="highlight"><span class="nb">unfold</span> stream_segment.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a = Str_nth n l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">list_suffix (stream_prefix l (S n)) n = [a]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk21d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk21d"><span class="highlight"><span class="nb">assert</span> (Hlt : n &lt; length (stream_prefix l (S n)))
    <span class="bp">by</span> (<span class="nb">rewrite</span> stream_prefix_length; <span class="nb">constructor</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a = Str_nth n l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; length (stream_prefix l (S n))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">list_suffix (stream_prefix l (S n)) n = [a]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk21e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk21e"><span class="highlight"><span class="nb">specialize</span> (list_suffix_last (stream_prefix l (S n)) n Hlt a); <span class="nb">intro</span> Hlast1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a = Str_nth n l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; length (stream_prefix l (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="nb">last</span> (list_suffix (stream_prefix l (S n)) n)
  a = <span class="nb">last</span> (stream_prefix l (S n)) a</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">list_suffix (stream_prefix l (S n)) n = [a]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk21f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk21f"><span class="highlight"><span class="nb">specialize</span> (stream_prefix_nth_last l n a); <span class="nb">intro</span> Hlast2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a = Str_nth n l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; length (stream_prefix l (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="nb">last</span> (list_suffix (stream_prefix l (S n)) n)
  a = <span class="nb">last</span> (stream_prefix l (S n)) a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="nb">last</span> (stream_prefix l (S n)) a = Str_nth n l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">list_suffix (stream_prefix l (S n)) n = [a]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk220" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk220"><span class="highlight"><span class="nb">rewrite</span> Hlast2 <span class="kr">in</span> Hlast1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a = Str_nth n l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; length (stream_prefix l (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="nb">last</span> (list_suffix (stream_prefix l (S n)) n)
  a = Str_nth n l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="nb">last</span> (stream_prefix l (S n)) a = Str_nth n l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">list_suffix (stream_prefix l (S n)) n = [a]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk221" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk221"><span class="highlight"><span class="nb">specialize</span> (list_suffix_length (stream_prefix l (S n)) n).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a = Str_nth n l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; length (stream_prefix l (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="nb">last</span> (list_suffix (stream_prefix l (S n)) n)
  a = Str_nth n l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="nb">last</span> (stream_prefix l (S n)) a = Str_nth n l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">length (list_suffix (stream_prefix l (S n)) n) =
length (stream_prefix l (S n)) - n -&gt;
list_suffix (stream_prefix l (S n)) n = [a]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk222" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk222"><span class="highlight"><span class="nb">rewrite</span> stream_prefix_length; <span class="kp">try</span> <span class="bp">assumption</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a = Str_nth n l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; length (stream_prefix l (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="nb">last</span> (list_suffix (stream_prefix l (S n)) n)
  a = Str_nth n l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="nb">last</span> (stream_prefix l (S n)) a = Str_nth n l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">length (list_suffix (stream_prefix l (S n)) n) =
S n - n -&gt; list_suffix (stream_prefix l (S n)) n = [a]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk223" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk223"><span class="highlight"><span class="nb">intro</span> Hlength.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a = Str_nth n l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; length (stream_prefix l (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="nb">last</span> (list_suffix (stream_prefix l (S n)) n)
  a = Str_nth n l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="nb">last</span> (stream_prefix l (S n)) a = Str_nth n l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlength</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length
  (list_suffix (stream_prefix l (S n)) n) =
S n - n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">list_suffix (stream_prefix l (S n)) n = [a]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk224" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk224"><span class="highlight"><span class="nb">rewrite</span> &lt;- Minus.minus_Sn_m <span class="kr">in</span> Hlength <span class="bp">by</span> <span class="bp">lia</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a = Str_nth n l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; length (stream_prefix l (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="nb">last</span> (list_suffix (stream_prefix l (S n)) n)
  a = Str_nth n l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="nb">last</span> (stream_prefix l (S n)) a = Str_nth n l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlength</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length
  (list_suffix (stream_prefix l (S n)) n) =
S (n - n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">list_suffix (stream_prefix l (S n)) n = [a]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk225" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk225"><span class="highlight"><span class="nb">rewrite</span> &lt;- Minus.minus_diag_reverse <span class="kr">in</span> Hlength.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a = Str_nth n l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; length (stream_prefix l (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="nb">last</span> (list_suffix (stream_prefix l (S n)) n)
  a = Str_nth n l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="nb">last</span> (stream_prefix l (S n)) a = Str_nth n l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlength</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length
  (list_suffix (stream_prefix l (S n)) n) =
<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">list_suffix (stream_prefix l (S n)) n = [a]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk226" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk226"><span class="highlight"><span class="nb">remember</span> (list_suffix (stream_prefix l (S n)) n) <span class="kr">as</span> x.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a = Str_nth n l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; length (stream_prefix l (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = list_suffix (stream_prefix l (S n)) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="nb">last</span> x a = Str_nth n l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="nb">last</span> (stream_prefix l (S n)) a = Str_nth n l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlength</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length x = <span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x = [a]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk227" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk227"><span class="highlight"><span class="nb">rewrite</span> &lt;- Heqa <span class="kr">in</span> Hlast1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a = Str_nth n l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt; length (stream_prefix l (S n))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Heqx</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">x = list_suffix (stream_prefix l (S n)) n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="nb">last</span> x a = a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="nb">last</span> (stream_prefix l (S n)) a = Str_nth n l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlength</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length x = <span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x = [a]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk228" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk228"><span class="highlight"><span class="nb">clear</span> -Hlength Hlast1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="nb">last</span> x a = a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlength</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length x = <span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">x = [a]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk229" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk229"><span class="highlight"><span class="nb">destruct</span> x; <span class="nb">inversion</span> Hlength.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">list A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="nb">last</span> (a0 :: x) a = a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlength</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length (a0 :: x) = <span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length x = <span class="mi">0</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a0 :: x = [a]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk22a" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk22a"><span class="highlight"><span class="nb">destruct</span> x; <span class="nb">inversion</span> H0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, a0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlast1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="nb">last</span> [a0] a = a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">Hlength</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length [a0] = <span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H0</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">length [] = <span class="mi">0</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[a0] = [a]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">simpl</span> <span class="kr">in</span> Hlast1; <span class="nb">subst</span>; <span class="bp">reflexivity</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk22b" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk22b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">str_map_tl</span>
  {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>}
  (<span class="nv">f</span> : A -&gt; B)
  (<span class="nv">s</span> : Stream A)
  : EqSt (tl (map f s)) (map f (tl s)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt (tl (map f s)) (map f (tl s))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk22c" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk22c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt (tl (map f s)) (map f (tl s))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk22d" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk22d"><span class="highlight"><span class="nb">generalize dependent</span> s.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
EqSt (tl (map f s)) (map f (tl s))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk22e" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk22e"><span class="highlight"><span class="kr">cofix</span> IH.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
EqSt (tl (map f s)) (map f (tl s))</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
EqSt (tl (map f s)) (map f (tl s))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk22f" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk22f"><span class="highlight"><span class="nb">intros</span> (a, s).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
EqSt (tl (map f s)) (map f (tl s))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt (tl (map f (Cons a s))) (map f (tl (Cons a s)))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk230" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk230"><span class="highlight"><span class="nb">constructor</span>; <span class="kp">try</span> <span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
EqSt (tl (map f s)) (map f (tl s))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt (tl (tl (map f (Cons a s))))
  (tl (map f (tl (Cons a s))))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk231" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk231"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : Stream A,
EqSt (tl (map f s)) (map f (tl s))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt
  ((<span class="kr">cofix</span> map (s : Stream A) : Stream B :=
      Cons (f (hd s)) (map (tl s))) (tl s))
  ((<span class="kr">cofix</span> map (s : Stream A) : Stream B :=
      Cons (f (hd s)) (map (tl s))) (tl s))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> IH.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk232" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk232"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">str_map_cons</span>
  {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>}
  (<span class="nv">f</span> : A -&gt; B)
  (<span class="nv">s</span> : Stream A)
  : EqSt (map f s) (Cons (f (hd s)) (map f (tl s))).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt (map f s) (Cons (f (hd s)) (map f (tl s)))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk233" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk233"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt (map f s) (Cons (f (hd s)) (map f (tl s)))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk234" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk234"><span class="highlight"><span class="nb">destruct</span> s <span class="kr">as</span>  (a,s).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt (map f (Cons a s))
  (Cons (f (hd (Cons a s))) (map f (tl (Cons a s))))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk235" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk235"><span class="highlight"><span class="nb">constructor</span>; <span class="kp">try</span> <span class="bp">reflexivity</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt (tl (map f (Cons a s)))
  (tl
     (Cons (f (hd (Cons a s))) (map f (tl (Cons a s)))))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="StreamExtras-v-chk236" style="display: none" type="checkbox"><label class="alectryon-input" for="StreamExtras-v-chk236"><span class="highlight"><span class="nb">simpl</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A -&gt; B</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">Stream A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">EqSt
  ((<span class="kr">cofix</span> map (s : Stream A) : Stream B :=
      Cons (f (hd s)) (map (tl s))) s) (map f s)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="nb">apply</span> EqSt_reflex.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span></span></pre></article></body></html>