<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="./../../..">Project Website</a>
      <a href="./indexpage.html">Index</a>
      <a href="./toc.html">Table of Contents</a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Bool.Bool.html#"><span class="id" title="library">Bool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#"><span class="id" title="library">List</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#"><span class="id" title="library">ListSet</span></a>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">ListNotations</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">CasperCBC</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CasperCBC.Lib.Preamble.html#"><span class="id" title="library">Lib.Preamble</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CasperCBC.Lib.ListExtras.html#"><span class="id" title="library">Lib.ListExtras</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CasperCBC.Lib.ListSetExtras.html#"><span class="id" title="library">Lib.ListSetExtras</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CasperCBC.VLSM.Common.html#"><span class="id" title="library">VLSM.Common</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CasperCBC.CBC.Common.html#"><span class="id" title="library">CBC.Common</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CasperCBC.CBC.Equivocation.html#"><span class="id" title="library">CBC.Equivocation</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#"><span class="id" title="library">Validator.State</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CasperCBC.CBC.FullNode.Validator.Equivocation.html#"><span class="id" title="library">Validator.Equivocation</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CasperCBC.VLSM.Equivocation.html#"><span class="id" title="library">VLSM.Equivocation</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CasperCBC.VLSM.ObservableEquivocation.html#"><span class="id" title="library">VLSM.ObservableEquivocation</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CasperCBC.VLSM.FullNode.Client.html#"><span class="id" title="library">VLSM.FullNode.Client</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="CompositeValidator" class="idref" href="#CompositeValidator"><span class="id" title="section">CompositeValidator</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<a id="C:1" class="idref" href="#C:1"><span class="id" title="binder">C</span></a> <a id="V:2" class="idref" href="#V:2"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<a id="about_C:3" class="idref" href="#about_C:3"><span class="id" title="binder">about_C</span></a> : <a class="idref" href="CasperCBC.Lib.Preamble.html#StrictlyComparable"><span class="id" title="class">StrictlyComparable</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#C:1"><span class="id" title="variable">C</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<a id="about_V:4" class="idref" href="#about_V:4"><span class="id" title="binder">about_V</span></a> : <a class="idref" href="CasperCBC.Lib.Preamble.html#StrictlyComparable"><span class="id" title="class">StrictlyComparable</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#V:2"><span class="id" title="variable">V</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<a id="Hmeasurable:5" class="idref" href="#Hmeasurable:5"><span class="id" title="binder">Hmeasurable</span></a> : <a class="idref" href="CasperCBC.CBC.Common.html#Measurable"><span class="id" title="class">Measurable</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#V:2"><span class="id" title="variable">V</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<a id="Hrt:6" class="idref" href="#Hrt:6"><span class="id" title="binder">Hrt</span></a> : <a class="idref" href="CasperCBC.CBC.Common.html#ReachableThreshold"><span class="id" title="class">ReachableThreshold</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#V:2"><span class="id" title="variable">V</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<a id="Hestimator:7" class="idref" href="#Hestimator:7"><span class="id" title="binder">Hestimator</span></a> : <a class="idref" href="CasperCBC.CBC.Common.html#Estimator"><span class="id" title="class">Estimator</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#C:1"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#V:2"><span class="id" title="variable">V</span></a>) <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#C:1"><span class="id" title="variable">C</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="eq_V:8" class="idref" href="#eq_V:8"><span class="id" title="binder">eq_V</span></a> := @<a class="idref" href="CasperCBC.Lib.Preamble.html#strictly_comparable_eq_dec"><span class="id" title="instance">strictly_comparable_eq_dec</span></a> <span class="id" title="var">_</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#about_V:4"><span class="id" title="variable">about_V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="message:9" class="idref" href="#message:9"><span class="id" title="binder">message</span></a> := <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#message"><span class="id" title="inductive">State.message</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#C:1"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#V:2"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="message_preceeds_dec:10" class="idref" href="#message_preceeds_dec:10"><span class="id" title="binder">message_preceeds_dec</span></a> := <a class="idref" href="CasperCBC.CBC.FullNode.Validator.Equivocation.html#validator_message_preceeds_dec"><span class="id" title="definition">validator_message_preceeds_dec</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#C:1"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#V:2"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;.<br/>
&nbsp;&nbsp;<span class="id" title="var">Existing</span> <span class="id" title="keyword">Instance</span> <span class="id" title="var">eq_V</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Existing</span> <span class="id" title="keyword">Instance</span> <span class="id" title="var">message_preceeds_dec</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="full_node_validator_observable_events" class="idref" href="#full_node_validator_observable_events"><span class="id" title="definition">full_node_validator_observable_events</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s:11" class="idref" href="#s:11"><span class="id" title="binder">s</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="v:12" class="idref" href="#v:12"><span class="id" title="binder">v</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set"><span class="id" title="definition">set</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CasperCBC.VLSM.FullNode.Client.html#full_node_client_observable_events"><span class="id" title="definition">full_node_client_observable_events</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_message_set"><span class="id" title="definition">get_message_set</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:11"><span class="id" title="variable">s</span></a>) <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#v:12"><span class="id" title="variable">v</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Program Definition</span> <a id="full_node_validator_observation_based_equivocation_evidence" class="idref" href="#full_node_validator_observation_based_equivocation_evidence"><span class="id" title="definition">full_node_validator_observation_based_equivocation_evidence</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="CasperCBC.VLSM.ObservableEquivocation.html#observation_based_equivocation_evidence"><span class="id" title="class">observation_based_equivocation_evidence</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>) <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a> <a class="idref" href="CasperCBC.Lib.Classes.html#decide_eq"><span class="id" title="abbreviation">decide_eq</span></a> <span class="id" title="var">_</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message_preceeds_dec"><span class="id" title="variable">message_preceeds_dec</span></a> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sender"><span class="id" title="definition">sender</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CasperCBC.VLSM.ObservableEquivocation.html#observable_events"><span class="id" title="method">observable_events</span></a> := <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#full_node_validator_observable_events"><span class="id" title="definition">full_node_validator_observable_events</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#full_node_validator_observable_events"><span class="id" title="definition">full_node_validator_observable_events</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">He</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Client.html#full_node_client_observable_events"><span class="id" title="definition">full_node_client_observable_events</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">He</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#filter_In"><span class="id" title="lemma">filter_In</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">He</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">He</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> <span class="id" title="var">He</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="CasperCBC.Lib.Classes.html#decide"><span class="id" title="definition">decide</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sender"><span class="id" title="definition">sender</span></a> <span class="id" title="var">e</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">v</span>)); <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">intuition</span>; <span class="id" title="tactic">discriminate</span> <span class="id" title="var">He</span>].<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="var">Existing</span> <span class="id" title="keyword">Instance</span> <span class="id" title="var">full_node_validator_observation_based_equivocation_evidence</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="full_node_validator_state_validators" class="idref" href="#full_node_validator_state_validators"><span class="id" title="definition">full_node_validator_state_validators</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s:13" class="idref" href="#s:13"><span class="id" title="binder">s</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set"><span class="id" title="definition">set</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CasperCBC.VLSM.FullNode.Client.html#full_node_client_state_validators"><span class="id" title="definition">full_node_client_state_validators</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_message_set"><span class="id" title="definition">get_message_set</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:13"><span class="id" title="variable">s</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="full_node_validator_state_validators_nodup" class="idref" href="#full_node_validator_state_validators_nodup"><span class="id" title="lemma">full_node_validator_state_validators_nodup</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s:14" class="idref" href="#s:14"><span class="id" title="binder">s</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#NoDup"><span class="id" title="inductive">NoDup</span></a> (<a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#full_node_validator_state_validators"><span class="id" title="definition">full_node_validator_state_validators</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:14"><span class="id" title="variable">s</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.Lib.ListSetExtras.html#set_map_nodup"><span class="id" title="lemma">set_map_nodup</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="validator_basic_equivocation" class="idref" href="#validator_basic_equivocation"><span class="id" title="definition">validator_basic_equivocation</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="CasperCBC.CBC.Equivocation.html#basic_equivocation"><span class="id" title="class">basic_equivocation</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>) <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="CasperCBC.VLSM.ObservableEquivocation.html#basic_observable_equivocation"><span class="id" title="definition">basic_observable_equivocation</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>) <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#full_node_validator_state_validators"><span class="id" title="definition">full_node_validator_state_validators</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#full_node_validator_state_validators_nodup"><span class="id" title="lemma">full_node_validator_state_validators_nodup</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab69"></a><h1 class="section">Full-node validator VLSM instance</h1>


<div class="paragraph"> </div>

  Here we define a VLSM for a full-node validator identifying itself as
  <tt>v</tt> when sending messages.

<div class="paragraph"> </div>

  The validator and incorporates messages (sent by other validators), and
  creates and sends new messages proposing consensus values estimated based
  on its current state, signing them with its name and current state.

<div class="paragraph"> </div>

  Unlike the client, no equivocation check is done within the validator upon
  receiving a new message.
  
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="labelv" class="idref" href="#labelv"><span class="id" title="definition">labelv</span></a> : <span class="id" title="keyword">Type</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="vtransitionv" class="idref" href="#vtransitionv"><span class="id" title="definition">vtransitionv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="v:15" class="idref" href="#v:15"><span class="id" title="binder">v</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="l:16" class="idref" href="#l:16"><span class="id" title="binder">l</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#labelv"><span class="id" title="definition">labelv</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="som:17" class="idref" href="#som:17"><span class="id" title="binder">som</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<a id="s:18" class="idref" href="#s:18"><span class="id" title="binder">s</span></a>, <a id="om:19" class="idref" href="#om:19"><span class="id" title="binder">om</span></a>) := <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#som:17"><span class="id" title="variable">som</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<a id="msgs:20" class="idref" href="#msgs:20"><span class="id" title="binder">msgs</span></a>, <a id="final:21" class="idref" href="#final:21"><span class="id" title="binder">final</span></a>) := <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:18"><span class="id" title="variable">s</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#l:16"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#om:19"><span class="id" title="variable">om</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#som:17"><span class="id" title="variable">som</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#pair"><span class="id" title="constructor">pair</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#pair"><span class="id" title="constructor">pair</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add"><span class="id" title="definition">set_add</span></a> <a class="idref" href="CasperCBC.Lib.Classes.html#decide_eq"><span class="id" title="abbreviation">decide_eq</span></a> <span class="id" title="var">msg</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#msgs:20"><span class="id" title="variable">msgs</span></a>) <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#final:21"><span class="id" title="variable">final</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">c</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="msg:24" class="idref" href="#msg:24"><span class="id" title="binder">msg</span></a> := <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#Msg"><span class="id" title="constructor">Msg</span></a> <span class="id" title="var">c</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#v:15"><span class="id" title="variable">v</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#make_justification"><span class="id" title="definition">make_justification</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:18"><span class="id" title="variable">s</span></a>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#pair"><span class="id" title="constructor">pair</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#pair"><span class="id" title="constructor">pair</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add"><span class="id" title="definition">set_add</span></a> <a class="idref" href="CasperCBC.Lib.Classes.html#decide_eq"><span class="id" title="abbreviation">decide_eq</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#msg:24"><span class="id" title="variable">msg</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#msgs:20"><span class="id" title="variable">msgs</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#msg:24"><span class="id" title="variable">msg</span></a>)) (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#msg:24"><span class="id" title="variable">msg</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="vtransitionv_inv_out" class="idref" href="#vtransitionv_inv_out"><span class="id" title="lemma">vtransitionv_inv_out</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="v:25" class="idref" href="#v:25"><span class="id" title="binder">v</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="l:26" class="idref" href="#l:26"><span class="id" title="binder">l</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#labelv"><span class="id" title="definition">labelv</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s:27" class="idref" href="#s:27"><span class="id" title="binder">s</span></a> <a id="s':28" class="idref" href="#s':28"><span class="id" title="binder">s'</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="om:29" class="idref" href="#om:29"><span class="id" title="binder">om</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="m':30" class="idref" href="#m':30"><span class="id" title="binder">m'</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Ht:31" class="idref" href="#Ht:31"><span class="id" title="binder">Ht</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#vtransitionv"><span class="id" title="definition">vtransitionv</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#v:25"><span class="id" title="variable">v</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#l:26"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:27"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#om:29"><span class="id" title="variable">om</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#pair"><span class="id" title="constructor">pair</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s':28"><span class="id" title="variable">s'</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m':30"><span class="id" title="variable">m'</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s':28"><span class="id" title="variable">s'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#pair"><span class="id" title="constructor">pair</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add"><span class="id" title="definition">set_add</span></a> <a class="idref" href="CasperCBC.Lib.Classes.html#decide_eq"><span class="id" title="abbreviation">decide_eq</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m':30"><span class="id" title="variable">m'</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_message_set"><span class="id" title="definition">get_message_set</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:27"><span class="id" title="variable">s</span></a>)) (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m':30"><span class="id" title="variable">m'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_justification"><span class="id" title="definition">get_justification</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m':30"><span class="id" title="variable">m'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#make_justification"><span class="id" title="definition">make_justification</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:27"><span class="id" title="variable">s</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sender"><span class="id" title="definition">sender</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m':30"><span class="id" title="variable">m'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#v:25"><span class="id" title="variable">v</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">(</span></a><a id="c:32" class="idref" href="#c:32"><span class="id" title="binder">c</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">),</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#l:26"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#c:32"><span class="id" title="variable">c</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#vtransitionv"><span class="id" title="definition">vtransitionv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">msgs</span>, <span class="id" title="var">final</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">c</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">c</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">om</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">msg</span>|]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="valid_validator" class="idref" href="#valid_validator"><span class="id" title="definition">valid_validator</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="l:33" class="idref" href="#l:33"><span class="id" title="binder">l</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#labelv"><span class="id" title="definition">labelv</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="som:34" class="idref" href="#som:34"><span class="id" title="binder">som</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="keyword">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<a id="s:35" class="idref" href="#s:35"><span class="id" title="binder">s</span></a>, <a id="om:36" class="idref" href="#om:36"><span class="id" title="binder">om</span></a>) := <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#som:34"><span class="id" title="variable">som</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#l:33"><span class="id" title="variable">l</span></a>, <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#om:36"><span class="id" title="variable">om</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">msg</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <span class="id" title="var">msg</span> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_message_set"><span class="id" title="definition">get_message_set</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:35"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#incl"><span class="id" title="definition">incl</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_message_set"><span class="id" title="definition">get_message_set</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#unmake_justification"><span class="id" title="definition">unmake_justification</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_justification"><span class="id" title="definition">get_justification</span></a> <span class="id" title="var">msg</span>))) (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_message_set"><span class="id" title="definition">get_message_set</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:35"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">c</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<a class="idref" href="CasperCBC.CBC.Common.html#estimator"><span class="id" title="method">estimator</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>) <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.Hestimator"><span class="id" title="variable">Hestimator</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:35"><span class="id" title="variable">s</span></a> <span class="id" title="var">c</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>,<span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a id="VLSM_type_full_validator" class="idref" href="#VLSM_type_full_validator"><span class="id" title="instance">VLSM_type_full_validator</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#VLSM_type"><span class="id" title="class">VLSM_type</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <a class="idref" href="CasperCBC.VLSM.Common.html#state"><span class="id" title="method">state</span></a> := <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a class="idref" href="CasperCBC.VLSM.Common.html#label"><span class="id" title="method">label</span></a> := <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#labelv"><span class="id" title="definition">labelv</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="initial_state_prop" class="idref" href="#initial_state_prop"><span class="id" title="definition">initial_state_prop</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s:39" class="idref" href="#s:39"><span class="id" title="binder">s</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="keyword">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:39"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#pair"><span class="id" title="constructor">pair</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="state0" class="idref" href="#state0"><span class="id" title="definition">state0</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Specif.html#bc4528e836ab0e91ea7e942fb09e898f"><span class="id" title="notation">{</span></a><a id="s:40" class="idref" href="#s:40"><span class="id" title="binder">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Specif.html#bc4528e836ab0e91ea7e942fb09e898f"><span class="id" title="notation">|</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#initial_state_prop"><span class="id" title="definition">initial_state_prop</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:40"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Specif.html#bc4528e836ab0e91ea7e942fb09e898f"><span class="id" title="notation">}</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Specif.html#exist"><span class="id" title="constructor">exist</span></a> <span class="id" title="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#pair"><span class="id" title="constructor">pair</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="initial_message_prop" class="idref" href="#initial_message_prop"><span class="id" title="definition">initial_message_prop</span></a> (<a id="m:41" class="idref" href="#m:41"><span class="id" title="binder">m</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>) : <span class="id" title="keyword">Prop</span> := <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a id="LSM_full_validator" class="idref" href="#LSM_full_validator"><span class="id" title="instance">LSM_full_validator</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#VLSM_sign"><span class="id" title="class">VLSM_sign</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#VLSM_type_full_validator"><span class="id" title="instance">VLSM_type_full_validator</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <a class="idref" href="CasperCBC.VLSM.Common.html#initial_state_prop"><span class="id" title="method">initial_state_prop</span></a> := <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#initial_state_prop"><span class="id" title="definition">initial_state_prop</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a class="idref" href="CasperCBC.VLSM.Common.html#initial_message_prop"><span class="id" title="method">initial_message_prop</span></a> := <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#initial_message_prop"><span class="id" title="definition">initial_message_prop</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a class="idref" href="CasperCBC.VLSM.Common.html#s0"><span class="id" title="method">s0</span></a> := <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#state0"><span class="id" title="definition">state0</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a class="idref" href="CasperCBC.VLSM.Common.html#m0"><span class="id" title="method">m0</span></a> := <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#message0"><span class="id" title="definition">State.message0</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <a class="idref" href="CasperCBC.VLSM.Common.html#l0"><span class="id" title="method">l0</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="VLSM_full_validator_machine" class="idref" href="#VLSM_full_validator_machine"><span class="id" title="definition">VLSM_full_validator_machine</span></a> (<a id="v:42" class="idref" href="#v:42"><span class="id" title="binder">v</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>) : <a class="idref" href="CasperCBC.VLSM.Common.html#VLSM_class"><span class="id" title="class">VLSM_class</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#LSM_full_validator"><span class="id" title="instance">LSM_full_validator</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{| <a class="idref" href="CasperCBC.VLSM.Common.html#transition"><span class="id" title="method">transition</span></a> := <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#vtransitionv"><span class="id" title="definition">vtransitionv</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#v:42"><span class="id" title="variable">v</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <a class="idref" href="CasperCBC.VLSM.Common.html#valid"><span class="id" title="method">valid</span></a> := <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#valid_validator"><span class="id" title="definition">valid_validator</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="VLSM_full_validator" class="idref" href="#VLSM_full_validator"><span class="id" title="definition">VLSM_full_validator</span></a> (<a id="v:43" class="idref" href="#v:43"><span class="id" title="binder">v</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>) : <a class="idref" href="CasperCBC.VLSM.Common.html#VLSM"><span class="id" title="definition">VLSM</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CasperCBC.VLSM.Common.html#mk_vlsm"><span class="id" title="definition">mk_vlsm</span></a> (<a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#VLSM_full_validator_machine"><span class="id" title="definition">VLSM_full_validator_machine</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#v:43"><span class="id" title="variable">v</span></a>).<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="CompositeValidator.proper_sent_received" class="idref" href="#CompositeValidator.proper_sent_received"><span class="id" title="section">proper_sent_received</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="v:44" class="idref" href="#v:44"><span class="id" title="binder">v</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="vlsm:45" class="idref" href="#vlsm:45"><span class="id" title="binder">vlsm</span></a> := <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#VLSM_full_validator"><span class="id" title="definition">VLSM_full_validator</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#v:44"><span class="id" title="variable">v</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="bvlsm:46" class="idref" href="#bvlsm:46"><span class="id" title="binder">bvlsm</span></a> := <a class="idref" href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm"><span class="id" title="definition">pre_loaded_with_all_messages_vlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#vlsm:45"><span class="id" title="variable">vlsm</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="validator_protocol_state_nodup" class="idref" href="#validator_protocol_state_nodup"><span class="id" title="lemma">validator_protocol_state_nodup</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s:47" class="idref" href="#s:47"><span class="id" title="binder">s</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hs:48" class="idref" href="#Hs:48"><span class="id" title="binder">Hs</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#protocol_state_prop"><span class="id" title="definition">protocol_state_prop</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:47"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#NoDup"><span class="id" title="inductive">NoDup</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_message_set"><span class="id" title="definition">get_message_set</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:47"><span class="id" title="variable">s</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Hs</span> <span class="id" title="keyword">using</span> <a class="idref" href="CasperCBC.VLSM.Common.html#protocol_state_prop_ind"><span class="id" title="lemma">protocol_state_prop_ind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">Ht</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> <span class="id" title="var">Ht</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.VLSM.Common.html#vtransition"><span class="id" title="definition">vtransition</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">msgs</span>, <span class="id" title="var">final</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">c</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#pair_equal_spec"><span class="id" title="lemma">pair_equal_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Ht</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hs'</span> <span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">s'</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add_nodup"><span class="id" title="lemma">set_add_nodup</span></a>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">om</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">msg</span>|]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add_nodup"><span class="id" title="lemma">set_add_nodup</span></a>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="vtransition_inv_out" class="idref" href="#vtransition_inv_out"><span class="id" title="lemma">vtransition_inv_out</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="l:49" class="idref" href="#l:49"><span class="id" title="binder">l</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#label"><span class="id" title="method">label</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s:50" class="idref" href="#s:50"><span class="id" title="binder">s</span></a> <a id="s':51" class="idref" href="#s':51"><span class="id" title="binder">s'</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="om:52" class="idref" href="#om:52"><span class="id" title="binder">om</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="m':53" class="idref" href="#m':53"><span class="id" title="binder">m'</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Ht:54" class="idref" href="#Ht:54"><span class="id" title="binder">Ht</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#vtransition"><span class="id" title="definition">vtransition</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#l:49"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:50"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#om:52"><span class="id" title="variable">om</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#pair"><span class="id" title="constructor">pair</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s':51"><span class="id" title="variable">s'</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m':53"><span class="id" title="variable">m'</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s':51"><span class="id" title="variable">s'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#pair"><span class="id" title="constructor">pair</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add"><span class="id" title="definition">set_add</span></a> <a class="idref" href="CasperCBC.Lib.Classes.html#decide_eq"><span class="id" title="abbreviation">decide_eq</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m':53"><span class="id" title="variable">m'</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_message_set"><span class="id" title="definition">get_message_set</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:50"><span class="id" title="variable">s</span></a>)) (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m':53"><span class="id" title="variable">m'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_justification"><span class="id" title="definition">get_justification</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m':53"><span class="id" title="variable">m'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#make_justification"><span class="id" title="definition">make_justification</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:50"><span class="id" title="variable">s</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sender"><span class="id" title="definition">sender</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m':53"><span class="id" title="variable">m'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.v"><span class="id" title="variable">v</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">(</span></a><a id="c:55" class="idref" href="#c:55"><span class="id" title="binder">c</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">),</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#l:49"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#c:55"><span class="id" title="variable">c</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#vtransitionv_inv_out"><span class="id" title="lemma">vtransitionv_inv_out</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="protocol_transition_inv_out" class="idref" href="#protocol_transition_inv_out"><span class="id" title="lemma">protocol_transition_inv_out</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="l:56" class="idref" href="#l:56"><span class="id" title="binder">l</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#label"><span class="id" title="method">label</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s:57" class="idref" href="#s:57"><span class="id" title="binder">s</span></a> <a id="s':58" class="idref" href="#s':58"><span class="id" title="binder">s'</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="om:59" class="idref" href="#om:59"><span class="id" title="binder">om</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="m':60" class="idref" href="#m':60"><span class="id" title="binder">m'</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Ht:61" class="idref" href="#Ht:61"><span class="id" title="binder">Ht</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#protocol_transition"><span class="id" title="definition">protocol_transition</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#l:56"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:57"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#om:59"><span class="id" title="variable">om</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s':58"><span class="id" title="variable">s'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m':60"><span class="id" title="variable">m'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s':58"><span class="id" title="variable">s'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#pair"><span class="id" title="constructor">pair</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add"><span class="id" title="definition">set_add</span></a> <a class="idref" href="CasperCBC.Lib.Classes.html#decide_eq"><span class="id" title="abbreviation">decide_eq</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m':60"><span class="id" title="variable">m'</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_message_set"><span class="id" title="definition">get_message_set</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:57"><span class="id" title="variable">s</span></a>)) (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m':60"><span class="id" title="variable">m'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_justification"><span class="id" title="definition">get_justification</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m':60"><span class="id" title="variable">m'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#make_justification"><span class="id" title="definition">make_justification</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:57"><span class="id" title="variable">s</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sender"><span class="id" title="definition">sender</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m':60"><span class="id" title="variable">m'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.v"><span class="id" title="variable">v</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">(</span></a><a id="c:62" class="idref" href="#c:62"><span class="id" title="binder">c</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">),</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#l:56"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#c:62"><span class="id" title="variable">c</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Ht</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> <span class="id" title="var">Ht</span>]. <span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#vtransition_inv_out"><span class="id" title="lemma">vtransition_inv_out</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="protocol_transition_inv_in" class="idref" href="#protocol_transition_inv_in"><span class="id" title="lemma">protocol_transition_inv_in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="l:63" class="idref" href="#l:63"><span class="id" title="binder">l</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#label"><span class="id" title="method">label</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s:64" class="idref" href="#s:64"><span class="id" title="binder">s</span></a> <a id="s':65" class="idref" href="#s':65"><span class="id" title="binder">s'</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="m:66" class="idref" href="#m:66"><span class="id" title="binder">m</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="om':67" class="idref" href="#om':67"><span class="id" title="binder">om'</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Ht:68" class="idref" href="#Ht:68"><span class="id" title="binder">Ht</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#protocol_transition"><span class="id" title="definition">protocol_transition</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#l:63"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:64"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:66"><span class="id" title="variable">m</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s':65"><span class="id" title="variable">s'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#om':67"><span class="id" title="variable">om'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s':65"><span class="id" title="variable">s'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#pair"><span class="id" title="constructor">pair</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add"><span class="id" title="definition">set_add</span></a> <a class="idref" href="CasperCBC.Lib.Classes.html#decide_eq"><span class="id" title="abbreviation">decide_eq</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:66"><span class="id" title="variable">m</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_message_set"><span class="id" title="definition">get_message_set</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:64"><span class="id" title="variable">s</span></a>)) (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#last_sent"><span class="id" title="definition">last_sent</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:64"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#om':67"><span class="id" title="variable">om'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:66"><span class="id" title="variable">m</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_message_set"><span class="id" title="definition">get_message_set</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:64"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#incl"><span class="id" title="definition">incl</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#unmake_message_set"><span class="id" title="definition">unmake_message_set</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#justification_message_set"><span class="id" title="definition">justification_message_set</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_justification"><span class="id" title="definition">get_justification</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:66"><span class="id" title="variable">m</span></a>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_message_set"><span class="id" title="definition">get_message_set</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:64"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#protocol_state_prop"><span class="id" title="definition">protocol_state_prop</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:64"><span class="id" title="variable">s</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#protocol_message_prop"><span class="id" title="definition">protocol_message_prop</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:66"><span class="id" title="variable">m</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#protocol_state_prop"><span class="id" title="definition">protocol_state_prop</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s':65"><span class="id" title="variable">s'</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">Ht</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Hs'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.VLSM.Common.html#protocol_transition_destination"><span class="id" title="lemma">protocol_transition_destination</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Ht</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">Hs</span> [<span class="id" title="var">Hm</span> <span class="id" title="var">Hv</span>]] <span class="id" title="var">Ht</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.VLSM.Common.html#vtransition"><span class="id" title="definition">vtransition</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hv</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.VLSM.Common.html#vvalid"><span class="id" title="definition">vvalid</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hv</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">c</span>|]; <span class="id" title="tactic">try</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">msgs</span>, <span class="id" title="var">final</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="last_sent_in_messages" class="idref" href="#last_sent_in_messages"><span class="id" title="lemma">last_sent_in_messages</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s:69" class="idref" href="#s:69"><span class="id" title="binder">s</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hs:70" class="idref" href="#Hs:70"><span class="id" title="binder">Hs</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#protocol_state_prop"><span class="id" title="definition">protocol_state_prop</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:69"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="lst:71" class="idref" href="#lst:71"><span class="id" title="binder">lst</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hlst:72" class="idref" href="#Hlst:72"><span class="id" title="binder">Hlst</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#last_sent"><span class="id" title="definition">last_sent</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:69"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#lst:71"><span class="id" title="variable">lst</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#lst:71"><span class="id" title="variable">lst</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_message_set"><span class="id" title="definition">get_message_set</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:69"><span class="id" title="variable">s</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Hs</span> <span class="id" title="keyword">using</span> <a class="idref" href="CasperCBC.VLSM.Common.html#protocol_state_prop_ind"><span class="id" title="lemma">protocol_state_prop_ind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">s</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hlst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">Ht</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> <span class="id" title="var">Ht</span>]. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.VLSM.Common.html#vtransition"><span class="id" title="definition">vtransition</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">msgs</span>, <span class="id" title="var">final</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">c</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">Ht</span>; <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">final</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">m</span>|]; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hlst</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add_iff"><span class="id" title="lemma">set_add_iff</span></a>; <span class="id" title="tactic">left</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">om</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">msg</span>|]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Ht</span>; <span class="id" title="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlst</span>; <span class="id" title="tactic">subst</span> <span class="id" title="var">final</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHHs</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a>); <span class="id" title="tactic">simpl</span>; [|<span class="id" title="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add_iff"><span class="id" title="lemma">set_add_iff</span></a>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="last_sent_justification_protocol" class="idref" href="#last_sent_justification_protocol"><span class="id" title="lemma">last_sent_justification_protocol</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s:73" class="idref" href="#s:73"><span class="id" title="binder">s</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hs:74" class="idref" href="#Hs:74"><span class="id" title="binder">Hs</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#protocol_state_prop"><span class="id" title="definition">protocol_state_prop</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:73"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="lst:75" class="idref" href="#lst:75"><span class="id" title="binder">lst</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hlst:76" class="idref" href="#Hlst:76"><span class="id" title="binder">Hlst</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#last_sent"><span class="id" title="definition">last_sent</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:73"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#lst:75"><span class="id" title="variable">lst</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="j:77" class="idref" href="#j:77"><span class="id" title="binder">j</span></a> := <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_justification"><span class="id" title="definition">get_justification</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#lst:75"><span class="id" title="variable">lst</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="sj:78" class="idref" href="#sj:78"><span class="id" title="binder">sj</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#protocol_state_prop"><span class="id" title="definition">protocol_state_prop</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#sj:78"><span class="id" title="variable">sj</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#make_justification"><span class="id" title="definition">make_justification</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#sj:78"><span class="id" title="variable">sj</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#j:77"><span class="id" title="variable">j</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Hs</span> <span class="id" title="keyword">using</span> <a class="idref" href="CasperCBC.VLSM.Common.html#protocol_state_prop_ind"><span class="id" title="lemma">protocol_state_prop_ind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">s</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hlst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">Ht</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">Hps</span> [<span class="id" title="var">Hom</span> <span class="id" title="var">Hv</span>]] <span class="id" title="var">Ht</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.VLSM.Common.html#vtransition"><span class="id" title="definition">vtransition</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">msgs</span>, <span class="id" title="var">final</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">c</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">Ht</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">msgs</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">final</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">final</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">m</span>|]; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hlst</span>; <span class="id" title="tactic">simpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">om</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">msg</span>|]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Ht</span>; <span class="id" title="tactic">subst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlst</span>; <span class="id" title="tactic">subst</span> <span class="id" title="var">final</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHHs</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a>); <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="in_protocol_state" class="idref" href="#in_protocol_state"><span class="id" title="lemma">in_protocol_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s:79" class="idref" href="#s:79"><span class="id" title="binder">s</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hs:80" class="idref" href="#Hs:80"><span class="id" title="binder">Hs</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#protocol_state_prop"><span class="id" title="definition">protocol_state_prop</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:79"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="m:81" class="idref" href="#m:81"><span class="id" title="binder">m</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hm:82" class="idref" href="#Hm:82"><span class="id" title="binder">Hm</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:81"><span class="id" title="variable">m</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_message_set"><span class="id" title="definition">get_message_set</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:79"><span class="id" title="variable">s</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#incl"><span class="id" title="definition">incl</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#unmake_message_set"><span class="id" title="definition">unmake_message_set</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#justification_message_set"><span class="id" title="definition">justification_message_set</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_justification"><span class="id" title="definition">get_justification</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:81"><span class="id" title="variable">m</span></a>))) (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_message_set"><span class="id" title="definition">get_message_set</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:79"><span class="id" title="variable">s</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Hs</span> <span class="id" title="keyword">using</span> <a class="idref" href="CasperCBC.VLSM.Common.html#protocol_state_prop_ind"><span class="id" title="lemma">protocol_state_prop_ind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">s</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">Ht</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">Hps</span> [<span class="id" title="var">Hom</span> <span class="id" title="var">Hv</span>]] <span class="id" title="var">Ht</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.VLSM.Common.html#vtransition"><span class="id" title="definition">vtransition</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hv</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.VLSM.Common.html#vvalid"><span class="id" title="definition">vvalid</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hv</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">s</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">msgs</span>, <span class="id" title="var">final</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">c</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">Ht</span>; <span class="id" title="tactic">subst</span> <span class="id" title="var">s'</span> <span class="id" title="var">om'</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Ht</span>;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> * |- *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add_iff"><span class="id" title="lemma">set_add_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">msg</span> <span class="id" title="var">Hmsg</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add_iff"><span class="id" title="lemma">set_add_iff</span></a>; <span class="id" title="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hm</span>;[|<span class="id" title="tactic">apply</span> <span class="id" title="var">IHHs</span>;<span class="id" title="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">m</span>; <span class="id" title="tactic">clear</span> -<span class="id" title="var">Hmsg</span>;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hmsg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#make_unmake_message_set_eq"><span class="id" title="lemma">make_unmake_message_set_eq</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">final</span>;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">om</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">msg</span>|]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Ht</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">Ht</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHHs</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hv</span>; <span class="id" title="tactic">simpl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [|<span class="id" title="tactic">apply</span> <span class="id" title="var">IHHs</span>; <span class="id" title="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hv</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hnmsg</span> <span class="id" title="var">Hv</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add_iff"><span class="id" title="lemma">set_add_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hm</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Heqm</span> | <span class="id" title="var">Hm</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">subst</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#incl_tran"><span class="id" title="lemma">incl_tran</span></a> <span class="id" title="keyword">with</span> <span class="id" title="var">msgs</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">Hx</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add_iff"><span class="id" title="lemma">set_add_iff</span></a>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHHs</span> <span class="id" title="var">Hm</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#incl_tran"><span class="id" title="lemma">incl_tran</span></a> <span class="id" title="keyword">with</span> <span class="id" title="var">msgs</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">Hx</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add_iff"><span class="id" title="lemma">set_add_iff</span></a>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="has_been_sent_in_futures" class="idref" href="#has_been_sent_in_futures"><span class="id" title="lemma">has_been_sent_in_futures</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s1:83" class="idref" href="#s1:83"><span class="id" title="binder">s1</span></a> <a id="s2:84" class="idref" href="#s2:84"><span class="id" title="binder">s2</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hs:85" class="idref" href="#Hs:85"><span class="id" title="binder">Hs</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#in_futures"><span class="id" title="definition">in_futures</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s1:83"><span class="id" title="variable">s1</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s2:84"><span class="id" title="variable">s2</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#incl"><span class="id" title="definition">incl</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s1:83"><span class="id" title="variable">s1</span></a>) (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s2:84"><span class="id" title="variable">s2</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.VLSM.Common.html#in_futures"><span class="id" title="definition">in_futures</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hs</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">tr</span> [<span class="id" title="var">Htr</span> <span class="id" title="var">Hs2</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">s2</span>. <span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">s1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">tr</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs2</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">s2</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#incl_refl"><span class="id" title="lemma">incl_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">Htr</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">a</span> <span class="id" title="var">s'</span> <span class="id" title="var">tl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map_cons"><span class="id" title="lemma">map_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs2</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="CasperCBC.Lib.ListExtras.html#unroll_last"><span class="id" title="lemma">unroll_last</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs2</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHtr</span> <span class="id" title="var">s</span> <span class="id" title="var">H2</span> <span class="id" title="var">s2</span> <span class="id" title="var">Hs2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#incl_tran"><span class="id" title="lemma">incl_tran</span></a> <span class="id" title="keyword">with</span> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a> <span class="id" title="var">s</span>); <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> -<span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> <span class="id" title="var">Ht</span>]. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.VLSM.Common.html#vtransition"><span class="id" title="definition">vtransition</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">s1</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">msgs</span>, <span class="id" title="var">final</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">c</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">Ht</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">final</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">m</span>|]; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#incl_nil_l"><span class="id" title="lemma">incl_nil_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">c0</span>, <span class="id" title="var">v0</span>, <span class="id" title="var">j0</span>). <span class="id" title="tactic">intros</span> <span class="id" title="var">m</span> <span class="id" title="var">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add_iff"><span class="id" title="lemma">set_add_iff</span></a>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">iom</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">msg</span>|]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Ht</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#incl_refl"><span class="id" title="lemma">incl_refl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="get_messages_in_futures" class="idref" href="#get_messages_in_futures"><span class="id" title="lemma">get_messages_in_futures</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s1:86" class="idref" href="#s1:86"><span class="id" title="binder">s1</span></a> <a id="s2:87" class="idref" href="#s2:87"><span class="id" title="binder">s2</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hs:88" class="idref" href="#Hs:88"><span class="id" title="binder">Hs</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#in_futures"><span class="id" title="definition">in_futures</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s1:86"><span class="id" title="variable">s1</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s2:87"><span class="id" title="variable">s2</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#incl"><span class="id" title="definition">incl</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_message_set"><span class="id" title="definition">get_message_set</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s1:86"><span class="id" title="variable">s1</span></a>) (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_message_set"><span class="id" title="definition">get_message_set</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s2:87"><span class="id" title="variable">s2</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.VLSM.Common.html#in_futures"><span class="id" title="definition">in_futures</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hs</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">tr</span> [<span class="id" title="var">Htr</span> <span class="id" title="var">Hs2</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">s2</span>. <span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">s1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">tr</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs2</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">s2</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#incl_refl"><span class="id" title="lemma">incl_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">Htr</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">a</span> <span class="id" title="var">s'</span> <span class="id" title="var">tl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map_cons"><span class="id" title="lemma">map_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs2</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="CasperCBC.Lib.ListExtras.html#unroll_last"><span class="id" title="lemma">unroll_last</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs2</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHtr</span> <span class="id" title="var">s</span> <span class="id" title="var">H2</span> <span class="id" title="var">s2</span> <span class="id" title="var">Hs2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#incl_tran"><span class="id" title="lemma">incl_tran</span></a> <span class="id" title="keyword">with</span> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_message_set"><span class="id" title="definition">get_message_set</span></a> <span class="id" title="var">s</span>); <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> -<span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> <span class="id" title="var">Ht</span>]. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.VLSM.Common.html#vtransition"><span class="id" title="definition">vtransition</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">s1</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">msgs</span>, <span class="id" title="var">final</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">c</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">Ht</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_message_set"><span class="id" title="definition">get_message_set</span></a>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">m</span> <span class="id" title="var">Hm</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add_iff"><span class="id" title="lemma">set_add_iff</span></a>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">iom</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">msg</span>|]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Ht</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#incl_refl"><span class="id" title="lemma">incl_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">m</span> <span class="id" title="var">Hm</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add_iff"><span class="id" title="lemma">set_add_iff</span></a>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="has_been_sent_protocol_transition" class="idref" href="#has_been_sent_protocol_transition"><span class="id" title="lemma">has_been_sent_protocol_transition</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="l:89" class="idref" href="#l:89"><span class="id" title="binder">l</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#vlabel"><span class="id" title="definition">vlabel</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s1:90" class="idref" href="#s1:90"><span class="id" title="binder">s1</span></a> <a id="s2:91" class="idref" href="#s2:91"><span class="id" title="binder">s2</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="iom:92" class="idref" href="#iom:92"><span class="id" title="binder">iom</span></a> <a id="oom:93" class="idref" href="#oom:93"><span class="id" title="binder">oom</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hpt:94" class="idref" href="#Hpt:94"><span class="id" title="binder">Hpt</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#protocol_transition"><span class="id" title="definition">protocol_transition</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#l:89"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s1:90"><span class="id" title="variable">s1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#iom:92"><span class="id" title="variable">iom</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s2:91"><span class="id" title="variable">s2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#oom:93"><span class="id" title="variable">oom</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="m:95" class="idref" href="#m:95"><span class="id" title="binder">m</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hs1:96" class="idref" href="#Hs1:96"><span class="id" title="binder">Hs1</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:95"><span class="id" title="variable">m</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s1:90"><span class="id" title="variable">s1</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:95"><span class="id" title="variable">m</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s2:91"><span class="id" title="variable">s2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#oom:93"><span class="id" title="variable">oom</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:95"><span class="id" title="variable">m</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hpt</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> <span class="id" title="var">Ht</span>]. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.VLSM.Common.html#vtransition"><span class="id" title="definition">vtransition</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">s1</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">msgs</span>, <span class="id" title="var">final</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">c</span>|]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Ht</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add_iff"><span class="id" title="lemma">set_add_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Heq</span> | <span class="id" title="var">H</span>]; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">elim</span> <span class="id" title="var">Hs1</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">final</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add_iff"><span class="id" title="lemma">set_add_iff</span></a>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">iom</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">msg</span>|]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">try</span> <span class="id" title="tactic">discriminate</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">elim</span> <span class="id" title="var">Hs1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="has_been_sent_in_trace" class="idref" href="#has_been_sent_in_trace"><span class="id" title="lemma">has_been_sent_in_trace</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s:97" class="idref" href="#s:97"><span class="id" title="binder">s</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="m:98" class="idref" href="#m:98"><span class="id" title="binder">m</span></a>: <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="is:99" class="idref" href="#is:99"><span class="id" title="binder">is</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="tr:100" class="idref" href="#tr:100"><span class="id" title="binder">tr</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#transition_item"><span class="id" title="record">transition_item</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Htr:101" class="idref" href="#Htr:101"><span class="id" title="binder">Htr</span></a>: <a class="idref" href="CasperCBC.VLSM.Common.html#finite_protocol_trace"><span class="id" title="definition">finite_protocol_trace</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#is:99"><span class="id" title="variable">is</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#tr:100"><span class="id" title="variable">tr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="item:102" class="idref" href="#item:102"><span class="id" title="binder">item</span></a>: <a class="idref" href="CasperCBC.VLSM.Common.html#transition_item"><span class="id" title="record">transition_item</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hitem:103" class="idref" href="#Hitem:103"><span class="id" title="binder">Hitem</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#item:102"><span class="id" title="variable">item</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#tr:100"><span class="id" title="variable">tr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hm:104" class="idref" href="#Hm:104"><span class="id" title="binder">Hm</span></a>: <a class="idref" href="CasperCBC.VLSM.Common.html#output"><span class="id" title="projection">output</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#item:102"><span class="id" title="variable">item</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:98"><span class="id" title="variable">m</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hs:105" class="idref" href="#Hs:105"><span class="id" title="binder">Hs</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#last"><span class="id" title="definition">last</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#destination"><span class="id" title="projection">destination</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#tr:100"><span class="id" title="variable">tr</span></a>) <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#is:99"><span class="id" title="variable">is</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:97"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:98"><span class="id" title="variable">m</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:97"><span class="id" title="variable">s</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#in_split"><span class="id" title="lemma">in_split</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hitem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hitem</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">l1</span> [<span class="id" title="var">l2</span> <span class="id" title="var">Hitem</span>]]. <span class="id" title="tactic">subst</span> <span class="id" title="var">tr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Htr</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Htr</span> <span class="id" title="var">Hinit</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<a class="idref" href="CasperCBC.VLSM.Common.html#finite_protocol_trace_from_app_iff"><span class="id" title="lemma">finite_protocol_trace_from_app_iff</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <span class="id" title="keyword">is</span> <span class="id" title="var">l1</span> (<span class="id" title="var">item</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">l2</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">Htr_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Htr_app</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Htr_app</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> <span class="id" title="var">Htr_app</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Htr_app</span> <span class="id" title="var">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">Htr</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Htr_app</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> <span class="id" title="var">Htr</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Htr</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">tl</span> <span class="id" title="var">item</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">oom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hm0</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <span class="id" title="var">m</span> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a> <span class="id" title="var">s0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">clear</span> -<span class="id" title="var">H3</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> <span class="id" title="var">Ht</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.VLSM.Common.html#vtransition"><span class="id" title="definition">vtransition</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#last"><span class="id" title="definition">last</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (@<a class="idref" href="CasperCBC.VLSM.Common.html#transition_item"><span class="id" title="record">transition_item</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#VLSM_type_full_validator"><span class="id" title="instance">VLSM_type_full_validator</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>) (@<a class="idref" href="CasperCBC.VLSM.Common.html#destination"><span class="id" title="projection">destination</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#VLSM_type_full_validator"><span class="id" title="instance">VLSM_type_full_validator</span></a>) <span class="id" title="var">l1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">is</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> (<span class="id" title="var">msgs</span>, <span class="id" title="var">final</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">c</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">Ht</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add_iff"><span class="id" title="lemma">set_add_iff</span></a>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">iom</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">msg</span>|]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs0</span> : <a class="idref" href="CasperCBC.VLSM.Common.html#in_futures"><span class="id" title="definition">in_futures</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <span class="id" title="var">s0</span> <span class="id" title="var">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exists</span> <span class="id" title="var">l2</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map_app"><span class="id" title="lemma">map_app</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map_cons"><span class="id" title="lemma">map_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="CasperCBC.Lib.ListExtras.html#last_app"><span class="id" title="lemma">last_app</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="CasperCBC.Lib.ListExtras.html#unroll_last"><span class="id" title="lemma">unroll_last</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#has_been_sent_in_futures"><span class="id" title="lemma">has_been_sent_in_futures</span></a> <span class="id" title="keyword">with</span> <span class="id" title="var">s0</span>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="has_been_sent_witness" class="idref" href="#has_been_sent_witness"><span class="id" title="lemma">has_been_sent_witness</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s:106" class="idref" href="#s:106"><span class="id" title="binder">s</span></a>: <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="m:107" class="idref" href="#m:107"><span class="id" title="binder">m</span></a>: <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Horacle:108" class="idref" href="#Horacle:108"><span class="id" title="binder">Horacle</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:107"><span class="id" title="variable">m</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:106"><span class="id" title="variable">s</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="start:109" class="idref" href="#start:109"><span class="id" title="binder">start</span></a>: <a class="idref" href="CasperCBC.VLSM.Common.html#state"><span class="id" title="method">Common.state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hstart:110" class="idref" href="#Hstart:110"><span class="id" title="binder">Hstart</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:107"><span class="id" title="variable">m</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#start:109"><span class="id" title="variable">start</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="prefix:111" class="idref" href="#prefix:111"><span class="id" title="binder">prefix</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#transition_item"><span class="id" title="record">transition_item</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hprefix:112" class="idref" href="#Hprefix:112"><span class="id" title="binder">Hprefix</span></a>: <a class="idref" href="CasperCBC.VLSM.Common.html#finite_protocol_trace_from"><span class="id" title="inductive">finite_protocol_trace_from</span></a> (<a class="idref" href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm"><span class="id" title="definition">pre_loaded_with_all_messages_vlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.vlsm"><span class="id" title="variable">vlsm</span></a>) <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#start:109"><span class="id" title="variable">start</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#prefix:111"><span class="id" title="variable">prefix</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hlast:113" class="idref" href="#Hlast:113"><span class="id" title="binder">Hlast</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#last"><span class="id" title="definition">last</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#destination"><span class="id" title="projection">destination</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#prefix:111"><span class="id" title="variable">prefix</span></a>) <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#start:109"><span class="id" title="variable">start</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:106"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="item:114" class="idref" href="#item:114"><span class="id" title="binder">item</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#transition_item"><span class="id" title="record">transition_item</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#item:114"><span class="id" title="variable">item</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#prefix:111"><span class="id" title="variable">prefix</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#output"><span class="id" title="projection">output</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#item:114"><span class="id" title="variable">item</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:107"><span class="id" title="variable">m</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">start</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">prefix</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hprefix</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Horacle</span>. <span class="id" title="tactic">elim</span> <span class="id" title="var">Hstart</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map_cons"><span class="id" title="lemma">map_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlast</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="CasperCBC.Lib.ListExtras.html#unroll_last"><span class="id" title="lemma">unroll_last</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlast</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hprefix</span>; <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">oom</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">om</span>|]; <span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> (<a class="idref" href="CasperCBC.Lib.Classes.html#decide"><span class="id" title="definition">decide</span></a> (<span class="id" title="var">om</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">m</span>)); <span class="id" title="tactic">try</span> <span class="id" title="tactic">subst</span> <span class="id" title="var">om</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exists</span> (@<a class="idref" href="CasperCBC.VLSM.Common.html#Build_transition_item"><span class="id" title="constructor">Build_transition_item</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#VLSM_type_full_validator"><span class="id" title="instance">VLSM_type_full_validator</span></a> <span class="id" title="var">l</span> <span class="id" title="var">iom</span> <span class="id" title="var">s0</span> (@<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a> <span class="id" title="var">m</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs0</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <span class="id" title="var">m</span> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a> <span class="id" title="var">s0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">Hbs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#has_been_sent_protocol_transition"><span class="id" title="lemma">has_been_sent_protocol_transition</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H3</span> <span class="id" title="var">_</span> <span class="id" title="var">Hstart</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hbs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">elim</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hbs</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHprefix</span> <span class="id" title="var">s0</span> <span class="id" title="var">Hs0</span> <span class="id" title="var">H2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHprefix</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">x</span> [<span class="id" title="var">Hx</span> <span class="id" title="var">Hm</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs0</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <span class="id" title="var">m</span> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a> <span class="id" title="var">s0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">Hbs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#has_been_sent_protocol_transition"><span class="id" title="lemma">has_been_sent_protocol_transition</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H3</span> <span class="id" title="var">_</span> <span class="id" title="var">Hstart</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hbs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">discriminate</span> <span class="id" title="var">Hbs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHprefix</span> <span class="id" title="var">s0</span> <span class="id" title="var">Hs0</span> <span class="id" title="var">H2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHprefix</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">x</span> [<span class="id" title="var">Hx</span> <span class="id" title="var">Hm</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="has_been_sent_in_trace_rev" class="idref" href="#has_been_sent_in_trace_rev"><span class="id" title="lemma">has_been_sent_in_trace_rev</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s:115" class="idref" href="#s:115"><span class="id" title="binder">s</span></a>: <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="m:116" class="idref" href="#m:116"><span class="id" title="binder">m</span></a>: <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Horacle:117" class="idref" href="#Horacle:117"><span class="id" title="binder">Horacle</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:116"><span class="id" title="variable">m</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:115"><span class="id" title="variable">s</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="is:118" class="idref" href="#is:118"><span class="id" title="binder">is</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="tr:119" class="idref" href="#tr:119"><span class="id" title="binder">tr</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#transition_item"><span class="id" title="record">transition_item</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Htr:120" class="idref" href="#Htr:120"><span class="id" title="binder">Htr</span></a>: <a class="idref" href="CasperCBC.VLSM.Common.html#finite_protocol_trace"><span class="id" title="definition">finite_protocol_trace</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#is:118"><span class="id" title="variable">is</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#tr:119"><span class="id" title="variable">tr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hlast:121" class="idref" href="#Hlast:121"><span class="id" title="binder">Hlast</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#last"><span class="id" title="definition">last</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#destination"><span class="id" title="projection">destination</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#tr:119"><span class="id" title="variable">tr</span></a>) <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#is:118"><span class="id" title="variable">is</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:115"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="item:122" class="idref" href="#item:122"><span class="id" title="binder">item</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#transition_item"><span class="id" title="record">transition_item</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#item:122"><span class="id" title="variable">item</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#tr:119"><span class="id" title="variable">tr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#output"><span class="id" title="projection">output</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#item:122"><span class="id" title="variable">item</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:116"><span class="id" title="variable">m</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Htr</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Htr</span> <span class="id" title="var">Hinit</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#has_been_sent_witness"><span class="id" title="lemma">has_been_sent_witness</span></a> <span class="id" title="keyword">with</span> <span class="id" title="var">s</span> <span class="id" title="keyword">is</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hinit</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="var">contradiction</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="has_been_received_in_futures" class="idref" href="#has_been_received_in_futures"><span class="id" title="lemma">has_been_received_in_futures</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s1:123" class="idref" href="#s1:123"><span class="id" title="binder">s1</span></a> <a id="s2:124" class="idref" href="#s2:124"><span class="id" title="binder">s2</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hs:125" class="idref" href="#Hs:125"><span class="id" title="binder">Hs</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#in_futures"><span class="id" title="definition">in_futures</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s1:123"><span class="id" title="variable">s1</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s2:124"><span class="id" title="variable">s2</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#incl"><span class="id" title="definition">incl</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#received_messages"><span class="id" title="definition">State.received_messages</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s1:123"><span class="id" title="variable">s1</span></a>) (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#received_messages"><span class="id" title="definition">State.received_messages</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s2:124"><span class="id" title="variable">s2</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#received_messages"><span class="id" title="definition">State.received_messages</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">m</span> <span class="id" title="var">Hm</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_diff_iff"><span class="id" title="lemma">set_diff_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_diff_iff"><span class="id" title="lemma">set_diff_iff</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hm</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hm</span> <span class="id" title="var">Hnm</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#get_messages_in_futures"><span class="id" title="lemma">get_messages_in_futures</span></a> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> <span class="id" title="var">Hs</span> <span class="id" title="var">_</span> <span class="id" title="var">Hm</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hm1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">Hsm</span>; <span class="id" title="tactic">elim</span> <span class="id" title="var">Hnm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hs</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">tr</span> [<span class="id" title="var">Htr</span> <span class="id" title="var">Hs2</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#has_been_sent_witness"><span class="id" title="lemma">has_been_sent_witness</span></a> <span class="id" title="var">s2</span> <span class="id" title="var">m</span> <span class="id" title="var">Hsm</span> <span class="id" title="var">s1</span> <span class="id" title="var">Hnm</span> <span class="id" title="var">tr</span> <span class="id" title="var">Htr</span> <span class="id" title="var">Hs2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [<span class="id" title="var">item</span> [<span class="id" title="var">Hitem</span> <span class="id" title="var">Hm'</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#in_split"><span class="id" title="lemma">in_split</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hitem</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hitem</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">l1</span> [<span class="id" title="var">l2</span> <span class="id" title="var">Hitem</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">tr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<a class="idref" href="CasperCBC.VLSM.Common.html#finite_protocol_trace_from_app_iff"><span class="id" title="lemma">finite_protocol_trace_from_app_iff</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <span class="id" title="var">s1</span> <span class="id" title="var">l1</span> (<span class="id" title="var">item</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">l2</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">Happ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Happ</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#proj2"><span class="id" title="lemma">proj2</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Happ</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">Happ</span> <span class="id" title="var">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Happ</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hl1</span> <span class="id" title="var">Hl2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#last"><span class="id" title="definition">last</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (@<a class="idref" href="CasperCBC.VLSM.Common.html#transition_item"><span class="id" title="record">transition_item</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#VLSM_type_full_validator"><span class="id" title="instance">VLSM_type_full_validator</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>) (@<a class="idref" href="CasperCBC.VLSM.Common.html#destination"><span class="id" title="projection">destination</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#VLSM_type_full_validator"><span class="id" title="instance">VLSM_type_full_validator</span></a>) <span class="id" title="var">l1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">s1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">s1'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs1'</span> : <a class="idref" href="CasperCBC.VLSM.Common.html#in_futures"><span class="id" title="definition">in_futures</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <span class="id" title="var">s1</span> <span class="id" title="var">s1'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">exists</span> <span class="id" title="var">l1</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>; <span class="id" title="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hm1'</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <span class="id" title="var">m</span> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_message_set"><span class="id" title="definition">get_message_set</span></a> <span class="id" title="var">s1'</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">apply</span> (<a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#get_messages_in_futures"><span class="id" title="lemma">get_messages_in_futures</span></a> <span class="id" title="var">s1</span> <span class="id" title="var">s1'</span> <span class="id" title="var">Hs1'</span>); <span class="id" title="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hl2</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">s'</span> <span class="id" title="var">tl</span> <span class="id" title="var">item</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm'</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">oom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> - <span class="id" title="var">Hm1'</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> <span class="id" title="var">Ht</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.VLSM.Common.html#vtransition"><span class="id" title="definition">vtransition</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">s1'</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">msgs</span>, <span class="id" title="var">final</span>). <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">c</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">Ht</span>; <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">final</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">m</span>|]; <span class="id" title="tactic">clear</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">elim</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#in_justification_recursive'"><span class="id" title="lemma">in_justification_recursive'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#Msg"><span class="id" title="constructor">Msg</span></a> <span class="id" title="var">c</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.v"><span class="id" title="variable">v</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#LastSent"><span class="id" title="constructor">LastSent</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#make_message_set"><span class="id" title="definition">make_message_set</span></a> <span class="id" title="var">msgs</span>) <span class="id" title="var">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">msgs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">elim</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#in_justification_recursive'"><span class="id" title="lemma">in_justification_recursive'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#Msg"><span class="id" title="constructor">Msg</span></a> <span class="id" title="var">c</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.v"><span class="id" title="variable">v</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#NoSent"><span class="id" title="constructor">NoSent</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#make_message_set"><span class="id" title="definition">make_message_set</span></a> <span class="id" title="var">msgs</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">msgs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">iom</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">msg</span>|]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="last_state_empty_segment" class="idref" href="#last_state_empty_segment"><span class="id" title="lemma">last_state_empty_segment</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="start:126" class="idref" href="#start:126"><span class="id" title="binder">start</span></a>: <a class="idref" href="CasperCBC.VLSM.Common.html#state"><span class="id" title="method">Common.state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="prefix:127" class="idref" href="#prefix:127"><span class="id" title="binder">prefix</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#transition_item"><span class="id" title="record">transition_item</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hprefix:128" class="idref" href="#Hprefix:128"><span class="id" title="binder">Hprefix</span></a>: <a class="idref" href="CasperCBC.VLSM.Common.html#finite_protocol_trace_from"><span class="id" title="inductive">finite_protocol_trace_from</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#start:126"><span class="id" title="variable">start</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#prefix:127"><span class="id" title="variable">prefix</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hlast:129" class="idref" href="#Hlast:129"><span class="id" title="binder">Hlast</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#last"><span class="id" title="definition">last</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#destination"><span class="id" title="projection">destination</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#prefix:127"><span class="id" title="variable">prefix</span></a>) <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#start:126"><span class="id" title="variable">start</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#pair"><span class="id" title="constructor">pair</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="item:130" class="idref" href="#item:130"><span class="id" title="binder">item</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#transition_item"><span class="id" title="record">transition_item</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hitem:131" class="idref" href="#Hitem:131"><span class="id" title="binder">Hitem</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#item:130"><span class="id" title="variable">item</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#prefix:127"><span class="id" title="variable">prefix</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="CasperCBC.VLSM.Common.html#input"><span class="id" title="projection">input</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#item:130"><span class="id" title="variable">item</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#output"><span class="id" title="projection">output</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#item:130"><span class="id" title="variable">item</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#destination"><span class="id" title="projection">destination</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#item:130"><span class="id" title="variable">item</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#pair"><span class="id" title="constructor">pair</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#l"><span class="id" title="projection">l</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#item:130"><span class="id" title="variable">item</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">prefix</span> <span class="id" title="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#rev_ind"><span class="id" title="lemma">rev_ind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hitem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#in_app_iff"><span class="id" title="lemma">in_app_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hitem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map_app"><span class="id" title="lemma">map_app</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlast</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlast</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#last_last"><span class="id" title="lemma">last_last</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlast</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.VLSM.Common.html#finite_protocol_trace_from_app_iff"><span class="id" title="lemma">finite_protocol_trace_from_app_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hprefix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hprefix</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hprefix</span> <span class="id" title="var">Hx</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHprefix</span> <span class="id" title="var">Hprefix</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hx</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">s'</span> <span class="id" title="var">x</span> <span class="id" title="var">tl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlast</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hv</span> <span class="id" title="var">Ht</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.VLSM.Common.html#vtransition"><span class="id" title="definition">vtransition</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#last"><span class="id" title="definition">last</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (@<a class="idref" href="CasperCBC.VLSM.Common.html#transition_item"><span class="id" title="record">transition_item</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#VLSM_type_full_validator"><span class="id" title="instance">VLSM_type_full_validator</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>) (@<a class="idref" href="CasperCBC.VLSM.Common.html#destination"><span class="id" title="projection">destination</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#VLSM_type_full_validator"><span class="id" title="instance">VLSM_type_full_validator</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">prefix</span>) <span class="id" title="var">start</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> (<span class="id" title="var">msgs</span>, <span class="id" title="var">final</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Hlast</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">c</span>|]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">iom</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">msg</span>|]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Ht</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">specialize</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add_not_empty"><span class="id" title="lemma">set_add_not_empty</span></a> <a class="idref" href="CasperCBC.Lib.Classes.html#decide_eq"><span class="id" title="abbreviation">decide_eq</span></a> <span class="id" title="var">msg</span> <span class="id" title="var">msgs</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hempty</span>. <span class="id" title="tactic">elim</span> <span class="id" title="var">Hempty</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">clear</span> <span class="id" title="var">Ht</span> <span class="id" title="var">H2</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHprefix</span> <span class="id" title="var">Hlast</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hitem</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hin</span> |[<span class="id" title="var">Heq</span> |<span class="id" title="var">Hfalse</span>]]; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span> <span class="id" title="var">Hfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHprefix</span> <span class="id" title="var">Hin</span>). <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">subst</span> <span class="id" title="var">item</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="last_state_empty_trace" class="idref" href="#last_state_empty_trace"><span class="id" title="lemma">last_state_empty_trace</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="is:132" class="idref" href="#is:132"><span class="id" title="binder">is</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="tr:133" class="idref" href="#tr:133"><span class="id" title="binder">tr</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#transition_item"><span class="id" title="record">transition_item</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Htr:134" class="idref" href="#Htr:134"><span class="id" title="binder">Htr</span></a>: <a class="idref" href="CasperCBC.VLSM.Common.html#finite_protocol_trace"><span class="id" title="definition">finite_protocol_trace</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#is:132"><span class="id" title="variable">is</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#tr:133"><span class="id" title="variable">tr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hlast:135" class="idref" href="#Hlast:135"><span class="id" title="binder">Hlast</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#last"><span class="id" title="definition">last</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#destination"><span class="id" title="projection">destination</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#tr:133"><span class="id" title="variable">tr</span></a>) <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#is:132"><span class="id" title="variable">is</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#pair"><span class="id" title="constructor">pair</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="item:136" class="idref" href="#item:136"><span class="id" title="binder">item</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#transition_item"><span class="id" title="record">transition_item</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hitem:137" class="idref" href="#Hitem:137"><span class="id" title="binder">Hitem</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#item:136"><span class="id" title="variable">item</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#tr:133"><span class="id" title="variable">tr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="CasperCBC.VLSM.Common.html#input"><span class="id" title="projection">input</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#item:136"><span class="id" title="variable">item</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#output"><span class="id" title="projection">output</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#item:136"><span class="id" title="variable">item</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#destination"><span class="id" title="projection">destination</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#item:136"><span class="id" title="variable">item</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#pair"><span class="id" title="constructor">pair</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#l"><span class="id" title="projection">l</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#item:136"><span class="id" title="variable">item</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Htr</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Htr</span> <span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#last_state_empty_segment"><span class="id" title="lemma">last_state_empty_segment</span></a> <span class="id" title="keyword">is</span> <span class="id" title="var">tr</span> <span class="id" title="var">Htr</span> <span class="id" title="var">Hlast</span> <span class="id" title="var">item</span> <span class="id" title="var">Hitem</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="sent_messages_prop" class="idref" href="#sent_messages_prop"><span class="id" title="lemma">sent_messages_prop</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s:138" class="idref" href="#s:138"><span class="id" title="binder">s</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hs:139" class="idref" href="#Hs:139"><span class="id" title="binder">Hs</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#protocol_state_prop"><span class="id" title="definition">protocol_state_prop</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:138"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="m:140" class="idref" href="#m:140"><span class="id" title="binder">m</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:140"><span class="id" title="variable">m</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:138"><span class="id" title="variable">s</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">(</span></a><a id="sm:141" class="idref" href="#sm:141"><span class="id" title="binder">sm</span></a> : <a class="idref" href="CasperCBC.VLSM.Equivocation.html#sent_messages"><span class="id" title="definition">sent_messages</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.vlsm"><span class="id" title="variable">vlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:138"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">),</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Specif.html#proj1_sig"><span class="id" title="definition">proj1_sig</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#sm:141"><span class="id" title="variable">sm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:140"><span class="id" title="variable">m</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hs</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_om</span> <span class="id" title="var">Hs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<a class="idref" href="CasperCBC.VLSM.Common.html#protocol_is_trace"><span class="id" title="lemma">protocol_is_trace</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <span class="id" title="var">s</span> <span class="id" title="var">_om</span> <span class="id" title="var">Hs</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Htr</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">His</span> | [<span class="id" title="keyword">is</span> [<span class="id" title="var">tr</span> [<span class="id" title="var">Htr</span> [<span class="id" title="var">Hdest</span> <span class="id" title="var">_</span>]]]]]; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">try</span> (<span class="id" title="tactic">inversion</span> <span class="id" title="var">His</span>; <span class="id" title="tactic">subst</span> <span class="id" title="var">s</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assert</span> (<span class="id" title="var">Hlst</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#last"><span class="id" title="definition">last</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">List.map</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#destination"><span class="id" title="projection">destination</span></a> <span class="id" title="var">tr</span>) <span class="id" title="keyword">is</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">destruct</span> <span class="id" title="var">tr</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">i</span> <span class="id" title="var">tr</span>]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hdest</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.Lib.ListExtras.html#last_map"><span class="id" title="lemma">last_map</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">m0</span> <span class="id" title="var">Hm0</span>]. <span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_some_traces"><span class="id" title="definition">selected_message_exists_in_some_traces</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hm0</span> <span class="id" title="keyword">as</span> [<span class="id" title="keyword">is</span> [<span class="id" title="var">tr</span> [<span class="id" title="var">Htr</span> [<span class="id" title="var">Hlst</span> <span class="id" title="var">Hex</span>]]]]. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#Exists_exists"><span class="id" title="lemma">Exists_exists</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hex</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hex</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">item</span> [<span class="id" title="var">Hitem</span> <span class="id" title="var">Hout</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#last_state_empty_trace"><span class="id" title="lemma">last_state_empty_trace</span></a> <span class="id" title="keyword">is</span> <span class="id" title="var">tr</span> <span class="id" title="var">Htr</span> <span class="id" title="var">Hlst</span> <span class="id" title="var">item</span> <span class="id" title="var">Hitem</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">_</span> [<span class="id" title="var">Hnout</span> <span class="id" title="var">_</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hnout</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hout</span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">Hout</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> (<span class="id" title="var">Hm</span> : <a class="idref" href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_some_traces"><span class="id" title="definition">selected_message_exists_in_some_traces</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.vlsm"><span class="id" title="variable">vlsm</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#output"><span class="id" title="projection">output</span></a> <span class="id" title="var">s</span> <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exists</span> <span class="id" title="keyword">is</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">tr</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">Htr</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">Hlst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#Exists_exists"><span class="id" title="lemma">Exists_exists</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#has_been_sent_in_trace_rev"><span class="id" title="lemma">has_been_sent_in_trace_rev</span></a> <span class="id" title="var">s</span> <span class="id" title="var">m</span> <span class="id" title="var">H</span> <span class="id" title="keyword">is</span> <span class="id" title="var">tr</span> <span class="id" title="var">Htr</span> <span class="id" title="var">Hlst</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Specif.html#exist"><span class="id" title="constructor">exist</span></a> <span class="id" title="var">_</span> <span class="id" title="var">m</span> <span class="id" title="var">Hm</span>). <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">m0</span> <span class="id" title="var">Hm</span>] <span class="id" title="var">Heq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">m0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hm</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">ism</span> [<span class="id" title="var">trm</span> [<span class="id" title="var">Htrm</span> [<span class="id" title="var">Hlastm</span> <span class="id" title="var">Hexistm</span>]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#Exists_exists"><span class="id" title="lemma">Exists_exists</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hexistm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hexistm</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">item</span> [<span class="id" title="var">Hin</span> <span class="id" title="var">Hout</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#has_been_sent_in_trace"><span class="id" title="lemma">has_been_sent_in_trace</span></a> <span class="id" title="var">s</span> <span class="id" title="var">m</span> <span class="id" title="var">ism</span> <span class="id" title="var">trm</span> <span class="id" title="var">Htrm</span> <span class="id" title="var">item</span> <span class="id" title="var">Hin</span> <span class="id" title="var">Hout</span> <span class="id" title="var">Hlastm</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="VLSM_full_validator_sent_consistency" class="idref" href="#VLSM_full_validator_sent_consistency"><span class="id" title="lemma">VLSM_full_validator_sent_consistency</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s:142" class="idref" href="#s:142"><span class="id" title="binder">s</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#vstate"><span class="id" title="definition">vstate</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.vlsm"><span class="id" title="variable">vlsm</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hs:143" class="idref" href="#Hs:143"><span class="id" title="binder">Hs</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#protocol_state_prop"><span class="id" title="definition">protocol_state_prop</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:142"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="m:144" class="idref" href="#m:144"><span class="id" title="binder">m</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_some_traces"><span class="id" title="definition">selected_message_exists_in_some_traces</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.vlsm"><span class="id" title="variable">vlsm</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#output"><span class="id" title="projection">output</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:142"><span class="id" title="variable">s</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:144"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_all_traces"><span class="id" title="definition">selected_message_exists_in_all_traces</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.vlsm"><span class="id" title="variable">vlsm</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#output"><span class="id" title="projection">output</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:142"><span class="id" title="variable">s</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:144"><span class="id" title="variable">m</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#sent_messages_prop"><span class="id" title="lemma">sent_messages_prop</span></a> <span class="id" title="var">s</span> <span class="id" title="var">Hs</span> <span class="id" title="var">m</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="keyword">is</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#proj2"><span class="id" title="lemma">proj2</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec</span> <span class="id" title="var">Hin</span>; <span class="id" title="tactic">try</span> (<span class="id" title="tactic">exists</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Specif.html#exist"><span class="id" title="constructor">exist</span></a> <span class="id" title="var">_</span> <span class="id" title="var">m</span> <span class="id" title="var">H</span>); <span class="id" title="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#has_been_sent_in_trace_rev"><span class="id" title="lemma">has_been_sent_in_trace_rev</span></a> <span class="id" title="var">s</span> <span class="id" title="var">m</span> <span class="id" title="var">Hin</span> <span class="id" title="keyword">is</span> <span class="id" title="var">tr</span> <span class="id" title="var">Htr</span> <span class="id" title="var">Hlast</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hex</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#Exists_exists"><span class="id" title="lemma">Exists_exists</span></a>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hs</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_om</span> <span class="id" title="var">Hs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<a class="idref" href="CasperCBC.VLSM.Common.html#protocol_is_trace"><span class="id" title="lemma">protocol_is_trace</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <span class="id" title="var">s</span> <span class="id" title="var">_om</span> <span class="id" title="var">Hs</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Htr</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hinit</span> | [<span class="id" title="keyword">is</span> [<span class="id" title="var">tr</span> [<span class="id" title="var">Htr</span> [<span class="id" title="var">Hlsts</span> <span class="id" title="var">_</span>]]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">specialize</span> (<a class="idref" href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_all_traces_initial_state"><span class="id" title="lemma">selected_message_exists_in_all_traces_initial_state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.vlsm"><span class="id" title="variable">vlsm</span></a> <span class="id" title="var">s</span> <span class="id" title="var">Hinit</span> <a class="idref" href="CasperCBC.VLSM.Common.html#output"><span class="id" title="projection">output</span></a> <span class="id" title="var">m</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hsm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">elim</span> <span class="id" title="var">Hsm</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exists</span> <span class="id" title="keyword">is</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">tr</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hlst</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#last"><span class="id" title="definition">last</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">List.map</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#destination"><span class="id" title="projection">destination</span></a> <span class="id" title="var">tr</span>) <span class="id" title="keyword">is</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">tr</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">i</span> <span class="id" title="var">tr</span>]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hlsts</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.Lib.ListExtras.html#last_map"><span class="id" title="lemma">last_map</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">Hlst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H</span> <span class="id" title="keyword">is</span> <span class="id" title="var">tr</span> <span class="id" title="var">Htr</span> <span class="id" title="var">Hlst</span>). <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a id="VLSM_full_validator_computable_sent_messages" class="idref" href="#VLSM_full_validator_computable_sent_messages"><span class="id" title="instance">VLSM_full_validator_computable_sent_messages</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="CasperCBC.VLSM.Equivocation.html#computable_sent_messages"><span class="id" title="class">computable_sent_messages</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.vlsm"><span class="id" title="variable">vlsm</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <a class="idref" href="CasperCBC.VLSM.Equivocation.html#sent_messages_fn"><span class="id" title="method">sent_messages_fn</span></a> := <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CasperCBC.VLSM.Equivocation.html#sent_messages_full"><span class="id" title="method">sent_messages_full</span></a> := <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#sent_messages_prop"><span class="id" title="lemma">sent_messages_prop</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CasperCBC.VLSM.Equivocation.html#sent_messages_consistency"><span class="id" title="method">sent_messages_consistency</span></a> := <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#VLSM_full_validator_sent_consistency"><span class="id" title="lemma">VLSM_full_validator_sent_consistency</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="VLSM_full_validator_has_been_sent" class="idref" href="#VLSM_full_validator_has_been_sent"><span class="id" title="definition">VLSM_full_validator_has_been_sent</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="CasperCBC.VLSM.Equivocation.html#has_been_sent_capability"><span class="id" title="class">has_been_sent_capability</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.vlsm"><span class="id" title="variable">vlsm</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CasperCBC.VLSM.Equivocation.html#computable_sent_messages_has_been_sent_capability"><span class="id" title="definition">computable_sent_messages_has_been_sent_capability</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.vlsm"><span class="id" title="variable">vlsm</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="get_sent_messages" class="idref" href="#get_sent_messages"><span class="id" title="lemma">get_sent_messages</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s:145" class="idref" href="#s:145"><span class="id" title="binder">s</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hs:146" class="idref" href="#Hs:146"><span class="id" title="binder">Hs</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#protocol_state_prop"><span class="id" title="definition">protocol_state_prop</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:145"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#incl"><span class="id" title="definition">incl</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:145"><span class="id" title="variable">s</span></a>) (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_message_set"><span class="id" title="definition">get_message_set</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:145"><span class="id" title="variable">s</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">m</span> <span class="id" title="var">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#sent_messages_prop"><span class="id" title="lemma">sent_messages_prop</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hm</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">m0</span> <span class="id" title="var">Hm</span>] <span class="id" title="var">Heq</span>]. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">m0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#VLSM_full_validator_sent_consistency"><span class="id" title="lemma">VLSM_full_validator_sent_consistency</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hs</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_om</span> <span class="id" title="var">Hs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<a class="idref" href="CasperCBC.VLSM.Common.html#protocol_is_trace"><span class="id" title="lemma">protocol_is_trace</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <span class="id" title="var">s</span> <span class="id" title="var">_om</span> <span class="id" title="var">Hs</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Htr</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hinit</span> | [<span class="id" title="keyword">is</span> [<span class="id" title="var">tr</span> [<span class="id" title="var">Htr</span> [<span class="id" title="var">Hlsts</span> <span class="id" title="var">_</span>]]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">elim</span> (<a class="idref" href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_all_traces_initial_state"><span class="id" title="lemma">selected_message_exists_in_all_traces_initial_state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.vlsm"><span class="id" title="variable">vlsm</span></a> <span class="id" title="var">s</span> <span class="id" title="var">Hinit</span> <a class="idref" href="CasperCBC.VLSM.Common.html#output"><span class="id" title="projection">output</span></a> <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">assert</span> (<span class="id" title="var">Hlst</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#last"><span class="id" title="definition">last</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#destination"><span class="id" title="projection">destination</span></a> <span class="id" title="var">tr</span>) <span class="id" title="keyword">is</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">tr</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">i</span> <span class="id" title="var">tr</span>]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hlsts</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.Lib.ListExtras.html#last_map"><span class="id" title="lemma">last_map</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hm</span> <span class="id" title="keyword">is</span> <span class="id" title="var">tr</span> <span class="id" title="var">Htr</span> <span class="id" title="var">Hlst</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#Exists_exists"><span class="id" title="lemma">Exists_exists</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hm</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">item</span> [<span class="id" title="var">Hitem</span> <span class="id" title="var">Hm</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#in_split"><span class="id" title="lemma">in_split</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hitem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hitem</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">l1</span> [<span class="id" title="var">l2</span> <span class="id" title="var">Hitem</span>]]. <span class="id" title="tactic">subst</span> <span class="id" title="var">tr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<a class="idref" href="CasperCBC.VLSM.Common.html#finite_protocol_trace_from_app_iff"><span class="id" title="lemma">finite_protocol_trace_from_app_iff</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <span class="id" title="keyword">is</span> <span class="id" title="var">l1</span> (<span class="id" title="var">item</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">l2</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">Htr_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Htr_app</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Htr_app</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> <span class="id" title="var">Htr_app</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Htr</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Htr</span> <span class="id" title="var">Hinit</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Htr_app</span> <span class="id" title="var">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Htr_app</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hl1</span> <span class="id" title="var">Hl2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hl2</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">item</span> <span class="id" title="var">tl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H1</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">oom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#protocol_transition_inv_out"><span class="id" title="lemma">protocol_transition_inv_out</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hs0</span> [<span class="id" title="var">c</span> <span class="id" title="var">Hc</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hfutures</span> : <a class="idref" href="CasperCBC.VLSM.Common.html#in_futures"><span class="id" title="definition">in_futures</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <span class="id" title="var">s0</span> <span class="id" title="var">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">l2</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map_app"><span class="id" title="lemma">map_app</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlst</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="CasperCBC.Lib.ListExtras.html#last_app"><span class="id" title="lemma">last_app</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map_cons"><span class="id" title="lemma">map_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlst</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="CasperCBC.Lib.ListExtras.html#unroll_last"><span class="id" title="lemma">unroll_last</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlst</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#get_messages_in_futures"><span class="id" title="lemma">get_messages_in_futures</span></a> <span class="id" title="var">s0</span> <span class="id" title="var">s</span> <span class="id" title="var">Hfutures</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">s0</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add_iff"><span class="id" title="lemma">set_add_iff</span></a>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="has_been_received_in_trace" class="idref" href="#has_been_received_in_trace"><span class="id" title="lemma">has_been_received_in_trace</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s:147" class="idref" href="#s:147"><span class="id" title="binder">s</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="m:148" class="idref" href="#m:148"><span class="id" title="binder">m</span></a>: <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="is:149" class="idref" href="#is:149"><span class="id" title="binder">is</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="tr:150" class="idref" href="#tr:150"><span class="id" title="binder">tr</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#transition_item"><span class="id" title="record">transition_item</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Htr:151" class="idref" href="#Htr:151"><span class="id" title="binder">Htr</span></a>: <a class="idref" href="CasperCBC.VLSM.Common.html#finite_protocol_trace"><span class="id" title="definition">finite_protocol_trace</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#is:149"><span class="id" title="variable">is</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#tr:150"><span class="id" title="variable">tr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="item:152" class="idref" href="#item:152"><span class="id" title="binder">item</span></a>: <a class="idref" href="CasperCBC.VLSM.Common.html#transition_item"><span class="id" title="record">transition_item</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hitem:153" class="idref" href="#Hitem:153"><span class="id" title="binder">Hitem</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#item:152"><span class="id" title="variable">item</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#tr:150"><span class="id" title="variable">tr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hm:154" class="idref" href="#Hm:154"><span class="id" title="binder">Hm</span></a>: <a class="idref" href="CasperCBC.VLSM.Common.html#input"><span class="id" title="projection">input</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#item:152"><span class="id" title="variable">item</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:148"><span class="id" title="variable">m</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hs:155" class="idref" href="#Hs:155"><span class="id" title="binder">Hs</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#last"><span class="id" title="definition">last</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#destination"><span class="id" title="projection">destination</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#tr:150"><span class="id" title="variable">tr</span></a>) <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#is:149"><span class="id" title="variable">is</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:147"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:148"><span class="id" title="variable">m</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#received_messages"><span class="id" title="definition">State.received_messages</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:147"><span class="id" title="variable">s</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#in_split"><span class="id" title="lemma">in_split</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hitem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hitem</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">l1</span> [<span class="id" title="var">l2</span> <span class="id" title="var">Hitem</span>]]. <span class="id" title="tactic">subst</span> <span class="id" title="var">tr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Htr</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Htr</span> <span class="id" title="var">Hinit</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<a class="idref" href="CasperCBC.VLSM.Common.html#finite_protocol_trace_from_app_iff"><span class="id" title="lemma">finite_protocol_trace_from_app_iff</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <span class="id" title="keyword">is</span> <span class="id" title="var">l1</span> (<span class="id" title="var">item</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">l2</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">Htr_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Htr_app</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Htr_app</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> <span class="id" title="var">Htr_app</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Htr_app</span> <span class="id" title="var">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">Htr</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Htr_app</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> <span class="id" title="var">Htr</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#last"><span class="id" title="definition">last</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> (@<a class="idref" href="CasperCBC.VLSM.Common.html#transition_item"><span class="id" title="record">transition_item</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#VLSM_type_full_validator"><span class="id" title="instance">VLSM_type_full_validator</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>) (@<a class="idref" href="CasperCBC.VLSM.Common.html#destination"><span class="id" title="projection">destination</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#VLSM_type_full_validator"><span class="id" title="instance">VLSM_type_full_validator</span></a>) <span class="id" title="var">l1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">is</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">sl1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Htr</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">tl</span> <span class="id" title="var">item</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">iom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hs0</span> : <a class="idref" href="CasperCBC.VLSM.Common.html#in_futures"><span class="id" title="definition">in_futures</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <span class="id" title="var">s0</span> <span class="id" title="var">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exists</span> <span class="id" title="var">l2</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map_app"><span class="id" title="lemma">map_app</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map_cons"><span class="id" title="lemma">map_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="CasperCBC.Lib.ListExtras.html#last_app"><span class="id" title="lemma">last_app</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="CasperCBC.Lib.ListExtras.html#unroll_last"><span class="id" title="lemma">unroll_last</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#has_been_received_in_futures"><span class="id" title="lemma">has_been_received_in_futures</span></a> <span class="id" title="keyword">with</span> <span class="id" title="var">s0</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#has_been_sent_protocol_transition"><span class="id" title="lemma">has_been_sent_protocol_transition</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H3</span> <span class="id" title="var">m</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hbspt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#protocol_transition_inv_in"><span class="id" title="lemma">protocol_transition_inv_in</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hs0'</span> [<span class="id" title="var">Hoom</span> [<span class="id" title="var">Hnin</span> [<span class="id" title="var">Hincl</span> [<span class="id" title="var">Hsl1</span> [<span class="id" title="var">Hm</span> <span class="id" title="var">Hps0</span>]]]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#in_dec"><span class="id" title="lemma">in_dec</span></a> <a class="idref" href="CasperCBC.Lib.Classes.html#decide_eq"><span class="id" title="abbreviation">decide_eq</span></a> <span class="id" title="var">m</span> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a> <span class="id" title="var">sl1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#get_sent_messages"><span class="id" title="lemma">get_sent_messages</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">i</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">elim</span> <span class="id" title="var">Hnin</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hbspt</span> <span class="id" title="var">n</span>). <span class="id" title="tactic">subst</span> <span class="id" title="var">oom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hnbs</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <span class="id" title="var">m</span> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a> <span class="id" title="var">s0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#in_dec"><span class="id" title="lemma">in_dec</span></a> <a class="idref" href="CasperCBC.Lib.Classes.html#decide_eq"><span class="id" title="abbreviation">decide_eq</span></a> <span class="id" title="var">m</span> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a> <span class="id" title="var">s0</span>)); <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hbspt</span> <span class="id" title="tactic">in</span> <span class="id" title="var">i</span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#received_messages"><span class="id" title="definition">State.received_messages</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_diff_iff"><span class="id" title="lemma">set_diff_iff</span></a>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">s0</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add_iff"><span class="id" title="lemma">set_add_iff</span></a>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="has_been_received_in_trace_rev" class="idref" href="#has_been_received_in_trace_rev"><span class="id" title="lemma">has_been_received_in_trace_rev</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s:156" class="idref" href="#s:156"><span class="id" title="binder">s</span></a>: <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="m:157" class="idref" href="#m:157"><span class="id" title="binder">m</span></a>: <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Horacle:158" class="idref" href="#Horacle:158"><span class="id" title="binder">Horacle</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:157"><span class="id" title="variable">m</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#received_messages"><span class="id" title="definition">State.received_messages</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:156"><span class="id" title="variable">s</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="is:159" class="idref" href="#is:159"><span class="id" title="binder">is</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="tr:160" class="idref" href="#tr:160"><span class="id" title="binder">tr</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#transition_item"><span class="id" title="record">transition_item</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Htr:161" class="idref" href="#Htr:161"><span class="id" title="binder">Htr</span></a>: <a class="idref" href="CasperCBC.VLSM.Common.html#finite_protocol_trace"><span class="id" title="definition">finite_protocol_trace</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#is:159"><span class="id" title="variable">is</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#tr:160"><span class="id" title="variable">tr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hlast:162" class="idref" href="#Hlast:162"><span class="id" title="binder">Hlast</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#last"><span class="id" title="definition">last</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#destination"><span class="id" title="projection">destination</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#tr:160"><span class="id" title="variable">tr</span></a>) <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#is:159"><span class="id" title="variable">is</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:156"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="item:163" class="idref" href="#item:163"><span class="id" title="binder">item</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#transition_item"><span class="id" title="record">transition_item</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#item:163"><span class="id" title="variable">item</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#tr:160"><span class="id" title="variable">tr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#input"><span class="id" title="projection">input</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#item:163"><span class="id" title="variable">item</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:157"><span class="id" title="variable">m</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_diff_iff"><span class="id" title="lemma">set_diff_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Horacle</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Horacle</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hin</span> <span class="id" title="var">Hns</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Htr</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Htr</span> <span class="id" title="var">Hinit</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hstart</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <span class="id" title="var">m</span> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_message_set"><span class="id" title="definition">get_message_set</span></a> <span class="id" title="keyword">is</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hinit</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">n</span>. <span class="id" title="var">contradiction</span> <span class="id" title="var">n</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> -<span class="id" title="var">Hin</span> <span class="id" title="var">Hns</span> <span class="id" title="var">Htr</span> <span class="id" title="var">Hlast</span> <span class="id" title="var">Hstart</span> <span class="id" title="var">bvlsm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="keyword">is</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">tr</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlast</span>. <span class="id" title="tactic">subst</span> <span class="id" title="keyword">is</span>. <span class="id" title="tactic">elim</span> <span class="id" title="var">Hstart</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">Htr</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">s'</span> <span class="id" title="var">a</span> <span class="id" title="var">tl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hlast'</span> := <span class="id" title="var">Hlast</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map_cons"><span class="id" title="lemma">map_cons</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlast</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="CasperCBC.Lib.ListExtras.html#unroll_last"><span class="id" title="lemma">unroll_last</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlast</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlast</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hfutures</span> : <a class="idref" href="CasperCBC.VLSM.Common.html#in_futures"><span class="id" title="definition">in_futures</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <span class="id" title="var">s0</span> <span class="id" title="var">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">exists</span> <span class="id" title="var">tr</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hnbs</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <span class="id" title="var">m</span> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a> <span class="id" title="var">s0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#in_dec"><span class="id" title="lemma">in_dec</span></a> <a class="idref" href="CasperCBC.Lib.Classes.html#decide_eq"><span class="id" title="abbreviation">decide_eq</span></a>  <span class="id" title="var">m</span> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a> <span class="id" title="var">s0</span>)); <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#has_been_sent_in_futures"><span class="id" title="lemma">has_been_sent_in_futures</span></a> <span class="id" title="var">s0</span> <span class="id" title="var">s</span> <span class="id" title="var">Hfutures</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">elim</span> <span class="id" title="var">Hns</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHtr</span> <span class="id" title="var">s0</span> <span class="id" title="var">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#in_dec"><span class="id" title="lemma">in_dec</span></a> <a class="idref" href="CasperCBC.Lib.Classes.html#decide_eq"><span class="id" title="abbreviation">decide_eq</span></a> <span class="id" title="var">m</span> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#get_message_set"><span class="id" title="definition">get_message_set</span></a> <span class="id" title="var">s0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">specialize</span> (<a class="idref" href="CasperCBC.VLSM.Common.html#finite_ptrace_first_pstate"><span class="id" title="lemma">finite_ptrace_first_pstate</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <span class="id" title="keyword">is</span> <span class="id" title="var">_</span> <span class="id" title="var">Htr</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hpstart</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hpstart</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_om</span> <span class="id" title="var">Hpstart</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<a class="idref" href="CasperCBC.VLSM.Common.html#protocol_is_trace"><span class="id" title="lemma">protocol_is_trace</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <span class="id" title="keyword">is</span> <span class="id" title="var">_om</span> <span class="id" title="var">Hpstart</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Htr_start</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span>  (<span class="id" title="var">Hiom</span> : <span class="id" title="var">iom</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> <span class="id" title="var">Ht</span>]. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.VLSM.Common.html#vtransition"><span class="id" title="definition">vtransition</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="keyword">is</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">msgs</span>, <span class="id" title="var">final</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">c</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add_iff"><span class="id" title="lemma">set_add_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">i</span> | <span class="id" title="var">i</span>]; <span class="id" title="tactic">try</span> (<span class="id" title="tactic">elim</span> <span class="id" title="var">Hstart</span>; <span class="id" title="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> -<span class="id" title="var">Hnbs</span>. <span class="id" title="var">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">elim</span> <span class="id" title="var">Hnbs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">final</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">m</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add_iff"><span class="id" title="lemma">set_add_iff</span></a>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#sent_messages"><span class="id" title="definition">State.sent_messages</span></a>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">iom</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">msg</span>|]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Ht</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">Ht</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_add_iff"><span class="id" title="lemma">set_add_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">i</span> | <span class="id" title="var">i</span>]; <span class="id" title="tactic">try</span> (<span class="id" title="tactic">elim</span> <span class="id" title="var">Hstart</span>; <span class="id" title="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">m</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">elim</span> <span class="id" title="var">Hstart</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">iom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> {| <a class="idref" href="CasperCBC.VLSM.Common.html#l"><span class="id" title="projection">l</span></a> := <span class="id" title="var">l</span>; <a class="idref" href="CasperCBC.VLSM.Common.html#input"><span class="id" title="projection">input</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">m</span>; <a class="idref" href="CasperCBC.VLSM.Common.html#destination"><span class="id" title="projection">destination</span></a> := <span class="id" title="var">s0</span>; <a class="idref" href="CasperCBC.VLSM.Common.html#output"><span class="id" title="projection">output</span></a> := <span class="id" title="var">oom</span> |}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHtr</span> <span class="id" title="var">Hlast</span> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">IHtr</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">item</span> [<span class="id" title="var">Hitem</span> <span class="id" title="var">Hin'</span>]]. <span class="id" title="tactic">exists</span> <span class="id" title="var">item</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="received_messages_prop" class="idref" href="#received_messages_prop"><span class="id" title="lemma">received_messages_prop</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s:164" class="idref" href="#s:164"><span class="id" title="binder">s</span></a> : <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.C"><span class="id" title="variable">C</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.V"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hs:165" class="idref" href="#Hs:165"><span class="id" title="binder">Hs</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#protocol_state_prop"><span class="id" title="definition">protocol_state_prop</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:164"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="m:166" class="idref" href="#m:166"><span class="id" title="binder">m</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:166"><span class="id" title="variable">m</span></a> (<a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#received_messages"><span class="id" title="definition">State.received_messages</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:164"><span class="id" title="variable">s</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">(</span></a><a id="sm:167" class="idref" href="#sm:167"><span class="id" title="binder">sm</span></a> : <a class="idref" href="CasperCBC.VLSM.Equivocation.html#received_messages"><span class="id" title="definition">received_messages</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.vlsm"><span class="id" title="variable">vlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:164"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">),</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Specif.html#proj1_sig"><span class="id" title="definition">proj1_sig</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#sm:167"><span class="id" title="variable">sm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:166"><span class="id" title="variable">m</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> (<span class="id" title="var">Hm</span> : <a class="idref" href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_some_traces"><span class="id" title="definition">selected_message_exists_in_some_traces</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.vlsm"><span class="id" title="variable">vlsm</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#input"><span class="id" title="projection">input</span></a> <span class="id" title="var">s</span> <span class="id" title="var">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">try</span> (<span class="id" title="tactic">exists</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Specif.html#exist"><span class="id" title="constructor">exist</span></a> <span class="id" title="var">_</span> <span class="id" title="var">m</span> <span class="id" title="var">Hm</span>); <span class="id" title="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hs</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_om</span> <span class="id" title="var">Hs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<a class="idref" href="CasperCBC.VLSM.Common.html#protocol_is_trace"><span class="id" title="lemma">protocol_is_trace</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <span class="id" title="var">s</span> <span class="id" title="var">_om</span> <span class="id" title="var">Hs</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Htr</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hinit</span> | [<span class="id" title="var">start</span> [<span class="id" title="var">tr</span> [<span class="id" title="var">Htr</span> [<span class="id" title="var">Hdest</span> <span class="id" title="var">_</span>]]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.ListSet.html#set_diff_iff"><span class="id" title="lemma">set_diff_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hin</span> <span class="id" title="var">Hns</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hinit</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">s</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">specialize</span> (<a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#has_been_received_in_trace_rev"><span class="id" title="lemma">has_been_received_in_trace_rev</span></a> <span class="id" title="var">s</span> <span class="id" title="var">m</span> <span class="id" title="var">H</span> <span class="id" title="var">start</span> <span class="id" title="var">tr</span> <span class="id" title="var">Htr</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hbr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hlast</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#last"><span class="id" title="definition">last</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">List.map</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#destination"><span class="id" title="projection">destination</span></a> <span class="id" title="var">tr</span>) <span class="id" title="var">start</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">destruct</span> <span class="id" title="var">tr</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">i</span> <span class="id" title="var">tr</span>]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hdest</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.Lib.ListExtras.html#last_map"><span class="id" title="lemma">last_map</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hbr</span> <span class="id" title="var">Hlast</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">start</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">tr</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">Htr</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">Hlast</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#Exists_exists"><span class="id" title="lemma">Exists_exists</span></a>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">m0</span> <span class="id" title="var">H</span>] <span class="id" title="var">Heq</span>]; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">subst</span> <span class="id" title="var">m0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="keyword">is</span> [<span class="id" title="var">tr</span> [<span class="id" title="var">Htr</span> [<span class="id" title="var">Hlast</span> <span class="id" title="var">Hitem</span>]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#Exists_exists"><span class="id" title="lemma">Exists_exists</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hitem</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hitem</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">item</span> [<span class="id" title="var">Hitem</span> <span class="id" title="var">Hin</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#has_been_received_in_trace"><span class="id" title="lemma">has_been_received_in_trace</span></a> <span class="id" title="var">s</span> <span class="id" title="var">m</span> <span class="id" title="keyword">is</span> <span class="id" title="var">tr</span> <span class="id" title="var">Htr</span> <span class="id" title="var">item</span> <span class="id" title="var">Hitem</span> <span class="id" title="var">Hin</span> <span class="id" title="var">Hlast</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="VLSM_full_validator_received_consistency" class="idref" href="#VLSM_full_validator_received_consistency"><span class="id" title="lemma">VLSM_full_validator_received_consistency</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s:168" class="idref" href="#s:168"><span class="id" title="binder">s</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#vstate"><span class="id" title="definition">vstate</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.vlsm"><span class="id" title="variable">vlsm</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hs:169" class="idref" href="#Hs:169"><span class="id" title="binder">Hs</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#protocol_state_prop"><span class="id" title="definition">protocol_state_prop</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:168"><span class="id" title="variable">s</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="m:170" class="idref" href="#m:170"><span class="id" title="binder">m</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_some_traces"><span class="id" title="definition">selected_message_exists_in_some_traces</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.vlsm"><span class="id" title="variable">vlsm</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#input"><span class="id" title="projection">input</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:168"><span class="id" title="variable">s</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:170"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">&lt;-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_all_traces"><span class="id" title="definition">selected_message_exists_in_all_traces</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.vlsm"><span class="id" title="variable">vlsm</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#input"><span class="id" title="projection">input</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:168"><span class="id" title="variable">s</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m:170"><span class="id" title="variable">m</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#received_messages_prop"><span class="id" title="lemma">received_messages_prop</span></a> <span class="id" title="var">s</span> <span class="id" title="var">Hs</span> <span class="id" title="var">m</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="keyword">is</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#proj2"><span class="id" title="lemma">proj2</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec</span> <span class="id" title="var">Hin</span>; <span class="id" title="tactic">try</span> (<span class="id" title="tactic">exists</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Specif.html#exist"><span class="id" title="constructor">exist</span></a> <span class="id" title="var">_</span> <span class="id" title="var">m</span> <span class="id" title="var">H</span>); <span class="id" title="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#has_been_received_in_trace_rev"><span class="id" title="lemma">has_been_received_in_trace_rev</span></a> <span class="id" title="var">s</span> <span class="id" title="var">m</span> <span class="id" title="var">Hin</span> <span class="id" title="keyword">is</span> <span class="id" title="var">tr</span> <span class="id" title="var">Htr</span> <span class="id" title="var">Hlast</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hex</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#Exists_exists"><span class="id" title="lemma">Exists_exists</span></a>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hs</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_om</span> <span class="id" title="var">Hs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<a class="idref" href="CasperCBC.VLSM.Common.html#protocol_is_trace"><span class="id" title="lemma">protocol_is_trace</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <span class="id" title="var">s</span> <span class="id" title="var">_om</span> <span class="id" title="var">Hs</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Htr</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hinit</span> | [<span class="id" title="keyword">is</span> [<span class="id" title="var">tr</span> [<span class="id" title="var">Htr</span> [<span class="id" title="var">Hlsts</span> <span class="id" title="var">_</span>]]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">specialize</span> (<a class="idref" href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_all_traces_initial_state"><span class="id" title="lemma">selected_message_exists_in_all_traces_initial_state</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.vlsm"><span class="id" title="variable">vlsm</span></a> <span class="id" title="var">s</span> <span class="id" title="var">Hinit</span> <a class="idref" href="CasperCBC.VLSM.Common.html#input"><span class="id" title="projection">input</span></a> <span class="id" title="var">m</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hsm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">elim</span> <span class="id" title="var">Hsm</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exists</span> <span class="id" title="keyword">is</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">tr</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hlst</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#last"><span class="id" title="definition">last</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">List.map</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#destination"><span class="id" title="projection">destination</span></a> <span class="id" title="var">tr</span>) <span class="id" title="keyword">is</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">tr</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">i</span> <span class="id" title="var">tr</span>]; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hlsts</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.Lib.ListExtras.html#last_map"><span class="id" title="lemma">last_map</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">Hlst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H</span> <span class="id" title="keyword">is</span> <span class="id" title="var">tr</span> <span class="id" title="var">Htr</span> <span class="id" title="var">Hlst</span>). <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Instance</span> <a id="VLSM_full_validator_computable_received_messages" class="idref" href="#VLSM_full_validator_computable_received_messages"><span class="id" title="instance">VLSM_full_validator_computable_received_messages</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="CasperCBC.VLSM.Equivocation.html#computable_received_messages"><span class="id" title="class">computable_received_messages</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.vlsm"><span class="id" title="variable">vlsm</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <a class="idref" href="CasperCBC.VLSM.Equivocation.html#received_messages_fn"><span class="id" title="method">received_messages_fn</span></a> := <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#received_messages"><span class="id" title="definition">State.received_messages</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CasperCBC.VLSM.Equivocation.html#received_messages_full"><span class="id" title="method">received_messages_full</span></a> := <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#received_messages_prop"><span class="id" title="lemma">received_messages_prop</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CasperCBC.VLSM.Equivocation.html#received_messages_consistency"><span class="id" title="method">received_messages_consistency</span></a> := <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#VLSM_full_validator_received_consistency"><span class="id" title="lemma">VLSM_full_validator_received_consistency</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="VLSM_full_validator_has_been_received" class="idref" href="#VLSM_full_validator_has_been_received"><span class="id" title="definition">VLSM_full_validator_has_been_received</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="CasperCBC.VLSM.Equivocation.html#has_been_received_capability"><span class="id" title="class">has_been_received_capability</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.vlsm"><span class="id" title="variable">vlsm</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="CasperCBC.VLSM.Equivocation.html#computable_received_messages_has_been_received_capability"><span class="id" title="definition">computable_received_messages_has_been_received_capability</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.vlsm"><span class="id" title="variable">vlsm</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="VLSM_full_validator_sent_messages_comparable'" class="idref" href="#VLSM_full_validator_sent_messages_comparable'"><span class="id" title="lemma">VLSM_full_validator_sent_messages_comparable'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s:171" class="idref" href="#s:171"><span class="id" title="binder">s</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#vstate"><span class="id" title="definition">vstate</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.vlsm"><span class="id" title="variable">vlsm</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="tr:172" class="idref" href="#tr:172"><span class="id" title="binder">tr</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#transition_item"><span class="id" title="record">transition_item</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Htr:173" class="idref" href="#Htr:173"><span class="id" title="binder">Htr</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#finite_protocol_trace"><span class="id" title="definition">finite_protocol_trace</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:171"><span class="id" title="variable">s</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#tr:172"><span class="id" title="variable">tr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="prefix:174" class="idref" href="#prefix:174"><span class="id" title="binder">prefix</span></a> <a id="middle:175" class="idref" href="#middle:175"><span class="id" title="binder">middle</span></a> <a id="suffix:176" class="idref" href="#suffix:176"><span class="id" title="binder">suffix</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#transition_item"><span class="id" title="record">transition_item</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="item1:177" class="idref" href="#item1:177"><span class="id" title="binder">item1</span></a> <a id="item2:178" class="idref" href="#item2:178"><span class="id" title="binder">item2</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#transition_item"><span class="id" title="record">transition_item</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Htreq:179" class="idref" href="#Htreq:179"><span class="id" title="binder">Htreq</span></a>: <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#tr:172"><span class="id" title="variable">tr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#prefix:174"><span class="id" title="variable">prefix</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#cons"><span class="id" title="constructor">cons</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#item1:177"><span class="id" title="variable">item1</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#middle:175"><span class="id" title="variable">middle</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#item2:178"><span class="id" title="variable">item2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#suffix:176"><span class="id" title="variable">suffix</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="m1:180" class="idref" href="#m1:180"><span class="id" title="binder">m1</span></a> <a id="m2:181" class="idref" href="#m2:181"><span class="id" title="binder">m2</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hm1:182" class="idref" href="#Hm1:182"><span class="id" title="binder">Hm1</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#output"><span class="id" title="projection">output</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#item1:177"><span class="id" title="variable">item1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m1:180"><span class="id" title="variable">m1</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hm2:183" class="idref" href="#Hm2:183"><span class="id" title="binder">Hm2</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#output"><span class="id" title="projection">output</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#item2:178"><span class="id" title="variable">item2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m2:181"><span class="id" title="variable">m2</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="CasperCBC.CBC.FullNode.Validator.Equivocation.html#validator_message_preceeds"><span class="id" title="definition">validator_message_preceeds</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m1:180"><span class="id" title="variable">m1</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m2:181"><span class="id" title="variable">m2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#app_assoc"><span class="id" title="lemma">app_assoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Htreq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">tr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Htr</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Htr</span> <span class="id" title="var">Hinit</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.VLSM.Common.html#finite_protocol_trace_from_app_iff"><span class="id" title="lemma">finite_protocol_trace_from_app_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Htr</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Htr1</span> <span class="id" title="var">Htr2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#has_been_sent_in_trace"><span class="id" title="lemma">has_been_sent_in_trace</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#last"><span class="id" title="definition">last</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#destination"><span class="id" title="projection">destination</span></a> (<span class="id" title="var">prefix</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <span class="id" title="var">item1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">middle</span>)) <span class="id" title="var">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">m1</span> <span class="id" title="var">s</span> (<span class="id" title="var">prefix</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <span class="id" title="var">item1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">middle</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#conj"><span class="id" title="constructor">conj</span></a> <span class="id" title="var">Htr1</span> <span class="id" title="var">Hinit</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">item1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <span class="id" title="keyword">as</span> <span class="id" title="var">Hm1'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec</span> <span class="id" title="var">Hm1'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#in_app_iff"><span class="id" title="lemma">in_app_iff</span></a>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hm1'</span> <span class="id" title="var">Hm1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Htr2</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm2</span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">oom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#protocol_transition_inv_out"><span class="id" title="lemma">protocol_transition_inv_out</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">_</span> [<span class="id" title="var">Hjust</span> <span class="id" title="var">_</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.Equivocation.html#validator_message_preceeds"><span class="id" title="definition">validator_message_preceeds</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.Equivocation.html#validator_message_preceeds_fn"><span class="id" title="definition">validator_message_preceeds_fn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">m2</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hjust</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">j</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.Lib.ListExtras.html#in_correct"><span class="id" title="lemma">in_correct</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#in_unmake_message_set"><span class="id" title="lemma">in_unmake_message_set</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.State.html#in_make_justification"><span class="id" title="lemma">in_make_justification</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#get_sent_messages"><span class="id" title="lemma">get_sent_messages</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="CasperCBC.VLSM.Common.html#finite_ptrace_last_pstate"><span class="id" title="lemma">finite_ptrace_last_pstate</span></a>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="VLSM_full_validator_sent_messages_comparable" class="idref" href="#VLSM_full_validator_sent_messages_comparable"><span class="id" title="lemma">VLSM_full_validator_sent_messages_comparable</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="s:184" class="idref" href="#s:184"><span class="id" title="binder">s</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#vstate"><span class="id" title="definition">vstate</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.vlsm"><span class="id" title="variable">vlsm</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="tr:185" class="idref" href="#tr:185"><span class="id" title="binder">tr</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#transition_item"><span class="id" title="record">transition_item</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Htr:186" class="idref" href="#Htr:186"><span class="id" title="binder">Htr</span></a> : <a class="idref" href="CasperCBC.VLSM.Common.html#finite_protocol_trace"><span class="id" title="definition">finite_protocol_trace</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.bvlsm"><span class="id" title="variable">bvlsm</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#s:184"><span class="id" title="variable">s</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#tr:185"><span class="id" title="variable">tr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="m1:187" class="idref" href="#m1:187"><span class="id" title="binder">m1</span></a> <a id="m2:188" class="idref" href="#m2:188"><span class="id" title="binder">m2</span></a> : <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.message"><span class="id" title="variable">message</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hm1:189" class="idref" href="#Hm1:189"><span class="id" title="binder">Hm1</span></a> : <a class="idref" href="CasperCBC.VLSM.Equivocation.html#trace_has_message"><span class="id" title="definition">Equivocation.trace_has_message</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.vlsm"><span class="id" title="variable">vlsm</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#output"><span class="id" title="projection">output</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m1:187"><span class="id" title="variable">m1</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#tr:185"><span class="id" title="variable">tr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="Hm2:190" class="idref" href="#Hm2:190"><span class="id" title="binder">Hm2</span></a> : <a class="idref" href="CasperCBC.VLSM.Equivocation.html#trace_has_message"><span class="id" title="definition">Equivocation.trace_has_message</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received.vlsm"><span class="id" title="variable">vlsm</span></a> <a class="idref" href="CasperCBC.VLSM.Common.html#output"><span class="id" title="projection">output</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m2:188"><span class="id" title="variable">m2</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#tr:185"><span class="id" title="variable">tr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m1:187"><span class="id" title="variable">m1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m2:188"><span class="id" title="variable">m2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.Equivocation.html#validator_message_preceeds"><span class="id" title="definition">validator_message_preceeds</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m1:187"><span class="id" title="variable">m1</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m2:188"><span class="id" title="variable">m2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">\/</span></a> <a class="idref" href="CasperCBC.CBC.FullNode.Validator.Equivocation.html#validator_message_preceeds"><span class="id" title="definition">validator_message_preceeds</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m2:188"><span class="id" title="variable">m2</span></a> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#m1:187"><span class="id" title="variable">m1</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="CasperCBC.VLSM.Equivocation.html#trace_has_message"><span class="id" title="definition">Equivocation.trace_has_message</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#Exists_exists"><span class="id" title="lemma">Exists_exists</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm1</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hm1</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">item1</span> [<span class="id" title="var">Hitem1</span> <span class="id" title="var">Hm1</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#Exists_exists"><span class="id" title="lemma">Exists_exists</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hm2</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">item2</span> [<span class="id" title="var">Hitem2</span> <span class="id" title="var">Hm2</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#in_split"><span class="id" title="lemma">in_split</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hitem1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hitem1</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">prefix1</span> [<span class="id" title="var">suffix1</span> <span class="id" title="var">Hitem1</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hitem1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hitem2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#in_app_iff"><span class="id" title="lemma">in_app_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hitem2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hitem2</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hitem2</span> | [<span class="id" title="var">Heq</span> | <span class="id" title="var">Hitem2</span>]]<br/>
    ; <span class="id" title="tactic">try</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#in_split"><span class="id" title="lemma">in_split</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hitem2</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hitem2</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">prefix2</span> [<span class="id" title="var">suffix2</span> <span class="id" title="var">Hitem2</span>]]<br/>
      ; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hitem2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hitem1</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">Hitem2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">right</span>. <span class="id" title="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/V8.12.2/stdlib//Coq.Lists.List.html#app_assoc"><span class="id" title="lemma">app_assoc</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hitem1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#VLSM_full_validator_sent_messages_comparable'"><span class="id" title="lemma">VLSM_full_validator_sent_messages_comparable'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">s</span> <span class="id" title="var">tr</span> <span class="id" title="var">Htr</span> <span class="id" title="var">prefix2</span> <span class="id" title="var">suffix2</span> <span class="id" title="var">suffix1</span> <span class="id" title="var">item2</span> <span class="id" title="var">item1</span> <span class="id" title="var">Hitem1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">m2</span> <span class="id" title="var">m1</span> <span class="id" title="var">Hm2</span> <span class="id" title="var">Hm1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">left</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hm1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hm2</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hm2</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">right</span>. <span class="id" title="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#VLSM_full_validator_sent_messages_comparable'"><span class="id" title="lemma">VLSM_full_validator_sent_messages_comparable'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">s</span> <span class="id" title="var">tr</span> <span class="id" title="var">Htr</span> <span class="id" title="var">prefix1</span> <span class="id" title="var">prefix2</span> <span class="id" title="var">suffix2</span> <span class="id" title="var">item1</span> <span class="id" title="var">item2</span> <span class="id" title="var">Hitem1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">m1</span> <span class="id" title="var">m2</span> <span class="id" title="var">Hm1</span> <span class="id" title="var">Hm2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator.proper_sent_received"><span class="id" title="section">proper_sent_received</span></a>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="CasperCBC.VLSM.FullNode.Validator.html#CompositeValidator"><span class="id" title="section">CompositeValidator</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr">coqdoc</a> and improved with <a href="https://github.com/palmskog/coqdocjs">CoqdocJS</a> as adapted for <a href="https://github.com/coq-community">coq-community</a>
</div>
</div>
</body>

</html>
