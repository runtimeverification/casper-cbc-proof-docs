
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module CasperCBC.VLSM.Equivocation</title>
<meta name="description" content="Documentation of Coq module CasperCBC.VLSM.Equivocation" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module CasperCBC.VLSM.Equivocation</h1>
<div class="coq">
<span class="id">From</span> <span class="id">Coq</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html">List</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.ListSet.html">ListSet</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.Streams.html">Streams</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.ProofIrrelevance.html">ProofIrrelevance</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Plus.html">Arith.Plus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Minus.html">Arith.Minus</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FinFun.html">FinFun</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html">Rdefinitions</a></span>.<br/>
<span class="kwd">Import</span> <span class="id">ListNotations</span>.<br/>
<br/>
<span class="id">From</span> <span class="id">CasperCBC</span> <span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id">Lib.Preamble</span> <span class="id">Lib.ListExtras</span> <span class="id">Lib.Measurable</span> <span class="id"><a href="CasperCBC.VLSM.Decisions.html">VLSM.Decisions</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html">VLSM.Common</a></span> <span class="id"><a href="CasperCBC.VLSM.Composition.html">VLSM.Composition</a></span> <span class="id"><a href="CasperCBC.VLSM.ProjectionTraces.html">VLSM.ProjectionTraces</a></span>.<br/>
<br/>
<h1> VLSM Equivocation Definitions *</h1>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="exists_proj1_sig">exists_proj1_sig</a></span> {<span class="id">A</span>:<span class="kwd">Type</span>} (<span class="id">P</span>:<span class="id">A</span> -&gt; <span class="kwd">Prop</span>) (<span class="id">a</span>:<span class="id">A</span>):<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">xP</span>:{<span class="id">x</span> | <span class="id">P</span> <span class="id">x</span>}, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">xP</span> = <span class="id">a</span>) &lt;-&gt; <span class="id">P</span> <span class="id">a</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof235')">Proof.</div>
<div class="proofscript" id="proof235">
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intros</span> [[<span class="id">x</span> <span class="id">Hx</span>] <span class="id">Heq</span>];<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Heq</span>;<span class="tactic">subst</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intro</span> <span class="id">Ha</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">a</span> <span class="id">Ha</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<h2> Basic equivocation *</h2>
<br/>
<span class="kwd">Class</span> <span class="id"><a name="ReachableThreshold">ReachableThreshold</a></span> <span class="id">V</span> `{<span class="id">Hm</span> : <span class="id">Measurable</span> <span class="id">V</span>} :=<br/>
&nbsp;&nbsp;{ <span class="id"><a name="threshold">threshold</a></span> : {<span class="id">r</span> | (<span class="id">r</span> &gt;= 0)%<span class="id">R</span>}<br/>
&nbsp;&nbsp;; <span class="id"><a name="reachable_threshold">reachable_threshold</a></span> : <span class="id">exists</span> (<span class="id">vs</span>:<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">V</span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> <span class="id">vs</span> /\ (<span class="id">sum_weights</span> <span class="id">vs</span> &gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">threshold</span>)%<span class="id">R</span><br/>
&nbsp;&nbsp;}.<br/>
<br/>
<div class="doc">Assuming a set of &lt;&lt;state&gt;&gt;s, and a set of &lt;&lt;validator&gt;&gt;s,
which is <span class="bracket"><span class="id">Measurable</span></span> and has a <span class="bracket"><span class="id">ReachableThreshold</span></span>, we can define
<span class="bracket"><span class="id">basic_equivocation</span></span> starting from a computable <span class="bracket"><span class="id">is_equivocating_fn</span></span>
deciding whether a validator is equivocating in a state.
To avoid a <span class="bracket"><span class="id">Finite</span></span> constraint on the entire set of validators, we will
assume that there is a finite set of validators for each state, which
can be retrieved through the <span class="bracket"><span class="id">state_validators</span></span> function.
This can be taken to be entire set of validators when that is finite,
or the set of senders for all messages in the state for
<span class="bracket"><span class="id">state_encapsulating_messages</span></span>.
This allows us to determine the <span class="bracket"><span class="id">equivocating_validators</span></span> for a given
state as those equivocating in that state.
The <span class="bracket"><span class="id">equivocation_fault</span></span> is determined the as the sum of weights of the
<span class="bracket"><span class="id">equivocating_validators</span></span>.
We call a state <span class="bracket"><span class="id">not_heavy</span></span> if its corresponding <span class="bracket"><span class="id">equivocation_fault</span></span>
is lower than the <span class="bracket"><span class="id">threshold</span></span> set for the &lt;&lt;validator&gt;&gt;s type.
*</div>
<br/>
<span class="kwd">Class</span> <span class="id"><a name="basic_equivocation">basic_equivocation</a></span><br/>
&nbsp;&nbsp;(<span class="id">state</span> <span class="id">validator</span> : <span class="kwd">Type</span>)<br/>
&nbsp;&nbsp;{<span class="id">measurable_V</span> : <span class="id">Measurable</span> <span class="id">validator</span>}<br/>
&nbsp;&nbsp;{<span class="id">reachable_threshold</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#ReachableThreshold">ReachableThreshold</a></span> <span class="id">validator</span>}<br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;{ <span class="id"><a name="is_equivocating">is_equivocating</a></span> (<span class="id">s</span> : <span class="id">state</span>) (<span class="id">v</span> : <span class="id">validator</span>) : <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;; <span class="id"><a name="is_equivocating_dec">is_equivocating_dec</a></span> : <span class="id">RelDecision</span> <span class="id">is_equivocating</span><br/>
<br/>
<div class="doc">retrieves a set containing all possible validators for a state. *</div>
<br/>
&nbsp;&nbsp;; <span class="id"><a name="state_validators">state_validators</a></span> (<span class="id">s</span> : <span class="id">state</span>) : <span class="tactic">set</span> <span class="id">validator</span><br/>
<br/>
&nbsp;&nbsp;; <span class="id"><a name="state_validators_nodup">state_validators_nodup</a></span> : <span class="kwd">forall</span> (<span class="id">s</span> : <span class="id">state</span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#NoDup">NoDup</a></span> (<span class="id">state_validators</span> <span class="id">s</span>)<br/>
<br/>
<div class="doc">All validators which are equivocating in a given composite state *</div>
<br/>
&nbsp;&nbsp;; <span class="id">equivocating_validators</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id">state</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">validator</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">List.filter</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="id">bool_decide</span> (<span class="id">is_equivocating</span> <span class="id">s</span> <span class="id">v</span>)) (<span class="id">state_validators</span> <span class="id">s</span>)<br/>
<br/>
<div class="doc">The equivocation fault sum: the sum of the weights of equivocating
     validators *</div>
<br/>
&nbsp;&nbsp;; <span class="id">equivocation_fault</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id">state</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#RbaseSymbolsImpl.R">R</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sum_weights</span> (<span class="id">equivocating_validators</span> <span class="id">s</span>)<br/>
<br/>
&nbsp;&nbsp;; <span class="id">not_heavy</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id">state</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= (<span class="id">equivocation_fault</span> <span class="id">s</span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#threshold">threshold</a></span>)%<span class="id">R</span><br/>
&nbsp;}.<br/>
<br/>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Simple">Simple</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">message</span> : <span class="kwd">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">vlsm</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">pre_vlsm</span> := <span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id">vlsm</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br/>
<br/>
<div class="doc">The following property detects equivocation in a given trace for a given message. *</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="equivocation_in_trace">equivocation_in_trace</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">msg</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">tr</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#vtransition_item">vtransition_item</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">prefix</span> <span class="id">suffix</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">item</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tr</span> = <span class="id">prefix</span> ++ <span class="id">item</span> :: <span class="id">suffix</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="CasperCBC.VLSM.Common.html#input">input</a></span> <span class="id">item</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">msg</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ ~ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">msg</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#output">output</a></span> <span class="id">prefix</span>).<br/>
<br/>
<div class="doc">We intend to give define several message oracles: <span class="bracket"><span class="id">has_been_sent</span></span>, <span class="bracket"><span class="id">has_not_been_sent</span></span>,
    <span class="bracket"><span class="id">has_been_received</span></span> and <span class="bracket"><span class="id">has_not_been_received</span></span>. To avoid repetition, we give
    build some generic definitions first. *</div>
<br/>
<div class="doc">General signature of a message oracle *</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="state_message_oracle">state_message_oracle</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="specialized_selected_message_exists_in_all_traces">specialized_selected_message_exists_in_all_traces</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">message_selector</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">start</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">tr</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Htr</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_init_to">finite_protocol_trace_init_to</a></span> <span class="id">X</span> <span class="id">start</span> <span class="id">s</span> <span class="id">tr</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#trace_has_message">trace_has_message</a></span> <span class="id">message_selector</span> <span class="id">m</span> <span class="id">tr</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="selected_message_exists_in_all_preloaded_traces">selected_message_exists_in_all_preloaded_traces</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#specialized_selected_message_exists_in_all_traces">specialized_selected_message_exists_in_all_traces</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="specialized_selected_message_exists_in_some_traces">specialized_selected_message_exists_in_some_traces</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">message_selector</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">start</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">tr</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Htr</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_init_to">finite_protocol_trace_init_to</a></span> <span class="id">X</span> <span class="id">start</span> <span class="id">s</span> <span class="id">tr</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#trace_has_message">trace_has_message</a></span> <span class="id">message_selector</span> <span class="id">m</span> <span class="id">tr</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="selected_message_exists_in_some_preloaded_traces">selected_message_exists_in_some_preloaded_traces</a></span>: <span class="kwd">forall</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">message_selector</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#specialized_selected_message_exists_in_some_traces">specialized_selected_message_exists_in_some_traces</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="specialized_selected_message_exists_in_no_trace">specialized_selected_message_exists_in_no_trace</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">message_selector</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">start</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">tr</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Htr</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_init_to">finite_protocol_trace_init_to</a></span> <span class="id">X</span> <span class="id">start</span> <span class="id">s</span> <span class="id">tr</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="CasperCBC.VLSM.Common.html#trace_has_message">trace_has_message</a></span> <span class="id">message_selector</span> <span class="id">m</span> <span class="id">tr</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="selected_message_exists_in_no_preloaded_trace">selected_message_exists_in_no_preloaded_trace</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#specialized_selected_message_exists_in_no_trace">specialized_selected_message_exists_in_no_trace</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="selected_message_exists_not_some_iff_no">selected_message_exists_not_some_iff_no</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">message_selector</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: ~ <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#specialized_selected_message_exists_in_some_traces">specialized_selected_message_exists_in_some_traces</a></span> <span class="id">X</span> <span class="id">message_selector</span> <span class="id">s</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#specialized_selected_message_exists_in_no_trace">specialized_selected_message_exists_in_no_trace</a></span> <span class="id">X</span> <span class="id">message_selector</span> <span class="id">s</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof236')">Proof.</div>
<div class="proofscript" id="proof236">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intro</span> <span class="id">Hnot</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">is</span> <span class="id">tr</span> <span class="id">Htr</span> <span class="id">Hsend</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hnot</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">is</span>, <span class="id">tr</span>, <span class="id">Htr</span>. <span class="tactic">exact</span> <span class="id">Hsend</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">Hno</span> [<span class="id">is</span> [<span class="id">tr</span> [<span class="id">Htr</span> <span class="id">Hsend</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> (<span class="id">Hno</span> <span class="id">is</span> <span class="id">tr</span> <span class="id">Htr</span> <span class="id">Hsend</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="selected_message_exists_preloaded_not_some_iff_no">selected_message_exists_preloaded_not_some_iff_no</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">message_selector</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: ~ <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_some_preloaded_traces">selected_message_exists_in_some_preloaded_traces</a></span> <span class="id">message_selector</span> <span class="id">s</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_no_preloaded_trace">selected_message_exists_in_no_preloaded_trace</a></span> <span class="id">message_selector</span> <span class="id">s</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof237')">Proof.</div>
<div class="proofscript" id="proof237">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_not_some_iff_no">selected_message_exists_not_some_iff_no</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">Sufficient condition for 'specialized_selected_message_exists_in_some_traces'
    </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="specialized_selected_message_exists_in_some_traces_from">specialized_selected_message_exists_in_some_traces_from</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">message_selector</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">start</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">tr</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Htr</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_from_to">finite_protocol_trace_from_to</a></span> <span class="id">X</span> <span class="id">start</span> <span class="id">s</span> <span class="id">tr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hsome</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#trace_has_message">trace_has_message</a></span> <span class="id">message_selector</span> <span class="id">m</span> <span class="id">tr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#specialized_selected_message_exists_in_some_traces">specialized_selected_message_exists_in_some_traces</a></span> <span class="id">X</span> <span class="id">message_selector</span> <span class="id">s</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof238')">Proof.</div>
<div class="proofscript" id="proof238">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id">X</span> <span class="id">start</span>) <span class="kwd">as</span> <span class="id">Hstart</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#ptrace_first_pstate">ptrace_first_pstate</a></span> <span class="kwd">in</span> <span class="id">Htr</span>; <span class="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_has_trace">protocol_state_has_trace</a></span> <span class="kwd">in</span> <span class="id">Hstart</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hstart</span> <span class="kwd">as</span> [<span class="id">is</span> [<span class="id">tr</span>' <span class="id">Htr</span>']].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_init_to">finite_protocol_trace_init_to</a></span> <span class="id">X</span> <span class="id">is</span> <span class="id">s</span> (<span class="id">tr</span>'++<span class="id">tr</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htr</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_from_to_app">finite_protocol_trace_from_to_app</a></span> <span class="kwd">with</span> <span class="id">start</span>|];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">_</span>, <span class="id">_</span>, <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_app">Exists_app</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="selected_messages_consistency_prop">selected_messages_consistency_prop</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">message_selector</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_some_preloaded_traces">selected_message_exists_in_some_preloaded_traces</a></span> <span class="id">message_selector</span> <span class="id">s</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_all_preloaded_traces">selected_message_exists_in_all_preloaded_traces</a></span> <span class="id">message_selector</span> <span class="id">s</span> <span class="id">m</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="selected_message_exists_in_all_traces_initial_state">selected_message_exists_in_all_traces_initial_state</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vinitial_state_prop">vinitial_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">message_selector</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: ~ <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_all_preloaded_traces">selected_message_exists_in_all_preloaded_traces</a></span> <span class="id">message_selector</span> <span class="id">s</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof239')">Proof.</div>
<div class="proofscript" id="proof239">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">Hselected</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hps</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#initial_is_protocol">initial_is_protocol</a></span>;<span class="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Htr</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_init_to">finite_protocol_trace_init_to</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span> <span class="id">s</span> <span class="id">s</span> []).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">split</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>. <span class="id">constructor</span>. <span class="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hselected</span> <span class="id">s</span> [] <span class="id">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#trace_has_message">trace_has_message</a></span> <span class="kwd">in</span> <span class="id">Hselected</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_nil">Exists_nil</a></span> <span class="kwd">in</span> <span class="id">Hselected</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">Checks if all <span class="bracket"><span class="id">protocol_trace</span></span>s leading to a certain state contain a certain message.
    The <span class="bracket"><span class="id">message_selector</span></span> argument specifices whether we're looking for received or sent
    messages.
    Notably, the <span class="bracket"><span class="id">protocol_trace</span></span>s over which we are iterating belong to the preloaded
    version of the target VLSM. This is because we want VLSMs to have oracles which
    are valid irrespective of the composition they take part in. As we know,
    the behaviour preloaded VLSMs includes behaviours of its projections in any
    composition. *</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="all_traces_have_message_prop">all_traces_have_message_prop</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">message_selector</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">oracle</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_message_oracle">state_message_oracle</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">oracle</span> <span class="id">s</span> <span class="id">m</span> &lt;-&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_all_preloaded_traces">selected_message_exists_in_all_preloaded_traces</a></span> <span class="id">message_selector</span> <span class="id">s</span> <span class="id">m</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="no_traces_have_message_prop">no_traces_have_message_prop</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">message_selector</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">oracle</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_message_oracle">state_message_oracle</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">oracle</span> <span class="id">s</span> <span class="id">m</span> &lt;-&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_no_preloaded_trace">selected_message_exists_in_no_preloaded_trace</a></span> <span class="id">message_selector</span> <span class="id">s</span> <span class="id">m</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="has_been_sent_prop">has_been_sent_prop</a></span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_message_oracle">state_message_oracle</a></span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span> -&gt; <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#all_traces_have_message_prop">all_traces_have_message_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#field_selector">field_selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#output">output</a></span>)).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="has_not_been_sent_prop">has_not_been_sent_prop</a></span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_message_oracle">state_message_oracle</a></span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span> -&gt; <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_traces_have_message_prop">no_traces_have_message_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#field_selector">field_selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#output">output</a></span>)).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="has_been_received_prop">has_been_received_prop</a></span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_message_oracle">state_message_oracle</a></span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span> -&gt; <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#all_traces_have_message_prop">all_traces_have_message_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#field_selector">field_selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#input">input</a></span>)).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="has_not_been_received_prop">has_not_been_received_prop</a></span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_message_oracle">state_message_oracle</a></span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span> -&gt; <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_traces_have_message_prop">no_traces_have_message_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#field_selector">field_selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#input">input</a></span>)).<br/>
<br/>
<div class="doc">Per the vocabulary of the official VLSM document, we say that VLSMs endowed
    with a <span class="bracket"><span class="id">state_message_oracle</span></span> for sent messages have the <span class="bracket"><span class="id">has_been_sent</span></span> capability.
    Capabilities for receiving messages are treated analogously, so we omit mentioning
    them explicitly.
    Notably, we also define the <span class="bracket"><span class="id">has_not_been_sent</span></span> oracle, which decides if a message
    has definitely not been sent, on any of the traces producing a current state.
    Furthermore, we require a <span class="bracket"><span class="id">sent_excluded_middle</span></span> property, which stipulates
    that any argument to the oracle should return true in exactly one of
    <span class="bracket"><span class="id">has_been_sent</span></span> and <span class="bracket"><span class="id">has_not_been_sent</span></span>. *</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Class</span> <span class="id"><a name="has_been_sent_capability">has_been_sent_capability</a></span> := {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="has_been_sent">has_been_sent</a></span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_message_oracle">state_message_oracle</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="has_been_sent_dec">has_been_sent_dec</a></span> :&gt; <span class="id">RelDecision</span> <span class="id">has_been_sent</span>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="proper_sent">proper_sent</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_prop">has_been_sent_prop</a></span> <span class="id">has_been_sent</span> <span class="id">s</span> <span class="id">m</span>);<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">has_not_been_sent</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_message_oracle">state_message_oracle</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">fun</span> (<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>) (<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>) =&gt; ~ <span class="id">has_been_sent</span> <span class="id">s</span> <span class="id">m</span>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="proper_not_sent">proper_not_sent</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_not_been_sent_prop">has_not_been_sent_prop</a></span> <span class="id">has_not_been_sent</span> <span class="id">s</span> <span class="id">m</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
<br/>
<div class="doc">Reverse implication for 'selected_messages_consistency_prop'
    always holds. </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="consistency_from_protocol_proj2">consistency_from_protocol_proj2</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">selector</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hall</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_all_preloaded_traces">selected_message_exists_in_all_preloaded_traces</a></span> <span class="id">selector</span> <span class="id">s</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_some_preloaded_traces">selected_message_exists_in_some_preloaded_traces</a></span> <span class="id">selector</span> <span class="id">s</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof240')">Proof.</div>
<div class="proofscript" id="proof240">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_has_trace">protocol_state_has_trace</a></span> <span class="kwd">in</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hs</span> <span class="kwd">as</span> [<span class="id">is</span> [<span class="id">tr</span> <span class="id">Htr</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">_</span>, <span class="id">_</span>, <span class="id">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">Hall</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="has_been_sent_consistency">has_been_sent_consistency</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">Hbs</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_capability">has_been_sent_capability</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_messages_consistency_prop">selected_messages_consistency_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#field_selector">field_selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#output">output</a></span>) <span class="id">s</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof241')">Proof.</div>
<div class="proofscript" id="proof241">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intro</span> <span class="id">Hsome</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">decide</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent">has_been_sent</a></span> <span class="id">s</span> <span class="id">m</span>)) <span class="kwd">as</span> [<span class="id">Hsm</span>|<span class="id">Hsm</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_sent">proper_sent</a></span> <span class="kwd">in</span> <span class="id">Hsm</span>;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_not_sent">proper_not_sent</a></span> <span class="kwd">in</span> <span class="id">Hsm</span>;[|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hsome</span> <span class="kwd">as</span> [<span class="id">is</span> [<span class="id">tr</span> [<span class="id">Htr</span> <span class="id">Hmsg</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id">Hsm</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#consistency_from_protocol_proj2">consistency_from_protocol_proj2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">Sufficent condition for 'proper_sent' avoiding the
    'pre_loaded_with_all_messages_vlsm'
    </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="specialized_proper_sent">specialized_proper_sent</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">Hbs</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_capability">has_been_sent_capability</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hsome</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#specialized_selected_message_exists_in_some_traces">specialized_selected_message_exists_in_some_traces</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#field_selector">field_selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#output">output</a></span>) <span class="id">s</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent">has_been_sent</a></span> <span class="id">s</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof242')">Proof.</div>
<div class="proofscript" id="proof242">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hs</span> <span class="kwd">as</span> [<span class="id">_om</span> <span class="id">Hs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hpres</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span> <span class="id">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exists</span> <span class="id">_om</span>. <span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_protocol_prop">pre_loaded_with_all_messages_protocol_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span>). <span class="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_sent">proper_sent</a></span>; [<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_consistency">has_been_sent_consistency</a></span> <span class="id">s</span> <span class="id">Hpres</span> <span class="id">m</span>) <span class="kwd">as</span> <span class="id">Hcons</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hcons</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hsome</span> <span class="kwd">as</span> [<span class="id">is</span> [<span class="id">tr</span> [<span class="id">Htr</span> <span class="id">Hsome</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">is</span>, <span class="id">tr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#pre_vlsm">pre_vlsm</a></span>;<span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span> <span class="kwd">as</span> (<span class="id">T</span>,(<span class="id">S</span>,<span class="id">M</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM_incl_finite_protocol_trace_init_to">VLSM_incl_finite_protocol_trace_init_to</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#vlsm_incl_pre_loaded_with_all_messages_vlsm">vlsm_incl_pre_loaded_with_all_messages_vlsm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">'proper_sent' condition specialized to regular vlsm traces
    (avoiding 'pre_loaded_with_all_messages_vlsm')
    </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="specialized_proper_sent_rev">specialized_proper_sent_rev</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">Hbs</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_capability">has_been_sent_capability</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hsm</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent">has_been_sent</a></span> <span class="id">s</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#specialized_selected_message_exists_in_all_traces">specialized_selected_message_exists_in_all_traces</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#field_selector">field_selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#output">output</a></span>) <span class="id">s</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof243')">Proof.</div>
<div class="proofscript" id="proof243">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hs</span> <span class="kwd">as</span> [<span class="id">_om</span> <span class="id">Hs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hpres</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span> <span class="id">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exists</span> <span class="id">_om</span>. <span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_protocol_prop">pre_loaded_with_all_messages_protocol_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span>). <span class="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_sent">proper_sent</a></span> <span class="kwd">in</span> <span class="id">Hsm</span>; [|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">is</span> <span class="id">tr</span> <span class="id">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hsm</span> <span class="id">is</span> <span class="id">tr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">spec</span> <span class="id">Hsm</span>;[|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#pre_vlsm">pre_vlsm</a></span>;<span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span> <span class="kwd">as</span> (<span class="id">T</span>,(<span class="id">S</span>,<span class="id">M</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM_incl_finite_protocol_trace_init_to">VLSM_incl_finite_protocol_trace_init_to</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#vlsm_incl_pre_loaded_with_all_messages_vlsm">vlsm_incl_pre_loaded_with_all_messages_vlsm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="has_been_sent_consistency_proper_not_sent">has_been_sent_consistency_proper_not_sent</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_been_sent</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_message_oracle">state_message_oracle</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_been_sent_dec</span>: <span class="id">RelDecision</span> <span class="id">has_been_sent</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">proper_sent</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_prop">has_been_sent_prop</a></span> <span class="id">has_been_sent</span> <span class="id">s</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_not_been_sent</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">fun</span> (<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>) (<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>) =&gt; ~ <span class="id">has_been_sent</span> <span class="id">s</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hconsistency</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_messages_consistency_prop">selected_messages_consistency_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#field_selector">field_selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#output">output</a></span>) <span class="id">s</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_not_been_sent_prop">has_not_been_sent_prop</a></span> <span class="id">has_not_been_sent</span> <span class="id">s</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof244')">Proof.</div>
<div class="proofscript" id="proof244">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_not_been_sent_prop">has_not_been_sent_prop</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_traces_have_message_prop">no_traces_have_message_prop</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_not_been_sent">has_not_been_sent</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_preloaded_not_some_iff_no">selected_message_exists_preloaded_not_some_iff_no</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#not_iff_compat">not_iff_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#iff_trans">iff_trans</a></span> <span class="id">proper_sent</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>;<span class="tactic">exact</span> <span class="id">Hconsistency</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">It is now straightforward to define a <span class="bracket"><span class="id">no_equivocations</span></span> composition constraint.
      An equivocating transition can be detected by calling the <span class="bracket"><span class="id">has_been_sent</span></span>
      oracle on its arguments and we simply forbid them.
      However, since we might allow certain other messages, such as initial
      messages, we give a slightly more general definition, that of
      <span class="bracket"><span class="id">no_equivocation_except_from</span></span> those specified by a given predicate.
  *</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="no_equivocations_except_from">no_equivocations_except_from</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">Hbs</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_capability">has_been_sent_capability</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exception</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vlabel">vlabel</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">som</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">s</span>, <span class="id">om</span>) := <span class="id">som</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">om</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span> =&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent">has_been_sent</a></span> <span class="id">s</span> <span class="id">m</span> \/ <span class="id">exception</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">The <span class="bracket"><span class="id">no_equivocations</span></span> constraint only allows initial messages
    as exceptions (messages being received without being previously sent).
    </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="no_equivocations">no_equivocations</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">Hbs</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_capability">has_been_sent_capability</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vlabel">vlabel</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">som</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_equivocations_except_from">no_equivocations_except_from</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#vinitial_message_prop">vinitial_message_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span>) <span class="id">l</span> <span class="id">som</span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Class</span> <span class="id"><a name="has_been_received_capability">has_been_received_capability</a></span> := {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="has_been_received">has_been_received</a></span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_message_oracle">state_message_oracle</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="has_been_received_dec">has_been_received_dec</a></span> :&gt; <span class="id">RelDecision</span> <span class="id">has_been_received</span>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="proper_received">proper_received</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_prop">has_been_received_prop</a></span> <span class="id">has_been_received</span> <span class="id">s</span> <span class="id">m</span>);<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">has_not_been_received</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_message_oracle">state_message_oracle</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">fun</span> (<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>) (<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>) =&gt; ~ <span class="id">has_been_received</span> <span class="id">s</span> <span class="id">m</span>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="proper_not_received">proper_not_received</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_not_been_received_prop">has_not_been_received_prop</a></span> <span class="id">has_not_been_received</span> <span class="id">s</span> <span class="id">m</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="has_been_received_consistency">has_been_received_consistency</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">Hbs</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_capability">has_been_received_capability</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_messages_consistency_prop">selected_messages_consistency_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#field_selector">field_selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#input">input</a></span>) <span class="id">s</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof245')">Proof.</div>
<div class="proofscript" id="proof245">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intro</span> <span class="id">Hsome</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">decide</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received">has_been_received</a></span> <span class="id">s</span> <span class="id">m</span>)) <span class="kwd">as</span> [<span class="id">Hsm</span>|<span class="id">Hsm</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_received">proper_received</a></span> <span class="kwd">in</span> <span class="id">Hsm</span>;<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_not_received">proper_not_received</a></span> <span class="kwd">in</span> <span class="id">Hsm</span>;[|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hsome</span> <span class="kwd">as</span> [<span class="id">is</span> [<span class="id">tr</span> [<span class="id">Htr</span> <span class="id">Hsome</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id">Hsm</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#consistency_from_protocol_proj2">consistency_from_protocol_proj2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="has_been_received_consistency_proper_not_received">has_been_received_consistency_proper_not_received</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_been_received</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_message_oracle">state_message_oracle</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_been_received_dec</span>: <span class="id">RelDecision</span> <span class="id">has_been_received</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">proper_received</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_prop">has_been_received_prop</a></span> <span class="id">has_been_received</span> <span class="id">s</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_not_been_received</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="kwd">fun</span> (<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>) (<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>) =&gt; ~ <span class="id">has_been_received</span> <span class="id">s</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hconsistency</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_messages_consistency_prop">selected_messages_consistency_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#field_selector">field_selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#input">input</a></span>) <span class="id">s</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_not_been_received_prop">has_not_been_received_prop</a></span> <span class="id">has_not_been_received</span> <span class="id">s</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof246')">Proof.</div>
<div class="proofscript" id="proof246">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_not_been_received_prop">has_not_been_received_prop</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_traces_have_message_prop">no_traces_have_message_prop</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_not_been_received">has_not_been_received</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">Hsm</span> <span class="id">is</span> <span class="id">tr</span> <span class="id">Htr</span> <span class="id">Hsome</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hsm</span>' : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_some_preloaded_traces">selected_message_exists_in_some_preloaded_traces</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#field_selector">field_selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#input">input</a></span>) <span class="id">s</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="id">exists</span> <span class="id">is</span>; <span class="id">exists</span> <span class="id">tr</span>; <span class="id">exists</span> <span class="id">Htr</span>; <span class="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hconsistency</span> <span class="kwd">in</span> <span class="id">Hsm</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">proper_received</span> <span class="kwd">in</span> <span class="id">Hsm</span>'. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intro</span> <span class="id">Hnone</span>. <span class="tactic">destruct</span> (<span class="id">decide</span> (<span class="id">has_been_received</span> <span class="id">s</span> <span class="id">m</span>)) <span class="kwd">as</span> [<span class="id">Hsm</span>|<span class="id">Hsm</span>];[|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">proper_received</span> <span class="kwd">in</span> <span class="id">Hsm</span>. <span class="tactic">apply</span> <span class="id">Hconsistency</span> <span class="kwd">in</span> <span class="id">Hsm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hsm</span> <span class="kwd">as</span> [<span class="id">is</span> [<span class="id">tr</span> [<span class="id">Htr</span> <span class="id">Hsm</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id">Hnone</span> <span class="id">is</span> <span class="id">tr</span> <span class="id">Htr</span>). <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="sent_messages">sent_messages</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Type</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#sig">sig</a></span> (<span class="kwd">fun</span> <span class="id">m</span> =&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_some_preloaded_traces">selected_message_exists_in_some_preloaded_traces</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#field_selector">field_selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#output">output</a></span>) <span class="id">s</span> <span class="id">m</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="sent_messages_proper">sent_messages_proper</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hhbs</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_capability">has_been_sent_capability</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent">has_been_sent</a></span> <span class="id">s</span> <span class="id">m</span> &lt;-&gt; <span class="id">exists</span> (<span class="id">m</span>' : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_messages">sent_messages</a></span> <span class="id">s</span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">m</span>' = <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof247')">Proof.</div>
<div class="proofscript" id="proof247">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_messages">sent_messages</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#exists_proj1_sig">exists_proj1_sig</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_sent">proper_sent</a></span> <span class="id">s</span> <span class="id">Hs</span> <span class="id">m</span>) <span class="kwd">as</span> <span class="id">Hbs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_prop">has_been_sent_prop</a></span>,<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#all_traces_have_message_prop">all_traces_have_message_prop</a></span> <span class="kwd">in</span> <span class="id">Hbs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hbs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_consistency">has_been_sent_consistency</a></span> <span class="id">s</span> <span class="id">Hs</span> <span class="id">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="received_messages">received_messages</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Type</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#sig">sig</a></span> (<span class="kwd">fun</span> <span class="id">m</span> =&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_some_preloaded_traces">selected_message_exists_in_some_preloaded_traces</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#field_selector">field_selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#input">input</a></span>) <span class="id">s</span> <span class="id">m</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="received_messages_proper">received_messages_proper</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hhbs</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_capability">has_been_received_capability</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received">has_been_received</a></span> <span class="id">s</span> <span class="id">m</span> &lt;-&gt; <span class="id">exists</span> (<span class="id">m</span>' : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#received_messages">received_messages</a></span> <span class="id">s</span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">m</span>' = <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof248')">Proof.</div>
<div class="proofscript" id="proof248">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#received_messages">received_messages</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#exists_proj1_sig">exists_proj1_sig</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_received">proper_received</a></span> <span class="id">s</span> <span class="id">Hs</span> <span class="id">m</span>) <span class="kwd">as</span> <span class="id">Hbs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_prop">has_been_received_prop</a></span>,<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#all_traces_have_message_prop">all_traces_have_message_prop</a></span> <span class="kwd">in</span> <span class="id">Hbs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hbs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_consistency">has_been_received_consistency</a></span> <span class="id">s</span> <span class="id">Hs</span> <span class="id">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Class</span> <span class="id"><a name="computable_sent_messages">computable_sent_messages</a></span> := {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="sent_messages_fn">sent_messages_fn</a></span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="sent_messages_full">sent_messages_full</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span>) (<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span> <span class="id">s</span>) (<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">m</span> (<span class="id">sent_messages_fn</span> <span class="id">s</span>) &lt;-&gt; <span class="id">exists</span> (<span class="id">sm</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_messages">sent_messages</a></span> <span class="id">s</span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">sm</span> = <span class="id">m</span>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="sent_messages_consistency">sent_messages_consistency</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_messages_consistency_prop">selected_messages_consistency_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#field_selector">field_selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#output">output</a></span>) <span class="id">s</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="computable_sent_messages_initial_state_empty">computable_sent_messages_initial_state_empty</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">Hrm</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_sent_messages">computable_sent_messages</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vinitial_state">vinitial_state</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_messages_fn">sent_messages_fn</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">s</span>) = [].<br/>
<div class="toggleproof" onclick="toggleDisplay('proof249')">Proof.</div>
<div class="proofscript" id="proof249">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hps</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">s</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#initial_is_protocol">initial_is_protocol</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj2_sig">proj2_sig</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">s</span> <span class="kwd">as</span> [<span class="id">s</span> <span class="id">Hs</span>]. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_messages_fn">sent_messages_fn</a></span> <span class="id">s</span>) <span class="kwd">as</span> [|<span class="id">m</span> <span class="id">l</span>] <span class="id">eqn</span>:<span class="id">Hsm</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_messages_full">sent_messages_full</a></span> <span class="id">s</span> <span class="id">Hps</span> <span class="id">m</span>) <span class="kwd">as</span> <span class="id">Hl</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="kwd">in</span> <span class="id">Hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">spec</span> <span class="id">Hl</span>; <span class="tactic">try</span> (<span class="tactic">rewrite</span> <span class="id">Hsm</span>; <span class="id">left</span>; <span class="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hl</span> <span class="kwd">as</span> [[<span class="id">m0</span> <span class="id">Hm</span>] <span class="id">Heq</span>]. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="tactic">subst</span> <span class="id">m0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_messages_consistency">sent_messages_consistency</a></span> <span class="kwd">in</span> <span class="id">Hm</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="id">revert</span> <span class="id">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_all_traces_initial_state">selected_message_exists_in_all_traces_initial_state</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="computable_sent_messages_has_been_sent">computable_sent_messages_has_been_sent</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">Hsm</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_sent_messages">computable_sent_messages</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">m</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_messages_fn">sent_messages_fn</a></span> <span class="id">s</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="computable_sent_message_has_been_sent_dec">computable_sent_message_has_been_sent_dec</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">Hsm</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_sent_messages">computable_sent_messages</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">eq_message</span>: <span class="id">EqDecision</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id">RelDecision</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_sent_messages_has_been_sent">computable_sent_messages_has_been_sent</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span> <span class="id">decide_eq</span> <span class="id">m</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_messages_fn">sent_messages_fn</a></span> <span class="id">s</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="computable_sent_messages_has_been_sent_proper">computable_sent_messages_has_been_sent_proper</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">Hsm</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_sent_messages">computable_sent_messages</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_prop">has_been_sent_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_sent_messages_has_been_sent">computable_sent_messages_has_been_sent</a></span> <span class="id">s</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof250')">Proof.</div>
<div class="proofscript" id="proof250">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_prop">has_been_sent_prop</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#all_traces_have_message_prop">all_traces_have_message_prop</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_sent_messages_has_been_sent">computable_sent_messages_has_been_sent</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intro</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_messages_full">sent_messages_full</a></span> <span class="kwd">in</span> <span class="id">Hin</span>;[|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [[<span class="id">m0</span> <span class="id">Hm0</span>] <span class="id">Hx</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hx</span>. <span class="tactic">subst</span> <span class="id">m0</span>. <span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_messages_consistency">sent_messages_consistency</a></span> <span class="id">s</span> <span class="id">Hs</span> <span class="id">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intro</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_messages_consistency">sent_messages_consistency</a></span> <span class="id">s</span> <span class="id">Hs</span> <span class="id">m</span>) <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_messages_full">sent_messages_full</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">m</span> <span class="id">H</span>). <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="computable_sent_messages_has_not_been_sent">computable_sent_messages_has_not_been_sent</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">Hsm</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_sent_messages">computable_sent_messages</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_sent_messages_has_been_sent">computable_sent_messages_has_been_sent</a></span> <span class="id">s</span> <span class="id">m</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="computable_sent_messages_has_not_been_sent_proper">computable_sent_messages_has_not_been_sent_proper</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">Hsm</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_sent_messages">computable_sent_messages</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_not_been_sent_prop">has_not_been_sent_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_sent_messages_has_not_been_sent">computable_sent_messages_has_not_been_sent</a></span> <span class="id">s</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof251')">Proof.</div>
<div class="proofscript" id="proof251">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_not_been_sent_prop">has_not_been_sent_prop</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_traces_have_message_prop">no_traces_have_message_prop</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_sent_messages_has_not_been_sent">computable_sent_messages_has_not_been_sent</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_sent_messages_has_been_sent">computable_sent_messages_has_been_sent</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intro</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">cut</span> (~ <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_some_preloaded_traces">selected_message_exists_in_some_preloaded_traces</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#field_selector">field_selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#output">output</a></span>) <span class="id">s</span> <span class="id">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span> <span class="id">Hno</span> <span class="id">is</span> <span class="id">tr</span> <span class="id">Htr</span> <span class="id">Hexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">Hno</span>;<span class="id">exists</span> <span class="id">is</span>, <span class="id">tr</span>, <span class="id">Htr</span>;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_messages_full">sent_messages_full</a></span>;[<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">m</span> <span class="id">Hin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">Htrace</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_messages_full">sent_messages_full</a></span> <span class="kwd">in</span> <span class="id">Hin</span>;[|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [[<span class="id">m0</span> <span class="id">Hm</span>] <span class="id">Heq</span>];<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Heq</span>;<span class="tactic">subst</span> <span class="id">m0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hm</span> <span class="kwd">as</span> [<span class="id">is</span> [<span class="id">tr</span> [<span class="id">Htr</span> <span class="id">Hex</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">Htrace</span> <span class="id">is</span> <span class="id">tr</span> <span class="id">Htr</span> <span class="id">Hex</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="computable_sent_messages_has_been_sent_capability">computable_sent_messages_has_been_sent_capability</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">Hsm</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_sent_messages">computable_sent_messages</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">eq_message</span> : <span class="id">EqDecision</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_capability">has_been_sent_capability</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent">has_been_sent</a></span> := <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_sent_messages_has_been_sent">computable_sent_messages_has_been_sent</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_sent">proper_sent</a></span> := <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_sent_messages_has_been_sent_proper">computable_sent_messages_has_been_sent_proper</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_not_sent">proper_not_sent</a></span> := <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_sent_messages_has_not_been_sent_proper">computable_sent_messages_has_not_been_sent_proper</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Class</span> <span class="id"><a name="computable_received_messages">computable_received_messages</a></span> := {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="received_messages_fn">received_messages_fn</a></span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="received_messages_full">received_messages_full</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span>) (<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span> <span class="id">s</span>) (<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">m</span> (<span class="id">received_messages_fn</span> <span class="id">s</span>) &lt;-&gt; <span class="id">exists</span> (<span class="id">sm</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#received_messages">received_messages</a></span> <span class="id">s</span>), <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">sm</span> = <span class="id">m</span>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="received_messages_consistency">received_messages_consistency</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_messages_consistency_prop">selected_messages_consistency_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#field_selector">field_selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#input">input</a></span>) <span class="id">s</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="computable_received_messages_initial_state_empty">computable_received_messages_initial_state_empty</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">Hrm</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_received_messages">computable_received_messages</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vinitial_state">vinitial_state</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#received_messages_fn">received_messages_fn</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">s</span>) = [].<br/>
<div class="toggleproof" onclick="toggleDisplay('proof252')">Proof.</div>
<div class="proofscript" id="proof252">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hps</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">s</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#initial_is_protocol">initial_is_protocol</a></span>;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj2_sig">proj2_sig</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">s</span> <span class="kwd">as</span> [<span class="id">s</span> <span class="id">Hs</span>]. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#received_messages_fn">received_messages_fn</a></span> <span class="id">s</span>) <span class="kwd">as</span> [|<span class="id">m</span> <span class="id">l</span>] <span class="id">eqn</span>:<span class="id">Hrcv</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#received_messages_full">received_messages_full</a></span> <span class="id">s</span> <span class="id">Hps</span> <span class="id">m</span>) <span class="kwd">as</span> <span class="id">Hl</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="kwd">in</span> <span class="id">Hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">spec</span> <span class="id">Hl</span>; <span class="tactic">try</span> (<span class="tactic">rewrite</span> <span class="id">Hrcv</span>; <span class="id">left</span>; <span class="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hl</span> <span class="kwd">as</span> [[<span class="id">m0</span> <span class="id">Hm</span>] <span class="id">Heq</span>]. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Heq</span>. <span class="tactic">subst</span> <span class="id">m0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#received_messages_consistency">received_messages_consistency</a></span> <span class="kwd">in</span> <span class="id">Hm</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exfalso</span>. <span class="id">revert</span> <span class="id">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_in_all_traces_initial_state">selected_message_exists_in_all_traces_initial_state</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="computable_received_messages_has_been_received">computable_received_messages_has_been_received</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">Hsm</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_received_messages">computable_received_messages</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">m</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#received_messages_fn">received_messages_fn</a></span> <span class="id">s</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="computable_received_messages_has_been_received_dec">computable_received_messages_has_been_received_dec</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">Hsm</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_received_messages">computable_received_messages</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">eq_message</span> : <span class="id">EqDecision</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id">RelDecision</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_received_messages_has_been_received">computable_received_messages_has_been_received</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span> <span class="id">decide_eq</span> <span class="id">m</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#received_messages_fn">received_messages_fn</a></span> <span class="id">s</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="computable_received_messages_has_been_received_proper">computable_received_messages_has_been_received_proper</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">Hsm</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_received_messages">computable_received_messages</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_prop">has_been_received_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_received_messages_has_been_received">computable_received_messages_has_been_received</a></span> <span class="id">s</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof253')">Proof.</div>
<div class="proofscript" id="proof253">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_prop">has_been_received_prop</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#all_traces_have_message_prop">all_traces_have_message_prop</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_received_messages_has_been_received">computable_received_messages_has_been_received</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intro</span> <span class="id">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#received_messages_full">received_messages_full</a></span> <span class="kwd">in</span> <span class="id">Hin</span>;[|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hin</span> <span class="kwd">as</span> [[<span class="id">m0</span> <span class="id">Hm</span>] <span class="id">Heq</span>];<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Heq</span>;<span class="tactic">subst</span> <span class="id">m0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#received_messages_consistency">received_messages_consistency</a></span>;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intro</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#received_messages_full">received_messages_full</a></span>;[<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#received_messages_consistency">received_messages_consistency</a></span> <span class="id">s</span> <span class="id">Hs</span> <span class="id">m</span>) <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">m</span> <span class="id">H</span>). <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="computable_received_messages_has_not_been_received">computable_received_messages_has_not_been_received</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">Hsm</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_received_messages">computable_received_messages</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.vlsm">vlsm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~ <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_received_messages_has_been_received">computable_received_messages_has_been_received</a></span> <span class="id">s</span> <span class="id">m</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="computable_received_messages_has_not_been_received_proper">computable_received_messages_has_not_been_received_proper</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">Hsm</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_received_messages">computable_received_messages</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.pre_vlsm">pre_vlsm</a></span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_not_been_received_prop">has_not_been_received_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_received_messages_has_not_been_received">computable_received_messages_has_not_been_received</a></span> <span class="id">s</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof254')">Proof.</div>
<div class="proofscript" id="proof254">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_not_been_received_prop">has_not_been_received_prop</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_traces_have_message_prop">no_traces_have_message_prop</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_received_messages_has_not_been_received">computable_received_messages_has_not_been_received</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_received_messages_has_been_received">computable_received_messages_has_been_received</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_preloaded_not_some_iff_no">selected_message_exists_preloaded_not_some_iff_no</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#not_iff_compat">not_iff_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#received_messages_full">received_messages_full</a></span>;[|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#received_messages">received_messages</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#exists_proj1_sig">exists_proj1_sig</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="computable_received_messages_has_been_received_capability">computable_received_messages_has_been_received_capability</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">Hsm</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_received_messages">computable_received_messages</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">eq_message</span> : <span class="id">EqDecision</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple.message">message</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_capability">has_been_received_capability</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received">has_been_received</a></span> := <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_received_messages_has_been_received">computable_received_messages_has_been_received</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_received">proper_received</a></span> := <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_received_messages_has_been_received_proper">computable_received_messages_has_been_received_proper</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_not_received">proper_not_received</a></span> := <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#computable_received_messages_has_not_been_received_proper">computable_received_messages_has_not_been_received_proper</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}.<br/>
<span class="kwd">End</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Simple">Simple</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="oracle_stepwise_props">oracle_stepwise_props</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">message</span>] [<span class="id">vlsm</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">message_selector</span>: <span class="id">message</span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">oracle</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_message_oracle">state_message_oracle</a></span> <span class="id">vlsm</span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;{<span class="id"><a name="oracle_no_inits">oracle_no_inits</a></span>: <span class="kwd">forall</span> (<span class="id">s</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id">vlsm</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#initial_state_prop">initial_state_prop</a></span> (<span class="id">VLSM_sign</span>:=<span class="id"><a href="CasperCBC.VLSM.Common.html#sign">sign</a></span> <span class="id">vlsm</span>) <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span>, ~<span class="id">oracle</span> <span class="id">s</span> <span class="id">m</span>;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a name="oracle_step_update">oracle_step_update</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">s</span> <span class="id">im</span> <span class="id">s</span>' <span class="id">om</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_transition">protocol_transition</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id">vlsm</span>) <span class="id">l</span> (<span class="id">s</span>,<span class="id">im</span>) (<span class="id">s</span>',<span class="id">om</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">msg</span>, <span class="id">oracle</span> <span class="id">s</span>' <span class="id">msg</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">message_selector</span> <span class="id">msg</span> {|<span class="id"><a href="CasperCBC.VLSM.Common.html#l">l</a></span>:=<span class="id">l</span>; <span class="id"><a href="CasperCBC.VLSM.Common.html#input">input</a></span>:=<span class="id">im</span>; <span class="id"><a href="CasperCBC.VLSM.Common.html#destination">destination</a></span>:=<span class="id">s</span>'; <span class="id"><a href="CasperCBC.VLSM.Common.html#output">output</a></span>:=<span class="id">om</span>|}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ <span class="id">oracle</span> <span class="id">s</span> <span class="id">msg</span>)<br/>
&nbsp;&nbsp;}.<br/>
<span class="id">Arguments</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_no_inits">oracle_no_inits</a></span> {<span class="id">message</span>} {<span class="id">vlsm</span>} {<span class="id">message_selector</span>} {<span class="id">oracle</span>} <span class="id">_</span>.<br/>
<span class="id">Arguments</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_step_update">oracle_step_update</a></span> {<span class="id">message</span>} {<span class="id">vlsm</span>} {<span class="id">message_selector</span>} {<span class="id">oracle</span>} <span class="id">_</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="oracle_partial_trace_update">oracle_partial_trace_update</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">message</span>] [<span class="id">vlsm</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">selector</span>: <span class="id">message</span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span> -&gt; <span class="kwd">Prop</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">oracle</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_message_oracle">state_message_oracle</a></span> <span class="id">vlsm</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Horacle</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_stepwise_props">oracle_stepwise_props</a></span> <span class="id">selector</span> <span class="id">oracle</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s0</span> <span class="id">s</span> <span class="id">tr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Htr</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_from_to">finite_protocol_trace_from_to</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id">vlsm</span>) <span class="id">s0</span> <span class="id">s</span> <span class="id">tr</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">oracle</span> <span class="id">s</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt; (<span class="id"><a href="CasperCBC.VLSM.Common.html#trace_has_message">trace_has_message</a></span> <span class="id">selector</span> <span class="id">m</span> <span class="id">tr</span> \/ <span class="id">oracle</span> <span class="id">s0</span> <span class="id">m</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof255')">Proof.</div>
<div class="proofscript" id="proof255">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Htr</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intro</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#trace_has_message">trace_has_message</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_nil">Exists_nil</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intro</span> <span class="id">m</span>. <span class="id">specialize</span> (<span class="id">IHHtr</span> <span class="id">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#trace_has_message">trace_has_message</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_cons">Exists_cons</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">Horacle</span>.(<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_step_update">oracle_step_update</a></span>)) <span class="kwd">with</span> (<span class="id">msg</span>:=<span class="id">m</span>) <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="TraceFromStepwise">TraceFromStepwise</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">message</span> : <span class="kwd">Type</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">vlsm</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">selector</span> : <span class="id">message</span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">oracle</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_message_oracle">state_message_oracle</a></span> <span class="id">vlsm</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">oracle_props</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_stepwise_props">oracle_stepwise_props</a></span> <span class="id">selector</span> <span class="id">oracle</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Local</span> <span class="kwd">Lemma</span> <span class="id"><a name="H_protocol_trace_prop">H_protocol_trace_prop</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">s0</span> <span class="id">s</span> <span class="id">tr</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Htr</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_init_to">finite_protocol_trace_init_to</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#TraceFromStepwise.vlsm">vlsm</a></span>) <span class="id">s0</span> <span class="id">s</span> <span class="id">tr</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#TraceFromStepwise.oracle">oracle</a></span> <span class="id">s</span> <span class="id">m</span> &lt;-&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#trace_has_message">trace_has_message</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#TraceFromStepwise.selector">selector</a></span> <span class="id">m</span> <span class="id">tr</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof256')">Proof.</div>
<div class="proofscript" id="proof256">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htr</span> <span class="kwd">as</span> [<span class="id">Htr</span> <span class="id">Hinit</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_partial_trace_update">oracle_partial_trace_update</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#TraceFromStepwise.oracle_props">oracle_props</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (~<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#TraceFromStepwise.oracle">oracle</a></span> <span class="id">s0</span> <span class="id">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#TraceFromStepwise.oracle_props">oracle_props</a></span>, <span class="id">Hinit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="prove_all_have_message_from_stepwise">prove_all_have_message_from_stepwise</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#TraceFromStepwise.vlsm">vlsm</a></span>) <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#TraceFromStepwise.message">message</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#all_traces_have_message_prop">all_traces_have_message_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#TraceFromStepwise.vlsm">vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#TraceFromStepwise.selector">selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#TraceFromStepwise.oracle">oracle</a></span> <span class="id">s</span> <span class="id">m</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof257')">Proof.</div>
<div class="proofscript" id="proof257">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">s</span> <span class="id">Hproto</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#all_traces_have_message_prop">all_traces_have_message_prop</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">Hsent</span> <span class="id">s0</span> <span class="id">tr</span> <span class="id">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#H_protocol_trace_prop">H_protocol_trace_prop</a></span> <span class="id">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intro</span> <span class="id">H_all_traces</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_has_trace">protocol_state_has_trace</a></span> <span class="kwd">in</span> <span class="id">Hproto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hproto</span> <span class="kwd">as</span> [<span class="id">s0</span> [<span class="id">tr</span> <span class="id">Htr</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#H_protocol_trace_prop">H_protocol_trace_prop</a></span> <span class="id">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H_all_traces</span> <span class="id">s0</span> <span class="id">tr</span> <span class="id">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="prove_none_have_message_from_stepwise">prove_none_have_message_from_stepwise</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#TraceFromStepwise.vlsm">vlsm</a></span>) <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#TraceFromStepwise.message">message</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_traces_have_message_prop">no_traces_have_message_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#TraceFromStepwise.vlsm">vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#TraceFromStepwise.selector">selector</a></span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> =&gt; ~<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#TraceFromStepwise.oracle">oracle</a></span> <span class="id">s</span> <span class="id">m</span>) <span class="id">s</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof258')">Proof.</div>
<div class="proofscript" id="proof258">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">s</span> <span class="id">Hproto</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#H_protocol_trace_prop">H_protocol_trace_prop</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">H_not_sent</span> <span class="id">start</span> <span class="id">tr</span> <span class="id">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">H_not_sent</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#H_protocol_trace_prop">H_protocol_trace_prop</a></span> <span class="id">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">H_no_traces</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_has_trace">protocol_state_has_trace</a></span> <span class="kwd">in</span> <span class="id">Hproto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hproto</span> <span class="kwd">as</span> [<span class="id">s0</span> [<span class="id">tr</span> <span class="id">Htr</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H_no_traces</span> <span class="id">s0</span> <span class="id">tr</span> <span class="id">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">H_no_traces</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#H_protocol_trace_prop">H_protocol_trace_prop</a></span> <span class="id">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="in_futures_preserving_oracle_from_stepwise">in_futures_preserving_oracle_from_stepwise</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s1</span> <span class="id">s2</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hfutures</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#in_futures">in_futures</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#TraceFromStepwise.vlsm">vlsm</a></span>) <span class="id">s1</span> <span class="id">s2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#TraceFromStepwise.message">message</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#TraceFromStepwise.oracle">oracle</a></span> <span class="id">s1</span> <span class="id">m</span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#TraceFromStepwise.oracle">oracle</a></span>  <span class="id">s2</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof259')">Proof.</div>
<div class="proofscript" id="proof259">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">s1</span> <span class="id">s2</span> [<span class="id">tr</span> <span class="id">Htr</span>] <span class="id">m</span> <span class="id">Hs1m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_partial_trace_update">oracle_partial_trace_update</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#TraceFromStepwise.oracle_props">oracle_props</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<span class="kwd">End</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#TraceFromStepwise">TraceFromStepwise</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="StepwiseFromTrace">StepwiseFromTrace</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">message</span> : <span class="kwd">Type</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">vlsm</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">selector</span>: <span class="id">message</span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">oracle</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_message_oracle">state_message_oracle</a></span> <span class="id">vlsm</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">oracle_dec</span>: <span class="id">RelDecision</span> <span class="id">oracle</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Horacle_all_have</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> (<span class="id">Hs</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id">vlsm</span>) <span class="id">s</span>) <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#all_traces_have_message_prop">all_traces_have_message_prop</a></span> <span class="id">vlsm</span> <span class="id">selector</span> <span class="id">oracle</span> <span class="id">s</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hnot_oracle_none_have</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> (<span class="id">Hs</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id">vlsm</span>) <span class="id">s</span>) <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_traces_have_message_prop">no_traces_have_message_prop</a></span> <span class="id">vlsm</span> <span class="id">selector</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">s</span> =&gt; ~<span class="id">oracle</span> <span class="id">m</span> <span class="id">s</span>) <span class="id">s</span> <span class="id">m</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="oracle_no_inits_from_trace">oracle_no_inits_from_trace</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#StepwiseFromTrace.vlsm">vlsm</a></span>), <span class="id"><a href="CasperCBC.VLSM.Common.html#initial_state_prop">initial_state_prop</a></span> (<span class="id">VLSM_sign</span>:=<span class="id"><a href="CasperCBC.VLSM.Common.html#sign">sign</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#StepwiseFromTrace.vlsm">vlsm</a></span>) <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span>, ~<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#StepwiseFromTrace.oracle">oracle</a></span> <span class="id">s</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof260')">Proof.</div>
<div class="proofscript" id="proof260">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">s</span> <span class="id">Hinit</span> <span class="id">m</span> <span class="id">Horacle</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hproto</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#StepwiseFromTrace.vlsm">vlsm</a></span>) <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#initial_is_protocol">initial_is_protocol</a></span>;<span class="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#StepwiseFromTrace.Horacle_all_have">Horacle_all_have</a></span> <span class="kwd">in</span> <span class="id">Horacle</span>;[|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Horacle</span> <span class="id">s</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_nil">Exists_nil</a></span>;<span class="tactic">apply</span> <span class="id">Horacle</span>;<span class="tactic">clear</span> <span class="id">Horacle</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;[<span class="id">constructor</span>|];<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="examine_one_trace">examine_one_trace</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">is</span> <span class="id">s</span> <span class="id">tr</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_init_to">finite_protocol_trace_init_to</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#StepwiseFromTrace.vlsm">vlsm</a></span>) <span class="id">is</span> <span class="id">s</span> <span class="id">tr</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#StepwiseFromTrace.oracle">oracle</a></span> <span class="id">s</span> <span class="id">m</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#trace_has_message">trace_has_message</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#StepwiseFromTrace.selector">selector</a></span> <span class="id">m</span> <span class="id">tr</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof261')">Proof.</div>
<div class="proofscript" id="proof261">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">is</span> <span class="id">s</span> <span class="id">tr</span> <span class="id">Htr</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#StepwiseFromTrace.vlsm">vlsm</a></span>) <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#ptrace_last_pstate">ptrace_last_pstate</a></span> <span class="kwd">in</span> <span class="id">Htr</span>;<span class="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">Horacle</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#StepwiseFromTrace.Horacle_all_have">Horacle_all_have</a></span> <span class="kwd">in</span> <span class="id">Horacle</span>;[|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Horacle</span> <span class="id">is</span> <span class="id">tr</span> <span class="id">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intro</span> <span class="id">Hexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">dec_stable</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">Hnot</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#StepwiseFromTrace.Hnot_oracle_none_have">Hnot_oracle_none_have</a></span> <span class="kwd">in</span> <span class="id">Hnot</span>;[|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#selected_message_exists_preloaded_not_some_iff_no">selected_message_exists_preloaded_not_some_iff_no</a></span> <span class="kwd">in</span> <span class="id">Hnot</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hnot</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">is</span>, <span class="id">tr</span>, <span class="id">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="oracle_step_property_from_trace">oracle_step_property_from_trace</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">s</span> <span class="id">im</span> <span class="id">s</span>' <span class="id">om</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_transition">protocol_transition</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#StepwiseFromTrace.vlsm">vlsm</a></span>) <span class="id">l</span> (<span class="id">s</span>,<span class="id">im</span>) (<span class="id">s</span>',<span class="id">om</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">msg</span>, <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#StepwiseFromTrace.oracle">oracle</a></span> <span class="id">s</span>' <span class="id">msg</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;-&gt; (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#StepwiseFromTrace.selector">selector</a></span> <span class="id">msg</span> {| <span class="id"><a href="CasperCBC.VLSM.Common.html#l">l</a></span>:=<span class="id">l</span>; <span class="id"><a href="CasperCBC.VLSM.Common.html#input">input</a></span>:=<span class="id">im</span>; <span class="id"><a href="CasperCBC.VLSM.Common.html#destination">destination</a></span>:=<span class="id">s</span>'; <span class="id"><a href="CasperCBC.VLSM.Common.html#output">output</a></span>:=<span class="id">om</span> |}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#StepwiseFromTrace.oracle">oracle</a></span> <span class="id">s</span> <span class="id">msg</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof262')">Proof.</div>
<div class="proofscript" id="proof262">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">l</span> <span class="id">s</span> <span class="id">im</span> <span class="id">s</span>' <span class="id">om</span> <span class="id">Htrans</span> <span class="id">msg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rename</span> <span class="id">Htrans</span> <span class="id">into</span> <span class="id">Htrans</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> <span class="id">Htrans</span>' <span class="kwd">as</span> [[<span class="id">Hproto_s</span> [<span class="id">Hproto_m</span> <span class="id">Hvalid</span>]] <span class="id">Htrans</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">preloaded</span>:= <span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#StepwiseFromTrace.vlsm">vlsm</a></span>) <span class="kwd">in</span> * |- *.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_has_trace">protocol_state_has_trace</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hproto_s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> [<span class="id">is</span> [<span class="id">tr</span> [<span class="id">Htr</span> <span class="id">Hinit</span>]]].<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id">Htr</span>' := <span class="id"><a href="CasperCBC.VLSM.Common.html#extend_right_finite_trace_from_to">extend_right_finite_trace_from_to</a></span> <span class="id">_</span> <span class="id">Htr</span> <span class="id">Htrans</span>').<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#examine_one_trace">examine_one_trace</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">Htr</span> <span class="id">Hinit</span>) <span class="id">msg</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#examine_one_trace">examine_one_trace</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">Htr</span>' <span class="id">Hinit</span>) <span class="id">msg</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">progress</span> <span class="id">cbn</span>. <span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#trace_has_message">trace_has_message</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_app">Exists_app</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_cons">Exists_cons</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_nil">Exists_nil</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="stepwise_props_from_trace">stepwise_props_from_trace</a></span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_stepwise_props">oracle_stepwise_props</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#StepwiseFromTrace.selector">selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#StepwiseFromTrace.oracle">oracle</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof263')">Proof.</div>
<div class="proofscript" id="proof263">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">refine</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_no_inits_from_trace">oracle_no_inits_from_trace</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">refine</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_step_property_from_trace">oracle_step_property_from_trace</a></span>.<br/>
&nbsp;&nbsp;Defined.</div>
<span class="kwd">End</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#StepwiseFromTrace">StepwiseFromTrace</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="has_been_sent_stepwise_props">has_been_sent_stepwise_props</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">message</span>] [<span class="id">vlsm</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>] (<span class="id">has_been_sent_pred</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_message_oracle">state_message_oracle</a></span> <span class="id">vlsm</span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;(<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_stepwise_props">oracle_stepwise_props</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#field_selector">field_selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#output">output</a></span>) <span class="id">has_been_sent_pred</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="has_been_sent_capability_from_stepwise">has_been_sent_capability_from_stepwise</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">message</span> : <span class="kwd">Type</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">vlsm</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">has_been_sent_pred</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_message_oracle">state_message_oracle</a></span> <span class="id">vlsm</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_been_sent_pred_dec</span>: <span class="id">RelDecision</span> <span class="id">has_been_sent_pred</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_been_sent_alt_props</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_stepwise_props">has_been_sent_stepwise_props</a></span> <span class="id">has_been_sent_pred</span>):<br/>
&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_capability">has_been_sent_capability</a></span> <span class="id">vlsm</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof264')">Proof.</div>
<div class="proofscript" id="proof264">
&nbsp;&nbsp;<span class="tactic">refine</span> ({|<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent">has_been_sent</a></span>:=<span class="id">has_been_sent_pred</span>|}).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#prove_all_have_message_from_stepwise">prove_all_have_message_from_stepwise</a></span>;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#prove_none_have_message_from_stepwise">prove_none_have_message_from_stepwise</a></span>;<span class="tactic">assumption</span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="has_been_sent_stepwise_from_trace">has_been_sent_stepwise_from_trace</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">message</span> : <span class="kwd">Type</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">vlsm</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hhbs</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_capability">has_been_sent_capability</a></span> <span class="id">vlsm</span>):<br/>
&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_stepwise_props">oracle_stepwise_props</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#field_selector">field_selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#output">output</a></span>) (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent">has_been_sent</a></span> <span class="id">vlsm</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof265')">Proof.</div>
<div class="proofscript" id="proof265">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#stepwise_props_from_trace">stepwise_props_from_trace</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_dec">has_been_sent_dec</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_sent">proper_sent</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_not_sent">proper_not_sent</a></span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="has_been_sent_step_update">has_been_sent_step_update</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<span class="id">Hhbs</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_capability">has_been_sent_capability</a></span> <span class="id">message</span> <span class="id">vlsm</span>}:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> [<span class="id">l</span> <span class="id">s</span> <span class="id">im</span> <span class="id">s</span>' <span class="id">om</span>],<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_transition">protocol_transition</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id">vlsm</span>) <span class="id">l</span> (<span class="id">s</span>,<span class="id">im</span>) (<span class="id">s</span>',<span class="id">om</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent">has_been_sent</a></span> <span class="id">vlsm</span> <span class="id">s</span>' <span class="id">m</span> &lt;-&gt; (<span class="id">om</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span> \/ <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent">has_been_sent</a></span> <span class="id">vlsm</span> <span class="id">s</span> <span class="id">m</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof266')">Proof.</div>
<div class="proofscript" id="proof266">
&nbsp;&nbsp;<span class="tactic">exact</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_step_update">oracle_step_update</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_stepwise_from_trace">has_been_sent_stepwise_from_trace</a></span> <span class="id">Hhbs</span>)).<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="has_been_received_stepwise_props">has_been_received_stepwise_props</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">message</span>] [<span class="id">vlsm</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>] (<span class="id">has_been_received_pred</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_message_oracle">state_message_oracle</a></span> <span class="id">vlsm</span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;(<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_stepwise_props">oracle_stepwise_props</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#field_selector">field_selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#input">input</a></span>) <span class="id">has_been_received_pred</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="has_been_received_capability_from_stepwise">has_been_received_capability_from_stepwise</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">message</span> : <span class="kwd">Type</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">vlsm</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">has_been_received_pred</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_message_oracle">state_message_oracle</a></span> <span class="id">vlsm</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_been_received_pred_dec</span>: <span class="id">RelDecision</span> <span class="id">has_been_received_pred</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_been_sent_alt_props</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_stepwise_props">has_been_received_stepwise_props</a></span> <span class="id">has_been_received_pred</span>):<br/>
&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_capability">has_been_received_capability</a></span> <span class="id">vlsm</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof267')">Proof.</div>
<div class="proofscript" id="proof267">
&nbsp;&nbsp;<span class="tactic">refine</span> ({|<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received">has_been_received</a></span>:=<span class="id">has_been_received_pred</span>|}).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#prove_all_have_message_from_stepwise">prove_all_have_message_from_stepwise</a></span>;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#prove_none_have_message_from_stepwise">prove_none_have_message_from_stepwise</a></span>;<span class="tactic">assumption</span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="has_been_received_stepwise_from_trace">has_been_received_stepwise_from_trace</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">message</span> : <span class="kwd">Type</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">vlsm</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hhbr</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_capability">has_been_received_capability</a></span> <span class="id">vlsm</span>):<br/>
&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_stepwise_props">oracle_stepwise_props</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#field_selector">field_selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#input">input</a></span>) (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received">has_been_received</a></span> <span class="id">vlsm</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof268')">Proof.</div>
<div class="proofscript" id="proof268">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#stepwise_props_from_trace">stepwise_props_from_trace</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_dec">has_been_received_dec</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_received">proper_received</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_not_received">proper_not_received</a></span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="has_been_received_step_update">has_been_received_step_update</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<span class="id">Hhbs</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_capability">has_been_received_capability</a></span> <span class="id">message</span> <span class="id">vlsm</span>}:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> [<span class="id">l</span> <span class="id">s</span> <span class="id">im</span> <span class="id">s</span>' <span class="id">om</span>],<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_transition">protocol_transition</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id">vlsm</span>) <span class="id">l</span> (<span class="id">s</span>,<span class="id">im</span>) (<span class="id">s</span>',<span class="id">om</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received">has_been_received</a></span> <span class="id">vlsm</span> <span class="id">s</span>' <span class="id">m</span> &lt;-&gt; (<span class="id">im</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span> \/ <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received">has_been_received</a></span> <span class="id">vlsm</span> <span class="id">s</span> <span class="id">m</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof269')">Proof.</div>
<div class="proofscript" id="proof269">
&nbsp;&nbsp;<span class="tactic">exact</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_step_update">oracle_step_update</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_stepwise_from_trace">has_been_received_stepwise_from_trace</a></span> <span class="id">Hhbs</span>)).<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Class</span> <span class="id"><a name="has_been_observed_capability">has_been_observed_capability</a></span> {<span class="id">message</span>} (<span class="id">vlsm</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>) :=<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;<span class="id"><a name="has_been_observed">has_been_observed</a></span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_message_oracle">state_message_oracle</a></span> <span class="id">vlsm</span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="has_been_observed_dec">has_been_observed_dec</a></span> :&gt; <span class="id">RelDecision</span> <span class="id">has_been_observed</span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="has_been_observed_stepwise_props">has_been_observed_stepwise_props</a></span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_stepwise_props">oracle_stepwise_props</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#item_sends_or_receives">item_sends_or_receives</a></span> <span class="id">has_been_observed</span>;<br/>
&nbsp;&nbsp;}.<br/>
<span class="id">Arguments</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed">has_been_observed</a></span> {<span class="id">message</span>} <span class="id">vlsm</span> {<span class="id">_</span>}.<br/>
<span class="id">Arguments</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_dec">has_been_observed_dec</a></span> {<span class="id">message</span>} <span class="id">vlsm</span> {<span class="id">_</span>}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="has_been_observed_step_update">has_been_observed_step_update</a></span> `{<span class="id">Hhbo</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_capability">has_been_observed_capability</a></span> <span class="id">message</span> <span class="id">vlsm</span>} :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">s</span> <span class="id">im</span> <span class="id">s</span>' <span class="id">om</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_transition">protocol_transition</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id">vlsm</span>) <span class="id">l</span> (<span class="id">s</span>, <span class="id">im</span>) (<span class="id">s</span>', <span class="id">om</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">msg</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed">has_been_observed</a></span> <span class="id">vlsm</span> <span class="id">s</span>' <span class="id">msg</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id">im</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">msg</span> \/ <span class="id">om</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">msg</span>) \/ <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed">has_been_observed</a></span> <span class="id">vlsm</span> <span class="id">s</span> <span class="id">msg</span>)<br/>
&nbsp;&nbsp;:= <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_step_update">oracle_step_update</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_stepwise_props">has_been_observed_stepwise_props</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="proper_observed">proper_observed</a></span> `(<span class="id">Hhbo</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_capability">has_been_observed_capability</a></span> <span class="id">message</span> <span class="id">vlsm</span>):<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span>:<span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id">vlsm</span>) <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#all_traces_have_message_prop">all_traces_have_message_prop</a></span> <span class="id">vlsm</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#item_sends_or_receives">item_sends_or_receives</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed">has_been_observed</a></span> <span class="id">vlsm</span>) <span class="id">s</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof270')">Proof.</div>
<div class="proofscript" id="proof270">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#prove_all_have_message_from_stepwise">prove_all_have_message_from_stepwise</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hhbo</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="proper_not_observed">proper_not_observed</a></span> `(<span class="id">Hhbo</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_capability">has_been_observed_capability</a></span> <span class="id">message</span> <span class="id">vlsm</span>):<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span>:<span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id">vlsm</span>) <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_traces_have_message_prop">no_traces_have_message_prop</a></span> <span class="id">vlsm</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#item_sends_or_receives">item_sends_or_receives</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> =&gt; ~<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed">has_been_observed</a></span> <span class="id">vlsm</span> <span class="id">s</span> <span class="id">m</span>) <span class="id">s</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof271')">Proof.</div>
<div class="proofscript" id="proof271">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#prove_none_have_message_from_stepwise">prove_none_have_message_from_stepwise</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hhbo</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<div class="doc">A received message introduces no additional equivocations to a state
    if it has already been observed in s or it is an initial message.
</div>
<span class="kwd">Definition</span> <span class="id"><a name="no_additional_equivocations">no_additional_equivocations</a></span><br/>
&nbsp;&nbsp;{<span class="id">message</span> : <span class="kwd">Type</span>}<br/>
&nbsp;&nbsp;(<span class="id">vlsm</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>)<br/>
&nbsp;&nbsp;{<span class="id">Hbo</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_capability">has_been_observed_capability</a></span> <span class="id">vlsm</span>}<br/>
&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;(<span class="id">m</span> : <span class="id">message</span>)<br/>
&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed">has_been_observed</a></span> <span class="id">vlsm</span> <span class="id">s</span> <span class="id">m</span> \/ <span class="id"><a href="CasperCBC.VLSM.Common.html#vinitial_message_prop">vinitial_message_prop</a></span> <span class="id">vlsm</span> <span class="id">m</span>.<br/>
<br/>
<div class="doc">If the <span class="bracket"><span class="id">initial_message_prop</span></span> is decidable, then the
    <span class="bracket"><span class="id">no_additional_equivocations</span></span> is also decidable.
</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="no_additional_equivocations_dec">no_additional_equivocations_dec</a></span><br/>
&nbsp;&nbsp;{<span class="id">message</span> : <span class="kwd">Type</span>}<br/>
&nbsp;&nbsp;(<span class="id">vlsm</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>)<br/>
&nbsp;&nbsp;{<span class="id">Hbo</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_capability">has_been_observed_capability</a></span> <span class="id">vlsm</span>}<br/>
&nbsp;&nbsp;(<span class="id">initial_dec</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vdecidable_initial_messages_prop">vdecidable_initial_messages_prop</a></span> <span class="id">vlsm</span>)<br/>
&nbsp;&nbsp;: <span class="id">RelDecision</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_additional_equivocations">no_additional_equivocations</a></span> <span class="id">vlsm</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof272')">Proof.</div>
<div class="proofscript" id="proof272">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">s</span> <span class="id">m</span>. <span class="tactic">apply</span> <span class="id">Decision_or</span>; [|<span class="tactic">apply</span> <span class="id">initial_dec</span>].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_dec">has_been_observed_dec</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="no_additional_equivocations_constraint">no_additional_equivocations_constraint</a></span><br/>
&nbsp;&nbsp;{<span class="id">message</span> : <span class="kwd">Type</span>}<br/>
&nbsp;&nbsp;(<span class="id">vlsm</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>)<br/>
&nbsp;&nbsp;{<span class="id">Hbo</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_capability">has_been_observed_capability</a></span> <span class="id">vlsm</span>}<br/>
&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vlabel">vlabel</a></span> <span class="id">vlsm</span>)<br/>
&nbsp;&nbsp;(<span class="id">som</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">message</span>)<br/>
&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">s</span>, <span class="id">om</span>) := <span class="id">som</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">om</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span> =&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_additional_equivocations">no_additional_equivocations</a></span> <span class="id">vlsm</span> <span class="id">s</span> <span class="id">m</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="sent_received_observed_capabilities">sent_received_observed_capabilities</a></span>.<br/>
<br/>
<span class="kwd">Context</span><br/>
&nbsp;&nbsp;{<span class="id">message</span> : <span class="kwd">Type</span>}<br/>
&nbsp;&nbsp;(<span class="id">vlsm</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>)<br/>
&nbsp;&nbsp;{<span class="id">Hbr</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_capability">has_been_received_capability</a></span> <span class="id">vlsm</span>}<br/>
&nbsp;&nbsp;{<span class="id">Hbs</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_capability">has_been_sent_capability</a></span> <span class="id">vlsm</span>}<br/>
&nbsp;&nbsp;.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="has_been_observed_sent_received_iff">has_been_observed_sent_received_iff</a></span><br/>
&nbsp;&nbsp;{<span class="id">Hbo</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_capability">has_been_observed_capability</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_received_observed_capabilities.vlsm">vlsm</a></span>}<br/>
&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;(<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_received_observed_capabilities.vlsm">vlsm</a></span>) <span class="id">s</span>)<br/>
&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_received_observed_capabilities.message">message</a></span>)<br/>
&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed">has_been_observed</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_received_observed_capabilities.vlsm">vlsm</a></span> <span class="id">s</span> <span class="id">m</span> &lt;-&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received">has_been_received</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_received_observed_capabilities.vlsm">vlsm</a></span> <span class="id">s</span> <span class="id">m</span> \/ <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent">has_been_sent</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_received_observed_capabilities.vlsm">vlsm</a></span> <span class="id">s</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof273')">Proof.</div>
<div class="proofscript" id="proof273">
&nbsp;&nbsp;<span class="id">specialize</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#prove_all_have_message_from_stepwise">prove_all_have_message_from_stepwise</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_received_observed_capabilities.message">message</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_received_observed_capabilities.vlsm">vlsm</a></span>  <span class="id"><a href="CasperCBC.VLSM.Common.html#item_sends_or_receives">item_sends_or_receives</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed">has_been_observed</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_received_observed_capabilities.vlsm">vlsm</a></span>) <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_stepwise_props">has_been_observed_stepwise_props</a></span> <span class="id">_</span> <span class="id">Hs</span> <span class="id">m</span>) <span class="kwd">as</span> <span class="id">Hall</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">intro</span> <span class="id">H</span> | <span class="tactic">intros</span> [<span class="id">H</span> | <span class="id">H</span>]].<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="kwd">in</span> <span class="id">Hall</span>. <span class="id">specialize</span> (<span class="id">Hall</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#consistency_from_protocol_proj2">consistency_from_protocol_proj2</a></span> <span class="kwd">in</span> <span class="id">Hall</span>; [|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hall</span> <span class="kwd">as</span> [<span class="id">is</span> [<span class="id">tr</span> [<span class="id">Htr</span> <span class="id">Hexists</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_or_inv">Exists_or_inv</a></span> <span class="kwd">in</span> <span class="id">Hexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hexists</span> <span class="kwd">as</span> [<span class="id">Hsent</span> | <span class="id">Hreceived</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>. <span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_consistency">has_been_received_consistency</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_received_observed_capabilities.vlsm">vlsm</a></span> <span class="id">_</span> <span class="id">Hs</span> <span class="id">m</span>) <span class="kwd">as</span> <span class="id">Hcons</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_received">proper_received</a></span>; [<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hcons</span>. <span class="id">exists</span> <span class="id">is</span>, <span class="id">tr</span>, <span class="id">Htr</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>. <span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_consistency">has_been_sent_consistency</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_received_observed_capabilities.vlsm">vlsm</a></span> <span class="id">_</span> <span class="id">Hs</span> <span class="id">m</span>) <span class="kwd">as</span> <span class="id">Hcons</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_sent">proper_sent</a></span>; [<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hcons</span>. <span class="id">exists</span> <span class="id">is</span>, <span class="id">tr</span>, <span class="id">Htr</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">Hall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">is</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_received">proper_received</a></span> <span class="kwd">in</span> <span class="id">H</span>; [|<span class="tactic">assumption</span>]. <span class="id">specialize</span> (<span class="id">H</span> <span class="id">is</span> <span class="id">tr</span> <span class="id">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_or">Exists_or</a></span>. <span class="id">left</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">Hall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">is</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_sent">proper_sent</a></span> <span class="kwd">in</span> <span class="id">H</span>; [|<span class="tactic">assumption</span>]. <span class="id">specialize</span> (<span class="id">H</span> <span class="id">is</span> <span class="id">tr</span> <span class="id">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_or">Exists_or</a></span>. <span class="id">right</span>. <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="has_been_observed_from_sent_received">has_been_observed_from_sent_received</a></span><br/>
&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_received_observed_capabilities.vlsm">vlsm</a></span>)<br/>
&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_received_observed_capabilities.message">message</a></span>)<br/>
&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;:= <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent">has_been_sent</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_received_observed_capabilities.vlsm">vlsm</a></span> <span class="id">s</span> <span class="id">m</span> \/ <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received">has_been_received</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_received_observed_capabilities.vlsm">vlsm</a></span> <span class="id">s</span> <span class="id">m</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="has_been_observed_from_sent_received_dec">has_been_observed_from_sent_received_dec</a></span><br/>
&nbsp;&nbsp;: <span class="id">RelDecision</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_from_sent_received">has_been_observed_from_sent_received</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof274')">Proof.</div>
<div class="proofscript" id="proof274">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">s</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Decision_or</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_dec">has_been_sent_dec</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_dec">has_been_received_dec</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="has_been_observed_from_sent_received_stepwise_props">has_been_observed_from_sent_received_stepwise_props</a></span><br/>
&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_stepwise_props">oracle_stepwise_props</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#item_sends_or_receives">item_sends_or_receives</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_from_sent_received">has_been_observed_from_sent_received</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof275')">Proof.</div>
<div class="proofscript" id="proof275">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#stepwise_props_from_trace">stepwise_props_from_trace</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_from_sent_received_dec">has_been_observed_from_sent_received_dec</a></span>|..]<br/>
&nbsp;&nbsp;; <span class="tactic">intros</span>; <span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intro</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">H</span> | <span class="id">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_sent">proper_sent</a></span> <span class="kwd">in</span> <span class="id">H</span>; [|<span class="tactic">apply</span> <span class="id">Hs</span>]. <span class="id">specialize</span> (<span class="id">H</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_or">Exists_or</a></span>. <span class="id">right</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_received">proper_received</a></span> <span class="kwd">in</span> <span class="id">H</span>; [|<span class="tactic">apply</span> <span class="id">Hs</span>]. <span class="id">specialize</span> (<span class="id">H</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_or">Exists_or</a></span>. <span class="id">left</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#consistency_from_protocol_proj2">consistency_from_protocol_proj2</a></span> <span class="kwd">in</span> <span class="id">H</span>; [|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">is</span> [<span class="id">tr</span> [<span class="id">Htr</span> <span class="id">Hexists</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_or_inv">Exists_or_inv</a></span> <span class="kwd">in</span> <span class="id">Hexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hexists</span> <span class="kwd">as</span> [<span class="id">Hsent</span> | <span class="id">Hreceived</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>. <span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_received">proper_received</a></span>; [<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_consistency">has_been_received_consistency</a></span>; [<span class="tactic">assumption</span>|<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">is</span>, <span class="id">tr</span>, <span class="id">Htr</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>. <span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_sent">proper_sent</a></span>; [<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_consistency">has_been_sent_consistency</a></span>; [<span class="tactic">assumption</span>|<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">is</span>, <span class="id">tr</span>, <span class="id">Htr</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intro</span>; <span class="tactic">intros</span>. <span class="tactic">intro</span> <span class="id">Hexists</span>. <span class="tactic">elim</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_or_inv">Exists_or_inv</a></span> <span class="kwd">in</span> <span class="id">Hexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hexists</span> <span class="kwd">as</span> [<span class="id">Hexists</span>| <span class="id">Hexists</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>. <span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_received">proper_received</a></span>; [<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_consistency">has_been_received_consistency</a></span>; [<span class="tactic">assumption</span>|<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">start</span>, <span class="id">tr</span>, <span class="id">Htr</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>. <span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_sent">proper_sent</a></span>; [<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_consistency">has_been_sent_consistency</a></span>; [<span class="tactic">assumption</span>|<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">start</span>, <span class="id">tr</span>, <span class="id">Htr</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intros</span> [<span class="id">Hobs</span> | <span class="id">Hobs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_sent">proper_sent</a></span> <span class="kwd">in</span> <span class="id">Hobs</span>; [|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_consistency">has_been_sent_consistency</a></span> <span class="kwd">in</span> <span class="id">Hobs</span>; [|<span class="tactic">assumption</span>|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hobs</span> <span class="kwd">as</span> [<span class="id">is</span> [<span class="id">tr</span> [<span class="id">Htr</span> <span class="id">Hexists</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Htr</span>). <span class="tactic">elim</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_or">Exists_or</a></span>. <span class="id">right</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_received">proper_received</a></span> <span class="kwd">in</span> <span class="id">Hobs</span>; [|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_consistency">has_been_received_consistency</a></span> <span class="kwd">in</span> <span class="id">Hobs</span>; [|<span class="tactic">assumption</span>|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hobs</span> <span class="kwd">as</span> [<span class="id">is</span> [<span class="id">tr</span> [<span class="id">Htr</span> <span class="id">Hexists</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Htr</span>). <span class="tactic">elim</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_or">Exists_or</a></span>. <span class="id">left</span>. <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id"><a name="has_been_observed_capability_from_sent_received">has_been_observed_capability_from_sent_received</a></span><br/>
&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_capability">has_been_observed_capability</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_received_observed_capabilities.vlsm">vlsm</a></span><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;{ <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed">has_been_observed</a></span> := <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_from_sent_received">has_been_observed_from_sent_received</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_dec">has_been_observed_dec</a></span> := <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_from_sent_received_dec">has_been_observed_from_sent_received_dec</a></span>;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_stepwise_props">has_been_observed_stepwise_props</a></span> := <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_from_sent_received_stepwise_props">has_been_observed_from_sent_received_stepwise_props</a></span><br/>
&nbsp;&nbsp;}.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#sent_received_observed_capabilities">sent_received_observed_capabilities</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="NoEquivocationInvariants">NoEquivocationInvariants</a></span>.<br/>
&nbsp;&nbsp;<span class="kwd">Context</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">message</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hhbs</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_capability">has_been_sent_capability</a></span> <span class="id">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hhbo</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_capability">has_been_observed_capability</a></span> <span class="id">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Henforced</span>: <span class="kwd">forall</span> <span class="id">l</span> <span class="id">s</span> <span class="id">om</span>, <span class="id"><a href="CasperCBC.VLSM.Common.html#vvalid">vvalid</a></span> <span class="id">X</span> <span class="id">l</span> (<span class="id">s</span>,<span class="id">om</span>) -&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_equivocations">no_equivocations</a></span> <span class="id">X</span> <span class="id">l</span> (<span class="id">s</span>,<span class="id">om</span>))<br/>
&nbsp;&nbsp;.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="observed_were_sent_or_initial">observed_were_sent_or_initial</a></span> (<span class="id">s</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">msg</span>, <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed">has_been_observed</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.X">X</a></span> <span class="id">s</span> <span class="id">msg</span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent">has_been_sent</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.X">X</a></span> <span class="id">s</span> <span class="id">msg</span> \/ <span class="id"><a href="CasperCBC.VLSM.Common.html#vinitial_message_prop">vinitial_message_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.X">X</a></span> <span class="id">msg</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="observed_were_sent_initial">observed_were_sent_initial</a></span> <span class="id">s</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#vinitial_state_prop">vinitial_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.X">X</a></span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#observed_were_sent_or_initial">observed_were_sent_or_initial</a></span> <span class="id">s</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof276')">Proof.</div>
<div class="proofscript" id="proof276">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hinitial</span> <span class="id">msg</span> <span class="id">Hsend</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">Hsend</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_no_inits">oracle_no_inits</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_stepwise_props">has_been_observed_stepwise_props</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="observed_were_sent_preserved">observed_were_sent_preserved</a></span> <span class="id">l</span> <span class="id">s</span> <span class="id">im</span> <span class="id">s</span>' <span class="id">om</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_transition">protocol_transition</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.X">X</a></span> <span class="id">l</span> (<span class="id">s</span>,<span class="id">im</span>) (<span class="id">s</span>',<span class="id">om</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#observed_were_sent_or_initial">observed_were_sent_or_initial</a></span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#observed_were_sent_or_initial">observed_were_sent_or_initial</a></span> <span class="id">s</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof277')">Proof.</div>
<div class="proofscript" id="proof277">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hptrans</span> <span class="id">Hprev</span> <span class="id">msg</span> <span class="id">Hobs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hprev</span> <span class="id">msg</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#preloaded_weaken_protocol_transition">preloaded_weaken_protocol_transition</a></span> <span class="kwd">in</span> <span class="id">Hptrans</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_step_update">oracle_step_update</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_stepwise_props">has_been_observed_stepwise_props</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hptrans</span>) <span class="kwd">in</span> <span class="id">Hobs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hobs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.Henforced">Henforced</a></span> <span class="id">l</span> <span class="id">s</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">msg</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_step_update">oracle_step_update</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_stepwise_from_trace">has_been_sent_stepwise_from_trace</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.Hhbs">Hhbs</a></span>) <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hptrans</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hptrans</span> <span class="kwd">as</span> [[<span class="id">_</span> [<span class="id">_</span>  <span class="id">Hv</span>]] <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hobs</span> <span class="kwd">as</span> [[|]|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;by&nbsp;[no_equivocations],&nbsp;the&nbsp;incoming&nbsp;message&nbsp;[im]&nbsp;was&nbsp;previously&nbsp;sent&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.Henforced">Henforced</a></span> <span class="id">Hv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.Henforced">Henforced</a></span>; [|<span class="id">right</span>; <span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">right</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">left</span>. <span class="id">left</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">specialize</span> (<span class="id">Hprev</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hprev</span> <span class="kwd">as</span> [<span class="id">Hprev</span>|<span class="id">Hprev</span>]; [|<span class="id">right</span>; <span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">right</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="observed_were_sent_invariant">observed_were_sent_invariant</a></span> <span class="id">s</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.X">X</a></span> <span class="id">s</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#observed_were_sent_or_initial">observed_were_sent_or_initial</a></span> <span class="id">s</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof278')">Proof.</div>
<div class="proofscript" id="proof278">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">Hproto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Hproto</span> <span class="kwd">using</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop_ind">protocol_state_prop_ind</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">msg</span> <span class="id">Hsend</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">contradict</span> <span class="id">Hsend</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_no_inits">oracle_no_inits</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_stepwise_props">has_been_observed_stepwise_props</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">intros</span> <span class="id">msg</span> <span class="id">Hobs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHHproto</span> <span class="id">msg</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#preloaded_weaken_protocol_transition">preloaded_weaken_protocol_transition</a></span> <span class="kwd">in</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_step_update">oracle_step_update</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_stepwise_props">has_been_observed_stepwise_props</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Ht</span>) <span class="kwd">in</span> <span class="id">Hobs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.Henforced">Henforced</a></span> <span class="id">l</span> <span class="id">s</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">msg</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_step_update">oracle_step_update</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_stepwise_from_trace">has_been_sent_stepwise_from_trace</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.Hhbs">Hhbs</a></span>) <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Ht</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Ht</span> <span class="kwd">as</span> [[<span class="id">_</span> [<span class="id">_</span>  <span class="id">Hv</span>]] <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hobs</span> |- *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hobs</span> <span class="kwd">as</span> [[|]|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;by&nbsp;[no_equivocations],&nbsp;the&nbsp;incoming&nbsp;message&nbsp;[im]&nbsp;was&nbsp;previously&nbsp;sent&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">spec</span> <span class="id">Henforced</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.Henforced">Henforced</a></span> <span class="kwd">as</span> [<span class="id">Hbs</span> | <span class="id">Hinitial</span>]; [|<span class="id">right</span>; <span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">right</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">left</span>. <span class="id">left</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">spec</span> <span class="id">IHHproto</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">IHHproto</span>; [|<span class="id">right</span>; <span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">right</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="no_equivocations_preloaded_traces">no_equivocations_preloaded_traces</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">is</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">tr</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace">finite_protocol_trace</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.X">X</a></span>) <span class="id">is</span> <span class="id">tr</span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace">finite_protocol_trace</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.X">X</a></span> <span class="id">is</span> <span class="id">tr</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof279')">Proof.</div>
<div class="proofscript" id="proof279">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">tr</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev_ind">rev_ind</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="kwd">in</span> <span class="id">Htr</span>. <span class="tactic">split</span>; [|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#finite_ptrace_empty">finite_ptrace_empty</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.X">X</a></span>). <span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#initial_is_protocol">initial_is_protocol</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.X">X</a></span>). <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">Htr</span> <span class="kwd">as</span> [<span class="id">Htr</span> <span class="id">His</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_from_app_iff">finite_protocol_trace_from_app_iff</a></span> <span class="kwd">in</span> <span class="id">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htr</span> <span class="kwd">as</span> [<span class="id">Htr</span> <span class="id">Hx</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtr</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">Htr</span> <span class="id">His</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#first_transition_valid">first_transition_valid</a></span> <span class="kwd">in</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_from_app_iff">finite_protocol_trace_from_app_iff</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.X">X</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">apply</span> <span class="id">IHtr</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#first_transition_valid">first_transition_valid</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.X">X</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHtr</span> <span class="kwd">as</span> [<span class="id">HtrX</span> <span class="id">HsX</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_ptrace_last_pstate">finite_ptrace_last_pstate</a></span> <span class="kwd">in</span> <span class="id">HtrX</span> <span class="kwd">as</span> <span class="id">HlstX</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>; [<span class="tactic">assumption</span>|  | <span class="tactic">apply</span> <span class="id">Hx</span> | <span class="tactic">apply</span> <span class="id">Hx</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hx</span> <span class="kwd">as</span> [[<span class="id">_</span> [<span class="id">_</span> <span class="id">Hv</span>]] <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.Henforced">Henforced</a></span> <span class="kwd">in</span> <span class="id">Hv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">input</span> <span class="kwd">as</span> [<span class="id">m</span>|]; [|<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#option_protocol_message_None">option_protocol_message_None</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#option_protocol_message_Some">option_protocol_message_Some</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hv</span> <span class="kwd">as</span> [<span class="id">Hbsm</span> | <span class="id">Him</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [|<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#initial_message_is_protocol">initial_message_is_protocol</a></span>; <span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_ptrace_last_pstate">finite_ptrace_last_pstate</a></span> <span class="kwd">in</span> <span class="id">Htr</span> <span class="kwd">as</span> <span class="id">Hlst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_sent">proper_sent</a></span> <span class="kwd">in</span> <span class="id">Hbsm</span>; [|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#ptrace_add_default_last">ptrace_add_default_last</a></span> <span class="kwd">in</span> <span class="id">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hbsm</span> <span class="id">is</span> <span class="id">tr</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">Htr</span> <span class="id">His</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#can_emit_from_protocol_trace">can_emit_from_protocol_trace</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.X">X</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">HtrX</span> <span class="id">HsX</span>) <span class="id">Hbsm</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#can_emit_protocol">can_emit_protocol</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="preloaded_incl_no_equivocations">preloaded_incl_no_equivocations</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM_incl">VLSM_incl</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.X">X</a></span>) <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.X">X</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof280')">Proof.</div>
<div class="proofscript" id="proof280">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_equivocations_preloaded_traces">no_equivocations_preloaded_traces</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> -<span class="id">X</span>. <span class="tactic">destruct</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.X">X</a></span> <span class="kwd">as</span> [<span class="id">T</span> [<span class="id">S</span> <span class="id">M</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM_incl_finite_traces_characterization">VLSM_incl_finite_traces_characterization</a></span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="preloaded_eq_no_equivocations">preloaded_eq_no_equivocations</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM_eq">VLSM_eq</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.X">X</a></span>) <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.X">X</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof281')">Proof.</div>
<div class="proofscript" id="proof281">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#preloaded_incl_no_equivocations">preloaded_incl_no_equivocations</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#vlsm_incl_pre_loaded_with_all_messages_vlsm">vlsm_incl_pre_loaded_with_all_messages_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.X">X</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> -<span class="id">X</span>. <span class="tactic">destruct</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants.X">X</a></span> <span class="kwd">as</span> [<span class="id">T</span> [<span class="id">S</span> <span class="id">M</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Hincl</span> <span class="id">Hincl</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM_eq_incl_iff">VLSM_eq_incl_iff</a></span>. <span class="tactic">split</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#NoEquivocationInvariants">NoEquivocationInvariants</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Composite">Composite</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">message</span> : <span class="kwd">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">index</span> : <span class="kwd">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">IndEqDec</span> : <span class="id">EqDecision</span> <span class="id">index</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">IM</span> : <span class="id">index</span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">i0</span> : <span class="id">Inhabited</span> <span class="id">index</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">constraint</span> : <span class="id"><a href="CasperCBC.VLSM.Composition.html#composite_label">composite_label</a></span> <span class="id">IM</span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Composition.html#composite_state">composite_state</a></span> <span class="id">IM</span>  * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">message</span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X</span> := <span class="id"><a href="CasperCBC.VLSM.Composition.html#composite_vlsm">composite_vlsm</a></span> <span class="id">IM</span> <span class="id">constraint</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">index_listing</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">index</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">finite_index</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FinFun.html#Listing">Listing</a></span> <span class="id">index_listing</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_been_sent_capabilities</span> : <span class="kwd">forall</span> <span class="id">i</span> : <span class="id">index</span>, (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_capability">has_been_sent_capability</a></span> (<span class="id">IM</span> <span class="id">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_been_observed_capabilities</span> : <span class="kwd">forall</span> <span class="id">i</span> : <span class="id">index</span>, (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_capability">has_been_observed_capability</a></span> (<span class="id">IM</span> <span class="id">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="Composite.StepwiseProps">StepwiseProps</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">message_selectors</span>: <span class="kwd">forall</span> <span class="id">i</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.index">index</a></span>, <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.message">message</a></span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#vtransition_item">vtransition_item</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.IM">IM</a></span> <span class="id">i</span>) -&gt; <span class="kwd">Prop</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">oracles</span>: <span class="kwd">forall</span> <span class="id">i</span>, <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_message_oracle">state_message_oracle</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.IM">IM</a></span> <span class="id">i</span>)]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">stepwise_props</span>: <span class="kwd">forall</span> <span class="id">i</span>, <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_stepwise_props">oracle_stepwise_props</a></span> (<span class="id">message_selectors</span> <span class="id">i</span>) (<span class="id">oracles</span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="composite_message_selector">composite_message_selector</a></span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.message">message</a></span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#vtransition_item">vtransition_item</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof282')">Proof.</div>
<div class="proofscript" id="proof282">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">msg</span> [[<span class="id">i</span> <span class="id">li</span>] <span class="id">input</span> <span class="id">s</span> <span class="id">output</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.StepwiseProps.message_selectors">message_selectors</a></span> <span class="id">i</span> <span class="id">msg</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> {|<span class="id"><a href="CasperCBC.VLSM.Common.html#l">l</a></span>:=<span class="id">li</span>;<span class="id"><a href="CasperCBC.VLSM.Common.html#input">input</a></span>:=<span class="id">input</span>;<span class="id"><a href="CasperCBC.VLSM.Common.html#destination">destination</a></span>:=<span class="id">s</span> <span class="id">i</span>;<span class="id"><a href="CasperCBC.VLSM.Common.html#output">output</a></span>:=<span class="id">output</span>|}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Defined.</div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="composite_oracle">composite_oracle</a></span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.message">message</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">s</span> <span class="id">msg</span> =&gt; <span class="id">exists</span> <span class="id">i</span>, <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.StepwiseProps.oracles">oracles</a></span> <span class="id">i</span> (<span class="id">s</span> <span class="id">i</span>) <span class="id">msg</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="composite_stepwise_props">composite_stepwise_props</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_stepwise_props">oracle_stepwise_props</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#composite_message_selector">composite_message_selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#composite_oracle">composite_oracle</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof283')">Proof.</div>
<div class="proofscript" id="proof283">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;initial&nbsp;states&nbsp;not&nbsp;claim&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">s</span> <span class="id">Hs</span> <span class="id">m</span> [<span class="id">i</span> <span class="id">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fold</span> (~ <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.StepwiseProps.oracles">oracles</a></span> <span class="id">i</span> (<span class="id">s</span> <span class="id">i</span>) <span class="id">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_no_inits">oracle_no_inits</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.StepwiseProps.stepwise_props">stepwise_props</a></span> <span class="id">i</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;step&nbsp;update&nbsp;property&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">l</span> <span class="id">s</span> <span class="id">im</span> <span class="id">s</span>' <span class="id">om</span> <span class="id">Hproto</span> <span class="id">msg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span> <span class="kwd">as</span> [<span class="id">i</span> <span class="id">li</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">j</span>, <span class="id">s</span> <span class="id">j</span> = <span class="id">s</span>' <span class="id">j</span> \/ <span class="id">j</span> = <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Composition.html#protocol_transition_preloaded_project_any">protocol_transition_preloaded_project_any</a></span> <span class="id">j</span>) <span class="kwd">in</span> <span class="id">Hproto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hproto</span>;[<span class="id">left</span>;<span class="tactic">assumption</span>|<span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">lj</span> [<span class="id">Hlj</span> <span class="id">_</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Composition.html#protocol_transition_preloaded_project_active">protocol_transition_preloaded_project_active</a></span> <span class="kwd">in</span> <span class="id">Hproto</span>;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hproto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_step_update">oracle_step_update</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.StepwiseProps.stepwise_props">stepwise_props</a></span> <span class="id">i</span>)) <span class="kwd">with</span> (<span class="id">msg</span>:=<span class="id">msg</span>) <span class="kwd">in</span> <span class="id">Hproto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> [<span class="id">j</span> <span class="id">Hj</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H</span> <span class="id">j</span>) <span class="kwd">as</span> [<span class="id">Hunchanged</span>|<span class="id">Hji</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">right</span>;<span class="id">exists</span> <span class="id">j</span>;<span class="tactic">rewrite</span> <span class="id">Hunchanged</span>;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">subst</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hproto</span> <span class="kwd">in</span> <span class="id">Hj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hj</span>;[<span class="id">left</span>;<span class="tactic">assumption</span>|<span class="id">right</span>;<span class="id">exists</span> <span class="id">i</span>;<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> [<span class="id">Hnow</span> | [<span class="id">j</span> <span class="id">Hbefore</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">exists</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hproto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">exists</span> <span class="id">j</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H</span> <span class="id">j</span>) <span class="kwd">as</span> [<span class="id">Hunchanged</span>| -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">rewrite</span> &lt;- <span class="id">Hunchanged</span>;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="tactic">apply</span> <span class="id">Hproto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.StepwiseProps">StepwiseProps</a></span>.<br/>
<br/>
<div class="doc">A message 'has_been_sent' for a composite state if it 'has_been_sent' for any of
  its components.</div>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="composite_has_been_sent">composite_has_been_sent</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id">exists</span> (<span class="id">i</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.index">index</a></span>), <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent">has_been_sent</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.IM">IM</a></span> <span class="id">i</span>) (<span class="id">s</span> <span class="id">i</span>) <span class="id">m</span>.<br/>
<br/>
<div class="doc">'composite_has_been_sent' is decidable. </div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="composite_has_been_sent_dec">composite_has_been_sent_dec</a></span> : <span class="id">RelDecision</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#composite_has_been_sent">composite_has_been_sent</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof284')">Proof.</div>
<div class="proofscript" id="proof284">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">s</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">Decision_iff</span> (<span class="id">P</span>:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">List.Exists</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent">has_been_sent</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.IM">IM</a></span> <span class="id">i</span>) (<span class="id">s</span> <span class="id">i</span>) <span class="id">m</span>) <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.index_listing">index_listing</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- <span class="id">exists_finite</span> <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.finite_index">finite_index</a></span>). <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">Exists_dec</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="composite_has_been_sent_stepwise_props">composite_has_been_sent_stepwise_props</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_stepwise_props">has_been_sent_stepwise_props</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#composite_has_been_sent">composite_has_been_sent</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof285')">Proof.</div>
<div class="proofscript" id="proof285">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_stepwise_props">has_been_sent_stepwise_props</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#composite_stepwise_props">composite_stepwise_props</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_stepwise_from_trace">has_been_sent_stepwise_from_trace</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.has_been_sent_capabilities">has_been_sent_capabilities</a></span> <span class="id">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> [<span class="id">Hinits</span> <span class="id">Hstep</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;[<span class="tactic">exact</span> <span class="id">Hinits</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;&lt;&lt;exact&nbsp;Hstep&gt;&gt;&nbsp;doesn't&nbsp;work&nbsp;because&nbsp;[composite_message_selector]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pattern&nbsp;matches&nbsp;on&nbsp;the&nbsp;label&nbsp;l,&nbsp;so&nbsp;we&nbsp;instantiate&nbsp;and&nbsp;destruct<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;let&nbsp;that&nbsp;simplify&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">l</span>;<span class="id">specialize</span> (<span class="id">Hstep</span> <span class="id">l</span>);<span class="tactic">destruct</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">Hstep</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="composite_has_been_sent_capability">composite_has_been_sent_capability</a></span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_capability">has_been_sent_capability</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_capability_from_stepwise">has_been_sent_capability_from_stepwise</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#composite_has_been_sent_dec">composite_has_been_sent_dec</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#composite_has_been_sent_stepwise_props">composite_has_been_sent_stepwise_props</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="Composite.composite_has_been_received">composite_has_been_received</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_been_received_capabilities</span> : <span class="kwd">forall</span> <span class="id">i</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.index">index</a></span>, (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_capability">has_been_received_capability</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.IM">IM</a></span> <span class="id">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br/>
<br/>
<div class="doc">A message 'has_been_received' for a composite state if it 'has_been_received' for any of
  its components.</div>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="composite_has_been_received">composite_has_been_received</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id">exists</span> (<span class="id">i</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.index">index</a></span>), <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received">has_been_received</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.IM">IM</a></span> <span class="id">i</span>) (<span class="id">s</span> <span class="id">i</span>) <span class="id">m</span>.<br/>
<br/>
<div class="doc">'composite_has_been_received' is decidable. </div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="composite_has_been_received_dec">composite_has_been_received_dec</a></span> : <span class="id">RelDecision</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#composite_has_been_received">composite_has_been_received</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof286')">Proof.</div>
<div class="proofscript" id="proof286">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">s</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">Decision_iff</span> (<span class="id">P</span>:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">List.Exists</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received">has_been_received</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.IM">IM</a></span> <span class="id">i</span>) (<span class="id">s</span> <span class="id">i</span>) <span class="id">m</span>) <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.index_listing">index_listing</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- <span class="id">exists_finite</span> <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.finite_index">finite_index</a></span>). <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">Exists_dec</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="composite_has_been_received_stepwise_props">composite_has_been_received_stepwise_props</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_stepwise_props">has_been_received_stepwise_props</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#composite_has_been_received">composite_has_been_received</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof287')">Proof.</div>
<div class="proofscript" id="proof287">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_stepwise_props">has_been_received_stepwise_props</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#composite_stepwise_props">composite_stepwise_props</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_stepwise_from_trace">has_been_received_stepwise_from_trace</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.composite_has_been_received.has_been_received_capabilities">has_been_received_capabilities</a></span> <span class="id">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> [<span class="id">Hinits</span> <span class="id">Hstep</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;[<span class="tactic">exact</span> <span class="id">Hinits</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;&lt;&lt;exact&nbsp;Hstep&gt;&gt;&nbsp;doesn't&nbsp;work&nbsp;because&nbsp;[composite_message_selector]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pattern&nbsp;matches&nbsp;on&nbsp;the&nbsp;label&nbsp;l,&nbsp;so&nbsp;we&nbsp;instantiate&nbsp;and&nbsp;destruct<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;let&nbsp;that&nbsp;simplify&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">l</span>;<span class="id">specialize</span> (<span class="id">Hstep</span> <span class="id">l</span>);<span class="tactic">destruct</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">Hstep</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="composite_has_been_received_capability">composite_has_been_received_capability</a></span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_capability">has_been_received_capability</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_capability_from_stepwise">has_been_received_capability_from_stepwise</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#composite_has_been_received_dec">composite_has_been_received_dec</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#composite_has_been_received_stepwise_props">composite_has_been_received_stepwise_props</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.composite_has_been_received">composite_has_been_received</a></span>.<br/>
<br/>
<br/>
<div class="doc">A message 'has_been_observed' for a composite state if it 'has_been_observed' for any of
  its components.</div>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="composite_has_been_observed">composite_has_been_observed</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id">exists</span> (<span class="id">i</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.index">index</a></span>), <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed">has_been_observed</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.IM">IM</a></span> <span class="id">i</span>) (<span class="id">s</span> <span class="id">i</span>) <span class="id">m</span>.<br/>
<br/>
<div class="doc">'composite_has_been_observed' is decidable. </div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="composite_has_been_observed_dec">composite_has_been_observed_dec</a></span> : <span class="id">RelDecision</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#composite_has_been_observed">composite_has_been_observed</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof288')">Proof.</div>
<div class="proofscript" id="proof288">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">s</span> <span class="id">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">Decision_iff</span> (<span class="id">P</span>:=<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">List.Exists</a></span> (<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed">has_been_observed</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.IM">IM</a></span> <span class="id">i</span>) (<span class="id">s</span> <span class="id">i</span>) <span class="id">m</span>) <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.index_listing">index_listing</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- <span class="id">exists_finite</span> <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.finite_index">finite_index</a></span>). <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">Exists_dec</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="composite_has_been_observed_stepwise_props">composite_has_been_observed_stepwise_props</a></span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#oracle_stepwise_props">oracle_stepwise_props</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#item_sends_or_receives">item_sends_or_receives</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#composite_has_been_observed">composite_has_been_observed</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof289')">Proof.</div>
<div class="proofscript" id="proof289">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#composite_stepwise_props">composite_stepwise_props</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">i</span> =&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_stepwise_props">has_been_observed_stepwise_props</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> [<span class="id">Hinits</span> <span class="id">Hstep</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>;[<span class="tactic">exact</span> <span class="id">Hinits</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">l</span>;<span class="id">specialize</span> (<span class="id">Hstep</span> <span class="id">l</span>);<span class="tactic">destruct</span> <span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">Hstep</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Global</span> <span class="kwd">Instance</span> <span class="id"><a name="composite_has_been_observed_capability">composite_has_been_observed_capability</a></span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_capability">has_been_observed_capability</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_dec">has_been_observed_dec</a></span> := <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#composite_has_been_observed_dec">composite_has_been_observed_dec</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_stepwise_props">has_been_observed_stepwise_props</a></span> := <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#composite_has_been_observed_stepwise_props">composite_has_been_observed_stepwise_props</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">validator</span> : <span class="kwd">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">A</span> : <span class="id">validator</span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.index">index</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sender</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.message">message</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">validator</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br/>
<br/>
<div class="doc">Definitions for safety and nontriviality of the <span class="bracket"><span class="id">sender</span></span> function.
      Safety means that if we designate a validator as the sender
      of a certain messsage, then it is impossible for other components
      to produce that message
      Weak/strong nontriviality say that each validator should
      be designated sender for at least one/all its protocol
      messages.
  *</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="sender_safety_prop">sender_safety_prop</a></span> : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">i</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.index">index</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.validator">validator</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hid</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.A">A</a></span> <span class="id">v</span> = <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hsender</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.sender">sender</a></span> <span class="id">m</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#can_emit">can_emit</a></span> (<span class="id"><a href="CasperCBC.VLSM.Composition.html#composite_vlsm_constrained_projection">composite_vlsm_constrained_projection</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.IM">IM</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.constraint">constraint</a></span> <span class="id">i</span>) <span class="id">m</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">j</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.index">index</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hdif</span> : <span class="id">i</span> &lt;&gt; <span class="id">j</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="CasperCBC.VLSM.Common.html#can_emit">can_emit</a></span> (<span class="id"><a href="CasperCBC.VLSM.Composition.html#composite_vlsm_constrained_projection">composite_vlsm_constrained_projection</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.IM">IM</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.constraint">constraint</a></span> <span class="id">j</span>) <span class="id">m</span>.<br/>
<br/>
<div class="doc">An alternative, possibly friendlier, formulation. Note that it is
       slightly weaker, in that it does not require that the sender
       is able to send the message. *</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="sender_safety_alt_prop">sender_safety_alt_prop</a></span> : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">i</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.index">index</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.validator">validator</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hsender</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.sender">sender</a></span> <span class="id">m</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#can_emit">can_emit</a></span> (<span class="id"><a href="CasperCBC.VLSM.Composition.html#composite_vlsm_constrained_projection">composite_vlsm_constrained_projection</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.IM">IM</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.constraint">constraint</a></span> <span class="id">i</span>) <span class="id">m</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.A">A</a></span> <span class="id">v</span> = <span class="id">i</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="sender_weak_nontriviality_prop">sender_weak_nontriviality_prop</a></span> : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">v</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.validator">validator</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.message">message</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#can_emit">can_emit</a></span> (<span class="id"><a href="CasperCBC.VLSM.Composition.html#composite_vlsm_constrained_projection">composite_vlsm_constrained_projection</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.IM">IM</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.constraint">constraint</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.A">A</a></span> <span class="id">v</span>)) <span class="id">m</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.sender">sender</a></span> <span class="id">m</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="sender_strong_nontriviality_prop">sender_strong_nontriviality_prop</a></span> : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">v</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.validator">validator</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.message">message</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#can_emit">can_emit</a></span> (<span class="id"><a href="CasperCBC.VLSM.Composition.html#composite_vlsm_constrained_projection">composite_vlsm_constrained_projection</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.IM">IM</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.constraint">constraint</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.A">A</a></span> <span class="id">v</span>)) <span class="id">m</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.sender">sender</a></span> <span class="id">m</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="no_sender_for_initial_message_prop">no_sender_for_initial_message_prop</a></span> : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.message">message</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#vinitial_message_prop">vinitial_message_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span> <span class="id">m</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.sender">sender</a></span> <span class="id">m</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_been_received_capabilities</span> : <span class="kwd">forall</span> <span class="id">i</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.index">index</a></span>, (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_capability">has_been_received_capability</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.IM">IM</a></span> <span class="id">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br/>
<br/>
<div class="doc">We say that a validator &lt;v&gt; (with associated component &lt;i&gt;) is equivocating wrt.
   to another component &lt;j&gt;, if there exists a message which <span class="bracket"><span class="id">has_been_received</span></span> by
   &lt;j&gt; but <span class="bracket"><span class="id">has_not_been_sent</span></span> by &lt;i&gt; *</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="equivocating_wrt">equivocating_wrt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.validator">validator</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.index">index</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">sv</span> <span class="id">sj</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">i</span> := <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.A">A</a></span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.message">message</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.sender">sender</a></span>(<span class="id">m</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_not_been_sent">has_not_been_sent</a></span>  (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.IM">IM</a></span> <span class="id">i</span>) <span class="id">sv</span> <span class="id">m</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received">has_been_received</a></span>  (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.IM">IM</a></span> <span class="id">j</span>) <span class="id">sj</span> <span class="id">m</span>.<br/>
<br/>
<div class="doc">We can now decide whether a validator is equivocating in a certain state. *</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="is_equivocating_statewise">is_equivocating_statewise</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.validator">validator</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">j</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.index">index</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">j</span> &lt;&gt; (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.A">A</a></span> <span class="id">v</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#equivocating_wrt">equivocating_wrt</a></span> <span class="id">v</span> <span class="id">j</span> (<span class="id">s</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.A">A</a></span> <span class="id">v</span>)) (<span class="id">s</span> <span class="id">j</span>).<br/>
<br/>
<div class="doc">An alternative definition for detecting equivocation in a certain state,
      which checks if for every <span class="bracket"><span class="id">protocol_trace</span></span> there exists equivocation
      involving the given validator
      Notably, this definition is not generally equivalent to <span class="bracket"><span class="id">is_equivocating_statewise</span></span>,
      which does not verify the order in which receiving and sending occurred.
  *</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="is_equivocating_tracewise">is_equivocating_tracewise</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.validator">validator</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> := <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.A">A</a></span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">tr</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_trace">protocol_trace</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">last</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">prefix</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hpr</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#trace_prefix">trace_prefix</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">tr</span>) <span class="id">last</span> <span class="id">prefix</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hlast</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#destination">destination</a></span> <span class="id">last</span> = <span class="id">s</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.message">message</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.sender">sender</a></span> <span class="id">m</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">List.Exists</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> (<span class="id">elem</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vtransition_item">vtransition_item</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#input">input</a></span> <span class="id">elem</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;/\ ~<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent">has_been_sent</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.IM">IM</a></span> <span class="id">j</span>) ((<span class="id"><a href="CasperCBC.VLSM.Common.html#destination">destination</a></span> <span class="id">elem</span>) <span class="id">j</span>) <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;) <span class="id">prefix</span>.<br/>
<br/>
<div class="doc">A possibly friendlier version using a previously defined primitive. *</div>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="is_equivocating_tracewise_alt">is_equivocating_tracewise_alt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">v</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.validator">validator</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">j</span> := <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.A">A</a></span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">tr</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_trace">protocol_trace</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">last</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">prefix</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hpr</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#trace_prefix">trace_prefix</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#proj1_sig">proj1_sig</a></span> <span class="id">tr</span>) <span class="id">last</span> <span class="id">prefix</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hlast</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#destination">destination</a></span> <span class="id">last</span> = <span class="id">s</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.message">message</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.sender">sender</a></span> <span class="id">m</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#equivocation_in_trace">equivocation_in_trace</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span> <span class="id">m</span> (<span class="id">prefix</span> ++ [<span class="id">last</span>]).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">validator_listing</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.validator">validator</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">finite_validator</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FinFun.html#Listing">Listing</a></span> <span class="id">validator_listing</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">measurable_V</span> : <span class="id">Measurable</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.validator">validator</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">threshold_V</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#ReachableThreshold">ReachableThreshold</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.validator">validator</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br/>
<div class="doc">For the equivocation sum fault to be computable, we require that
      our is_equivocating property is decidable. The current implementation
      refers to <span class="bracket"><span class="id">is_equivocating_statewise</span></span>, but this might change
      in the future *</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="equivocation_dec_statewise">equivocation_dec_statewise</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hdec</span> : <span class="id">RelDecision</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#is_equivocating_statewise">is_equivocating_statewise</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#basic_equivocation">basic_equivocation</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span>) (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.validator">validator</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_validators">state_validators</a></span> := <span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.validator_listing">validator_listing</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_validators_nodup">state_validators_nodup</a></span> := <span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.finite_validator">finite_validator</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#is_equivocating">is_equivocating</a></span> := <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#is_equivocating_statewise">is_equivocating_statewise</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#is_equivocating_dec">is_equivocating_dec</a></span> := <span class="id">Hdec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|}.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="equivocation_dec_tracewise">equivocation_dec_tracewise</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hdec</span> : <span class="id">RelDecision</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#is_equivocating_tracewise">is_equivocating_tracewise</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#basic_equivocation">basic_equivocation</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span>) (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.validator">validator</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_validators">state_validators</a></span> := <span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.validator_listing">validator_listing</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_validators_nodup">state_validators_nodup</a></span> := <span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.finite_validator">finite_validator</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#is_equivocating">is_equivocating</a></span> := <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#is_equivocating_tracewise">is_equivocating_tracewise</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#is_equivocating_dec">is_equivocating_dec</a></span> := <span class="id">Hdec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|}.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="equivocation_fault_constraint">equivocation_fault_constraint</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Dec</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#basic_equivocation">basic_equivocation</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span>) <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.validator">validator</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vlabel">vlabel</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">som</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">s</span>', <span class="id">om</span>') := (<span class="id"><a href="CasperCBC.VLSM.Common.html#vtransition">vtransition</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span> <span class="id">l</span> <span class="id">som</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#not_heavy">not_heavy</a></span> <span class="id">s</span>'.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="sent_component_protocol_composed">sent_component_protocol_composed</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">i</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.index">index</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hsent</span> : (@<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent">has_been_sent</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.has_been_sent_capabilities">has_been_sent_capabilities</a></span> <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> <span class="id">i</span>) <span class="id">m</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_message_prop">protocol_message_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof290')">Proof.</div>
<div class="proofscript" id="proof290">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hcomp</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent">has_been_sent</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span> <span class="id">s</span> <span class="id">m</span>) <span class="tactic">by</span> (<span class="id">exists</span> <span class="id">i</span>; <span class="tactic">intuition</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span>) <span class="id">s</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_protocol_state_prop">pre_loaded_with_all_messages_protocol_state_prop</a></span>; <span class="tactic">intuition</span>).<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_has_trace">protocol_state_has_trace</a></span> <span class="kwd">in</span> <span class="id">Hs</span> <span class="kwd">as</span> <span class="id">H</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>' <span class="kwd">as</span> [<span class="id">is</span> [<span class="id">tr</span> <span class="id">Hpr</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hpr_pre</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_init_to">finite_protocol_trace_init_to</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span>) <span class="id">is</span> <span class="id">s</span> <span class="id">tr</span>). {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hpr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM_incl_finite_protocol_trace_init_to">VLSM_incl_finite_protocol_trace_init_to</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#vlsm_incl_pre_loaded_with_all_messages_vlsm">vlsm_incl_pre_loaded_with_all_messages_vlsm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_trace_output_is_protocol">protocol_trace_output_is_protocol</a></span> <span class="kwd">with</span> (<span class="id">is0</span> := <span class="id">is</span>) (<span class="id">tr0</span> := <span class="id">tr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#ptrace_forget_last">ptrace_forget_last</a></span> <span class="kwd">in</span> <span class="id">Hpr</span>; <span class="tactic">apply</span> <span class="id">Hpr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_sent">proper_sent</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>) <span class="kwd">in</span> <span class="id">Hcomp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id">Hcomp</span> <span class="id">is</span> <span class="id">tr</span> <span class="id">Hpr_pre</span>).<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="received_component_protocol_composed">received_component_protocol_composed</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">i</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.index">index</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hreceived</span> : (@<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received">has_been_received</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.has_been_received_capabilities">has_been_received_capabilities</a></span> <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> <span class="id">i</span>) <span class="id">m</span>)) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_message_prop">protocol_message_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof291')">Proof.</div>
<div class="proofscript" id="proof291">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hcomp</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received">has_been_received</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span> <span class="id">s</span> <span class="id">m</span>) <span class="tactic">by</span> (<span class="id">exists</span> <span class="id">i</span>; <span class="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span>) <span class="id">s</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_protocol_state_prop">pre_loaded_with_all_messages_protocol_state_prop</a></span>; <span class="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_has_trace">protocol_state_has_trace</a></span> <span class="kwd">in</span> <span class="id">Hs</span> <span class="kwd">as</span> [<span class="id">is</span> [<span class="id">tr</span> <span class="id">Hpr</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hpr_pre</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_init_to">finite_protocol_trace_init_to</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span>) <span class="id">is</span> <span class="id">s</span> <span class="id">tr</span>). {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hpr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM_incl_finite_protocol_trace_init_to">VLSM_incl_finite_protocol_trace_init_to</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#vlsm_incl_pre_loaded_with_all_messages_vlsm">vlsm_incl_pre_loaded_with_all_messages_vlsm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (@<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_received">proper_received</a></span> <span class="id">_</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite.X">X</a></span> <span class="id">_</span> <span class="id">s</span> <span class="id">H</span> <span class="id">m</span>) <span class="kwd">as</span> <span class="id">Hprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_prop">has_been_received_prop</a></span> <span class="kwd">in</span> <span class="id">Hprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#all_traces_have_message_prop">all_traces_have_message_prop</a></span> <span class="kwd">in</span> <span class="id">Hprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hprop</span> <span class="kwd">in</span> <span class="id">Hcomp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hcomp</span> <span class="id">is</span> <span class="id">tr</span> <span class="id">Hpr_pre</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hpr</span> <span class="kwd">as</span> [<span class="id">Hpr</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#ptrace_forget_last">ptrace_forget_last</a></span> <span class="kwd">in</span> <span class="id">Hpr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_trace_input_is_protocol">protocol_trace_input_is_protocol</a></span> <span class="kwd">with</span> (<span class="id">is0</span> := <span class="id">is</span>) (<span class="id">tr0</span> := <span class="id">tr</span>);<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<span class="kwd">End</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#Composite">Composite</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="cannot_resend_message">cannot_resend_message</a></span>.<br/>
<span class="kwd">Context</span><br/>
&nbsp;&nbsp;{<span class="id">message</span> : <span class="kwd">Type</span>}<br/>
&nbsp;&nbsp;`{<span class="id">EqDecision</span> <span class="id">message</span>}<br/>
&nbsp;&nbsp;(<span class="id">X</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>)<br/>
&nbsp;&nbsp;(<span class="id">PreX</span> := <span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id">X</span>)<br/>
&nbsp;&nbsp;{<span class="id">Hbs</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_capability">has_been_sent_capability</a></span> <span class="id">X</span>}<br/>
&nbsp;&nbsp;{<span class="id">Hbr</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_capability">has_been_received_capability</a></span> <span class="id">X</span>}<br/>
&nbsp;&nbsp;.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="state_received_not_sent">state_received_not_sent</a></span> (<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>) (<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.message">message</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received">has_been_received</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.X">X</a></span> <span class="id">s</span> <span class="id">m</span> /\ ~ <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent">has_been_sent</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.X">X</a></span> <span class="id">s</span> <span class="id">m</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="state_received_not_sent_trace_iff">state_received_not_sent_trace_iff</a></span><br/>
&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.message">message</a></span>)<br/>
&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;(<span class="id">is</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;(<span class="id">tr</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span>)<br/>
&nbsp;&nbsp;(<span class="id">Htr</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_init_to">finite_protocol_trace_init_to</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.PreX">PreX</a></span> <span class="id">is</span> <span class="id">s</span> <span class="id">tr</span>)<br/>
&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_received_not_sent">state_received_not_sent</a></span> <span class="id">s</span> <span class="id">m</span> &lt;-&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#trace_received_not_sent_before_or_after">trace_received_not_sent_before_or_after</a></span> <span class="id">tr</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof292')">Proof.</div>
<div class="proofscript" id="proof292">
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.PreX">PreX</a></span> <span class="id">s</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="kwd">in</span> <span class="id">Htr</span>.  <span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#ptrace_last_pstate">ptrace_last_pstate</a></span> <span class="kwd">in</span> <span class="id">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span> [<span class="id">Hbrm</span> <span class="id">Hnbsm</span>].<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_received">proper_received</a></span> <span class="kwd">in</span> <span class="id">Hbrm</span>; [|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hbrm</span> <span class="id">is</span> <span class="id">tr</span> <span class="id">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">Hbsm</span>. <span class="tactic">elim</span> <span class="id">Hnbsm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_sent">proper_sent</a></span>; [<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_consistency">has_been_sent_consistency</a></span>; [<span class="tactic">assumption</span>| <span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">is</span>, <span class="id">tr</span>, <span class="id">Htr</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_received">proper_received</a></span>; [<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_consistency">has_been_received_consistency</a></span>; [<span class="tactic">assumption</span>| <span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">is</span>, <span class="id">tr</span>, <span class="id">Htr</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intro</span> <span class="id">Hbsm</span>. <span class="tactic">elim</span> <span class="id">Hnbsm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_sent">proper_sent</a></span> <span class="kwd">in</span> <span class="id">Hbsm</span>; [|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">spec</span> <span class="id">Hbsm</span> <span class="id">is</span> <span class="id">tr</span> <span class="id">Htr</span>. <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="state_received_not_sent_invariant">state_received_not_sent_invariant</a></span><br/>
&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;(<span class="id">P</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.message">message</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;:= <span class="kwd">forall</span> <span class="id">m</span>, <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_received_not_sent">state_received_not_sent</a></span> <span class="id">s</span> <span class="id">m</span> -&gt; <span class="id">P</span> <span class="id">m</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="state_received_not_sent_invariant_trace_iff">state_received_not_sent_invariant_trace_iff</a></span><br/>
&nbsp;&nbsp;(<span class="id">P</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.message">message</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;(<span class="id">is</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;(<span class="id">tr</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span>)<br/>
&nbsp;&nbsp;(<span class="id">Htr</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_init_to">finite_protocol_trace_init_to</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.PreX">PreX</a></span> <span class="id">is</span> <span class="id">s</span> <span class="id">tr</span>)<br/>
&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_received_not_sent_invariant">state_received_not_sent_invariant</a></span> <span class="id">s</span> <span class="id">P</span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#trace_received_not_sent_before_or_after_invariant">trace_received_not_sent_before_or_after_invariant</a></span> <span class="id">tr</span> <span class="id">P</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof293')">Proof.</div>
<div class="proofscript" id="proof293">
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span> <span class="id">Hinv</span> <span class="id">m</span> <span class="id">Hm</span><br/>
&nbsp;&nbsp;; <span class="tactic">apply</span> <span class="id">Hinv</span><br/>
&nbsp;&nbsp;; <span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_received_not_sent_trace_iff">state_received_not_sent_trace_iff</a></span> <span class="id">m</span> <span class="id">s</span> <span class="id">is</span> <span class="id">tr</span> <span class="id">Htr</span>)<br/>
&nbsp;&nbsp;; <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="cannot_resend_message_stepwise_prop">cannot_resend_message_stepwise_prop</a></span> : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">s</span> <span class="id">oim</span> <span class="id">s</span>' <span class="id">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_transition">protocol_transition</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.X">X</a></span>) <span class="id">l</span> (<span class="id">s</span>,<span class="id">oim</span>) (<span class="id">s</span>',<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;~<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent">has_been_sent</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.X">X</a></span> <span class="id">s</span> <span class="id">m</span> /\ ~<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received">has_been_received</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.X">X</a></span> <span class="id">s</span>' <span class="id">m</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="cannot_resend_received_message_in_future">cannot_resend_received_message_in_future</a></span><br/>
&nbsp;&nbsp;(<span class="id">Hno_resend</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message_stepwise_prop">cannot_resend_message_stepwise_prop</a></span>)<br/>
&nbsp;&nbsp;(<span class="id">s1</span> <span class="id">s2</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;(<span class="id">Hfuture</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#in_futures">in_futures</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.PreX">PreX</a></span> <span class="id">s1</span> <span class="id">s2</span>)<br/>
&nbsp;&nbsp;: <span class="kwd">forall</span> <span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.message">message</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_received_not_sent">state_received_not_sent</a></span> <span class="id">s1</span> <span class="id">m</span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_received_not_sent">state_received_not_sent</a></span> <span class="id">s2</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof294')">Proof.</div>
<div class="proofscript" id="proof294">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">m</span> <span class="id">Hm</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hfuture</span> <span class="kwd">as</span> [<span class="id">tr2</span> <span class="id">Htr2</span>].<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">Htr2</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">IHHtr2</span>;<span class="tactic">clear</span> <span class="id">IHHtr2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_step_update">has_been_received_step_update</a></span> <span class="id">H</span> <span class="id">m</span>) <span class="kwd">as</span> <span class="id">Hrupd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_step_update">has_been_sent_step_update</a></span> <span class="id">H</span> <span class="id">m</span>) <span class="kwd">as</span> <span class="id">Hmupd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hm</span> <span class="kwd">as</span> [<span class="id">Hr</span> <span class="id">Hs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#or_intror">or_intror</a></span> <span class="kwd">in</span> <span class="id">Hr</span>; <span class="tactic">apply</span> <span class="id">Hrupd</span> <span class="kwd">in</span> <span class="id">Hr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">intros</span> [-&gt;|]%<span class="id">Hmupd</span>;[|<span class="tactic">apply</span> <span class="id">Hs</span>;<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hno_resend</span> <span class="kwd">in</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">_</span> []].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hno_resend</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message_stepwise_prop">cannot_resend_message_stepwise_prop</a></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="lift_preloaded_trace_to_seeded">lift_preloaded_trace_to_seeded</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.message">message</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">tr</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#transition_item">transition_item</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Htrm</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#trace_received_not_sent_before_or_after_invariant">trace_received_not_sent_before_or_after_invariant</a></span> <span class="id">tr</span> <span class="id">P</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">is</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Htr</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace">finite_protocol_trace</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.PreX">PreX</a></span> <span class="id">is</span> <span class="id">tr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace">finite_protocol_trace</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_vlsm">pre_loaded_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.X">X</a></span> <span class="id">P</span>) <span class="id">is</span> <span class="id">tr</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof295')">Proof.</div>
<div class="proofscript" id="proof295">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#trace_received_not_sent_before_or_after_invariant">trace_received_not_sent_before_or_after_invariant</a></span> <span class="kwd">in</span> <span class="id">Htrm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [|<span class="tactic">apply</span> <span class="id">Htr</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">tr</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#rev_ind">rev_ind</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#finite_ptrace_empty">finite_ptrace_empty</a></span>  (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_vlsm">pre_loaded_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.X">X</a></span> <span class="id">P</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#initial_is_protocol">initial_is_protocol</a></span>. <span class="tactic">apply</span> <span class="id">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">assert</span> (<span class="id">Htr</span>' := <span class="id">Htr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htr</span> <span class="kwd">as</span> [<span class="id">Htr</span> <span class="id">Hinit</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_from_app_iff">finite_protocol_trace_from_app_iff</a></span> <span class="kwd">in</span> <span class="id">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htr</span> <span class="kwd">as</span> [<span class="id">Htr</span> <span class="id">Hx</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#ptrace_add_last">ptrace_add_last</a></span> <span class="kwd">in</span> <span class="id">Htr</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;[|<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_trace_last_is_last">finite_trace_last_is_last</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">spec</span> <span class="id">IHtr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span> <span class="id">m</span> [<span class="id">Hbrm</span> <span class="id">Hnbsm</span>]. <span class="tactic">apply</span> <span class="id">Htrm</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_app">Exists_app</a></span>. <span class="id">left</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#trace_has_message">trace_has_message</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_app">Exists_app</a></span>. <span class="tactic">intros</span> [<span class="id">contra</span>|<span class="id">contra</span>]; [<span class="id">contradiction</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">contra</span>; [|<span class="tactic">inversion</span> <span class="id">H0</span>]. <span class="tactic">subst</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">Hx</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_from">finite_protocol_trace_from</a></span> <span class="id">_</span> ?<span class="id">l</span> <span class="id">_</span> =&gt; <span class="id">remember</span> <span class="id">l</span> <span class="kwd">as</span> <span class="id">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span> <span class="kwd">as</span> (<span class="id">l</span>, <span class="id">iom</span>, <span class="id">s0</span>, <span class="id">oom</span>). <span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#first_transition_valid">first_transition_valid</a></span> <span class="kwd">in</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_transition_destination">protocol_transition_destination</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.PreX">PreX</a></span> <span class="id">Hx</span>) <span class="kwd">as</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">subst</span> <span class="id">oom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.Hno_resend">Hno_resend</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hx</span>) <span class="kwd">as</span> <span class="id">Hnrs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hnrs</span> <span class="kwd">as</span> [<span class="id">_</span> <span class="id">Hnrs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">Hnrs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_received">proper_received</a></span>; [<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_consistency">has_been_received_consistency</a></span>; [<span class="tactic">assumption</span>|<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">is</span>,<span class="id">_</span>,<span class="id">Htr</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_app">Exists_app</a></span>. <span class="id">left</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHtr</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">Htr</span> <span class="id">Hinit</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_from_app_iff">finite_protocol_trace_from_app_iff</a></span> ((<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_vlsm">pre_loaded_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.X">X</a></span> <span class="id">P</span>) )).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_ptrace_last_pstate">finite_ptrace_last_pstate</a></span> <span class="kwd">in</span> <span class="id">IHtr</span> <span class="kwd">as</span> <span class="id">Hlst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">Hx</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_protocol_trace_from">finite_protocol_trace_from</a></span> <span class="id">_</span> ?<span class="id">s</span> <span class="id">_</span> =&gt; <span class="id">remember</span> <span class="id">s</span> <span class="kwd">as</span> <span class="id">tr_last</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">Hlst</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id">_</span> ?<span class="id">l</span> =&gt; <span class="tactic">replace</span> <span class="id">l</span> <span class="kwd">with</span> <span class="id">tr_last</span> <span class="kwd">in</span> *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> [<span class="id">x</span>] <span class="kwd">with</span> ([] ++ [<span class="id">x</span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">Hx</span>. <span class="tactic">subst</span> <span class="id">s</span>' <span class="id">tl</span>. <span class="tactic">clear</span> <span class="id">Hx</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#destination">destination</a></span> <span class="id">x</span>) <span class="kwd">with</span> <span class="id">s</span> <span class="kwd">in</span> <span class="id">Htr</span>' <span class="tactic">by</span> (<span class="tactic">subst</span> <span class="id">x</span>;<span class="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#extend_right_finite_trace_from">extend_right_finite_trace_from</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_vlsm">pre_loaded_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.X">X</a></span> <span class="id">P</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#finite_ptrace_empty">finite_ptrace_empty</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_vlsm">pre_loaded_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.X">X</a></span> <span class="id">P</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">simpl</span>. <span class="tactic">split</span>; [|<span class="tactic">apply</span> <span class="id">H3</span>]. <span class="tactic">split</span>; [<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span> <span class="id">H3</span>) <span class="kwd">as</span> [[<span class="id">_</span> [<span class="id">_</span> <span class="id">Hv</span>]] <span class="id">_</span>]. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [|<span class="tactic">apply</span> <span class="id">Hv</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">iom</span> <span class="kwd">as</span> [<span class="id">m</span>|]; [|<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#option_protocol_message_None">option_protocol_message_None</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#option_protocol_message_Some">option_protocol_message_Some</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hdec</span> : <span class="id">Decision</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">List.Exists</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#field_selector">field_selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#output">output</a></span> <span class="id">m</span>) (<span class="id">tr</span> ++ [<span class="id">x</span>]))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> (@<span class="id">Exists_dec</span> <span class="id">_</span>). <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">decide_eq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">decide</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists">List.Exists</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#field_selector">field_selector</a></span> <span class="id"><a href="CasperCBC.VLSM.Common.html#output">output</a></span> <span class="id">m</span>) (<span class="id">tr</span> ++ [<span class="id">x</span>]))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_app">Exists_app</a></span> <span class="kwd">in</span> <span class="id">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">e</span> <span class="kwd">as</span> [<span class="id">e</span>|<span class="id">e</span>]; [<span class="tactic">apply</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_trace_output_is_protocol">protocol_trace_output_is_protocol</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">IHtr</span> <span class="id">_</span> <span class="id">e</span>)|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">e</span>; [|<span class="tactic">inversion</span> <span class="id">H1</span>]. <span class="tactic">subst</span> <span class="id">x0</span> <span class="id">l0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">subst</span> <span class="id">oom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_transition_destination">protocol_transition_destination</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.PreX">PreX</a></span> <span class="id">H3</span>) <span class="kwd">as</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.Hno_resend">Hno_resend</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H3</span> <span class="kwd">as</span> [<span class="id">_</span> <span class="id">Hnrs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">Hnrs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_received">proper_received</a></span>; [<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_consistency">has_been_received_consistency</a></span>; [<span class="tactic">assumption</span>|<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">is</span>,(<span class="id">tr</span> ++ [<span class="id">x</span>]),<span class="id">Htr</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_app">Exists_app</a></span>. <span class="id">right</span>. <span class="id">constructor</span>. <span class="tactic">subst</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">spec</span> <span class="id">Htrm</span> <span class="id">m</span>. <span class="id">spec</span> <span class="id">Htrm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">split</span>; [| <span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#Exists_app">Exists_app</a></span>. <span class="id">right</span>. <span class="id">left</span>. <span class="tactic">subst</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_message_prop_iff">protocol_message_prop_iff</a></span>. <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#vinitial_message_prop">vinitial_message_prop</a></span> ((<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_vlsm">pre_loaded_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.X">X</a></span> <span class="id">P</span>)) <span class="id">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intro</span> <span class="id">Hm</span>. <span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">_</span> <span class="id">m</span> <span class="id">Hm</span>). <span class="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="lift_preloaded_state_to_seeded">lift_preloaded_state_to_seeded</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.message">message</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hequiv_s</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_received_not_sent_invariant">state_received_not_sent_invariant</a></span> <span class="id">s</span> <span class="id">P</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.PreX">PreX</a></span> <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_vlsm">pre_loaded_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.X">X</a></span> <span class="id">P</span>) <span class="id">s</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof296')">Proof.</div>
<div class="proofscript" id="proof296">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_has_trace">protocol_state_has_trace</a></span> <span class="kwd">in</span> <span class="id">Hs</span> <span class="kwd">as</span> <span class="id">Htr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Htr</span> <span class="kwd">as</span> [<span class="id">is</span> [<span class="id">tr</span> <span class="id">Htr</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#lift_preloaded_trace_to_seeded">lift_preloaded_trace_to_seeded</a></span> <span class="id">P</span> <span class="id">tr</span>) <span class="kwd">as</span> <span class="id">Hlift</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">spec</span> <span class="id">Hlift</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">revert</span> <span class="id">Hequiv_s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_received_not_sent_invariant_trace_iff">state_received_not_sent_invariant_trace_iff</a></span> <span class="kwd">with</span> <span class="id">is</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hlift</span> <span class="id">_</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#ptrace_forget_last">ptrace_forget_last</a></span> <span class="id">Htr</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="kwd">in</span> <span class="id">Hlift</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#finite_ptrace_last_pstate">finite_ptrace_last_pstate</a></span> <span class="kwd">in</span> <span class="id">Hlift</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="CasperCBC.VLSM.Common.html#ptrace_get_last">ptrace_get_last</a></span> <span class="id">Htr</span>). <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="lift_generated_to_seeded">lift_generated_to_seeded</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.message">message</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hequiv_s</span>: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_received_not_sent_invariant">state_received_not_sent_invariant</a></span> <span class="id">s</span> <span class="id">P</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hgen</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_generated_prop">protocol_generated_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.PreX">PreX</a></span> <span class="id">s</span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_generated_prop">protocol_generated_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_vlsm">pre_loaded_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message.X">X</a></span> <span class="id">P</span>) <span class="id">s</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof297')">Proof.</div>
<div class="proofscript" id="proof297">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#non_empty_protocol_trace_from_protocol_generated_prop">non_empty_protocol_trace_from_protocol_generated_prop</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#non_empty_protocol_trace_from_protocol_generated_prop">non_empty_protocol_trace_from_protocol_generated_prop</a></span> <span class="kwd">in</span> <span class="id">Hgen</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hgen</span> <span class="kwd">as</span> [<span class="id">is</span> [<span class="id">tr</span> [<span class="id">item</span> [<span class="id">Htr</span> <span class="id">Hgen</span>]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">is</span>, <span class="id">tr</span>, <span class="id">item</span>. <span class="tactic">split</span>; [|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#lift_preloaded_trace_to_seeded">lift_preloaded_trace_to_seeded</a></span> <span class="id">P</span> <span class="id">tr</span>) <span class="kwd">as</span> <span class="id">Hlift</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">spec</span> <span class="id">Hlift</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">revert</span> <span class="id">Hequiv_s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_received_not_sent_invariant_trace_iff">state_received_not_sent_invariant_trace_iff</a></span> <span class="kwd">with</span> <span class="id">is</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#ptrace_add_last">ptrace_add_last</a></span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#last_error_destination_last">last_error_destination_last</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hgen</span> <span class="kwd">as</span> [<span class="id">Hlst</span> [<span class="id">Hs</span> <span class="id">_</span>]]. <span class="tactic">rewrite</span> <span class="id">Hlst</span>. <span class="tactic">subst</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hlift</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message">cannot_resend_message</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="full_node_constraint">full_node_constraint</a></span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span> {<span class="id">message</span> : <span class="kwd">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<span class="id">EqDecision</span> <span class="id">message</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">index</span> : <span class="kwd">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">IndEqDec</span> : <span class="id">EqDecision</span> <span class="id">index</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">IM</span> : <span class="id">index</span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">i0</span> : <span class="id">Inhabited</span> <span class="id">index</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X</span> := <span class="id"><a href="CasperCBC.VLSM.Composition.html#free_composite_vlsm">free_composite_vlsm</a></span> <span class="id">IM</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_been_sent_capabilities</span> : <span class="kwd">forall</span> <span class="id">i</span> : <span class="id">index</span>, (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_capability">has_been_sent_capability</a></span> (<span class="id">IM</span> <span class="id">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_been_received_capabilities</span> : <span class="kwd">forall</span> <span class="id">i</span> : <span class="id">index</span>, (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_capability">has_been_received_capability</a></span> (<span class="id">IM</span> <span class="id">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">index_listing</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">index</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">finite_index</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FinFun.html#Listing">Listing</a></span> <span class="id">index_listing</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X_has_been_sent_capability</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_capability">has_been_sent_capability</a></span> <span class="id">X</span> := <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#composite_has_been_sent_capability">composite_has_been_sent_capability</a></span> <span class="id">IM</span> (<span class="id"><a href="CasperCBC.VLSM.Composition.html#free_constraint">free_constraint</a></span> <span class="id">IM</span>) <span class="id">finite_index</span> <span class="id">has_been_sent_capabilities</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X_has_been_received_capability</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_capability">has_been_received_capability</a></span> <span class="id">X</span> := <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#composite_has_been_received_capability">composite_has_been_received_capability</a></span> <span class="id">IM</span> (<span class="id"><a href="CasperCBC.VLSM.Composition.html#free_constraint">free_constraint</a></span> <span class="id">IM</span>) <span class="id">finite_index</span> <span class="id">has_been_received_capabilities</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X_has_been_observed_capability</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_capability">has_been_observed_capability</a></span> <span class="id">X</span> := <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_observed_capability_from_sent_received">has_been_observed_capability_from_sent_received</a></span> <span class="id">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">admissible_index</span> : <span class="id"><a href="CasperCBC.VLSM.Composition.html#composite_state">composite_state</a></span> <span class="id">IM</span> -&gt; <span class="id">index</span> -&gt; <span class="kwd">Prop</span>)<br/>
<div class="doc">admissible equivocator index: this index can equivocate from given state </div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br/>
<br/>
&nbsp;&nbsp;<span class="id">Existing</span> <span class="kwd">Instance</span> <span class="id">X_has_been_observed_capability</span>.<br/>
&nbsp;&nbsp;<span class="id">Existing</span> <span class="kwd">Instance</span> <span class="id">X_has_been_sent_capability</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="node_generated_without_further_equivocation">node_generated_without_further_equivocation</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Composition.html#composite_state">composite_state</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.IM">IM</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">i</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.index">index</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id">exists</span> (<span class="id">si</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#vstate">vstate</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.IM">IM</a></span> <span class="id">i</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_generated_prop">protocol_generated_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.IM">IM</a></span> <span class="id">i</span>)) <span class="id">si</span> <span class="id">m</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#state_received_not_sent_invariant">state_received_not_sent_invariant</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.IM">IM</a></span> <span class="id">i</span>) <span class="id">si</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_additional_equivocations">no_additional_equivocations</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.X">X</a></span> <span class="id">s</span>).<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="node_generated_without_further_equivocation_alt">node_generated_without_further_equivocation_alt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Composition.html#composite_state">composite_state</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.IM">IM</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">i</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.index">index</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id"><a href="CasperCBC.VLSM.Common.html#can_emit">can_emit</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_vlsm">pre_loaded_vlsm</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.IM">IM</a></span> <span class="id">i</span>) (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_additional_equivocations">no_additional_equivocations</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.X">X</a></span> <span class="id">s</span>)) <span class="id">m</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="full_node_condition_for_admissible_equivocators">full_node_condition_for_admissible_equivocators</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="CasperCBC.VLSM.Composition.html#composite_label">composite_label</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.IM">IM</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">som</span> : <span class="id"><a href="CasperCBC.VLSM.Composition.html#composite_state">composite_state</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.IM">IM</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_additional_equivocations_constraint">no_additional_equivocations_constraint</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.X">X</a></span> <span class="id">l</span> <span class="id">som</span> \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">s</span>, <span class="id">om</span>) := <span class="id">som</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m</span>, <span class="id">om</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">i</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.index">index</a></span>), <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.admissible_index">admissible_index</a></span> <span class="id">s</span> <span class="id">i</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#node_generated_without_further_equivocation">node_generated_without_further_equivocation</a></span> <span class="id">s</span> <span class="id">m</span> <span class="id">i</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="full_node_condition_for_admissible_equivocators_alt">full_node_condition_for_admissible_equivocators_alt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="CasperCBC.VLSM.Composition.html#composite_label">composite_label</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.IM">IM</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">som</span> : <span class="id"><a href="CasperCBC.VLSM.Composition.html#composite_state">composite_state</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.IM">IM</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="kwd">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_additional_equivocations_constraint">no_additional_equivocations_constraint</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.X">X</a></span> <span class="id">l</span> <span class="id">som</span> \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">s</span>, <span class="id">om</span>) := <span class="id">som</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m</span>, <span class="id">om</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">i</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.index">index</a></span>), <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.admissible_index">admissible_index</a></span> <span class="id">s</span> <span class="id">i</span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#node_generated_without_further_equivocation_alt">node_generated_without_further_equivocation_alt</a></span> <span class="id">s</span> <span class="id">m</span> <span class="id">i</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="node_generated_without_further_equivocation_alt_iff">node_generated_without_further_equivocation_alt_iff</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">i</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.index">index</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hno_resend</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message_stepwise_prop">cannot_resend_message_stepwise_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.IM">IM</a></span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span>: <span class="id"><a href="CasperCBC.VLSM.Composition.html#composite_state">composite_state</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.IM">IM</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span>: <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> (<span class="id"><a href="CasperCBC.VLSM.Composition.html#free_composite_vlsm">free_composite_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.IM">IM</a></span>)) <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hsmi</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#node_generated_without_further_equivocation">node_generated_without_further_equivocation</a></span> <span class="id">s</span> <span class="id">m</span> <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#node_generated_without_further_equivocation_alt">node_generated_without_further_equivocation_alt</a></span> <span class="id">s</span> <span class="id">m</span> <span class="id">i</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof298')">Proof.</div>
<div class="proofscript" id="proof298">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hsmi</span> <span class="kwd">as</span> [<span class="id">si</span> [<span class="id">Hsim</span> <span class="id">Hsi</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#can_emit_iff">can_emit_iff</a></span>. <span class="id">exists</span> <span class="id">si</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hsim</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#lift_generated_to_seeded">lift_generated_to_seeded</a></span> <span class="kwd">with</span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.has_been_sent_capabilities">has_been_sent_capabilities</a></span> <span class="id">i</span>)  (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.has_been_received_capabilities">has_been_received_capabilities</a></span> <span class="id">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<div class="doc">if all machines satisty the <span class="bracket"><span class="id">cannot_resend_message_stepwise_prop</span></span>erty,
  then the <span class="bracket"><span class="id">full_node_condition_for_admissible_equivocators</span></span> is stronger than
  the <span class="bracket"><span class="id">full_node_condition_for_admissible_equivocators_alt</span></span>.
  </div>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="full_node_condition_for_admissible_equivocators_subsumption">full_node_condition_for_admissible_equivocators_subsumption</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hno_resend</span> : <span class="kwd">forall</span> <span class="id">i</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.index">index</a></span>, <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#cannot_resend_message_stepwise_prop">cannot_resend_message_stepwise_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.IM">IM</a></span> <span class="id">i</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Composition.html#preloaded_constraint_subsumption">preloaded_constraint_subsumption</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint.IM">IM</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_condition_for_admissible_equivocators">full_node_condition_for_admissible_equivocators</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_condition_for_admissible_equivocators_alt">full_node_condition_for_admissible_equivocators_alt</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof299')">Proof.</div>
<div class="proofscript" id="proof299">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">s</span> <span class="id">Hs</span> <span class="id">l</span> <span class="id">om</span> [<span class="id">Hno_equiv</span> | <span class="id">Hfull</span>]; [<span class="id">left</span>; <span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hfull</span> <span class="kwd">as</span> [<span class="id">m</span> [<span class="id">Hom</span> [<span class="id">i</span> [<span class="id">Hi</span> <span class="id">Hfull</span>]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">om</span>. <span class="id">exists</span> <span class="id">m</span>. <span class="tactic">split</span>; [<span class="tactic">reflexivity</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">i</span>. <span class="tactic">split</span>; [<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hno_resend</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#node_generated_without_further_equivocation_alt_iff">node_generated_without_further_equivocation_alt_iff</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#full_node_constraint">full_node_constraint</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="seeded_composite_vlsm_no_equivocation">seeded_composite_vlsm_no_equivocation</a></span>.<br/>
<br/>
<h2> Pre-loading a VLSM composition with no equivocations constraint
When adding initial messages to a VLSM composition with a no equivocation
constraint, we cannot simply use the <span class="bracket"><span class="id">pre_loaded_vlsm</span></span> construct
because the no-equivocation constraint must also be altered to reflect that
the newly added initial messages are safe to be received at all times.
</h2>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">message</span> : <span class="kwd">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">index</span> : <span class="kwd">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">IndEqDec</span> : <span class="id">EqDecision</span> <span class="id">index</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">IM</span> : <span class="id">index</span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">i0</span> : <span class="id">Inhabited</span> <span class="id">index</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">constraint</span> : <span class="id"><a href="CasperCBC.VLSM.Composition.html#composite_label">composite_label</a></span> <span class="id">IM</span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Composition.html#composite_state">composite_state</a></span> <span class="id">IM</span>  * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">message</span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X</span> := <span class="id"><a href="CasperCBC.VLSM.Composition.html#free_composite_vlsm">free_composite_vlsm</a></span> <span class="id">IM</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_been_sent_capabilities</span> : <span class="kwd">forall</span> <span class="id">i</span> : <span class="id">index</span>, (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_capability">has_been_sent_capability</a></span> (<span class="id">IM</span> <span class="id">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_been_received_capabilities</span> : <span class="kwd">forall</span> <span class="id">i</span> : <span class="id">index</span>, (<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_received_capability">has_been_received_capability</a></span> (<span class="id">IM</span> <span class="id">i</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">index_listing</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">index</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">finite_index</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.FinFun.html#Listing">Listing</a></span> <span class="id">index_listing</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X_has_been_sent_capability</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_capability">has_been_sent_capability</a></span> <span class="id">X</span> := <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#composite_has_been_sent_capability">composite_has_been_sent_capability</a></span> <span class="id">IM</span> (<span class="id"><a href="CasperCBC.VLSM.Composition.html#free_constraint">free_constraint</a></span> <span class="id">IM</span>) <span class="id">finite_index</span> <span class="id">has_been_sent_capabilities</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;.<br/>
<br/>
&nbsp;&nbsp;<span class="id">Existing</span> <span class="kwd">Instance</span> <span class="id">X_has_been_sent_capability</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Section</span> <span class="id"><a name="seeded_composite_vlsm_no_equivocation.seeded_composite_vlsm_no_equivocation_definition">seeded_composite_vlsm_no_equivocation_definition</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Context</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">seed</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation.message">message</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br/>
<br/>
<div class="doc">Constraint is updated to also allow seeded messages. </div>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="no_equivocations_additional_constraint_with_pre_loaded">no_equivocations_additional_constraint_with_pre_loaded</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="CasperCBC.VLSM.Composition.html#composite_label">composite_label</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation.IM">IM</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">som</span> : <span class="id"><a href="CasperCBC.VLSM.Composition.html#composite_state">composite_state</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation.IM">IM</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">initial_or_seed</span> := <span class="kwd">fun</span> <span class="id">m</span> =&gt; <span class="id"><a href="CasperCBC.VLSM.Common.html#vinitial_message_prop">vinitial_message_prop</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation.X">X</a></span> <span class="id">m</span> \/ <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation.seeded_composite_vlsm_no_equivocation_definition.seed">seed</a></span> <span class="id">m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_equivocations_except_from">no_equivocations_except_from</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation.X">X</a></span> <span class="id">initial_or_seed</span> <span class="id">l</span> <span class="id">som</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation.constraint">constraint</a></span> <span class="id">l</span> <span class="id">som</span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="composite_no_equivocation_vlsm_with_pre_loaded">composite_no_equivocation_vlsm_with_pre_loaded</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation.message">message</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_vlsm">pre_loaded_vlsm</a></span> (<span class="id"><a href="CasperCBC.VLSM.Composition.html#composite_vlsm">composite_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation.IM">IM</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_equivocations_additional_constraint_with_pre_loaded">no_equivocations_additional_constraint_with_pre_loaded</a></span>) <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation.seeded_composite_vlsm_no_equivocation_definition.seed">seed</a></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="seeded_equivocators_incl_preloaded">seeded_equivocators_incl_preloaded</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM_incl">VLSM_incl</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#composite_no_equivocation_vlsm_with_pre_loaded">composite_no_equivocation_vlsm_with_pre_loaded</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> (<span class="id"><a href="CasperCBC.VLSM.Composition.html#free_composite_vlsm">free_composite_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation.IM">IM</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof300')">Proof.</div>
<div class="proofscript" id="proof300">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#composite_no_equivocation_vlsm_with_pre_loaded">composite_no_equivocation_vlsm_with_pre_loaded</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|- <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM_incl">VLSM_incl</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_vlsm">pre_loaded_vlsm</a></span> ?<span class="id">v</span> <span class="id">_</span>) <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm_is_pre_loaded_with_True">pre_loaded_with_all_messages_vlsm_is_pre_loaded_with_True</a></span> <span class="id">v</span>) <span class="kwd">as</span> <span class="id">Hprev</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM_eq_incl_iff">VLSM_eq_incl_iff</a></span> <span class="kwd">in</span> <span class="id">Hprev</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="kwd">in</span> <span class="id">Hprev</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">Hprev</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM_incl">VLSM_incl</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#mk_vlsm">mk_vlsm</a></span> ?<span class="id">m</span>) <span class="id">_</span> =&gt; <span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM_incl_trans">VLSM_incl_trans</a></span> <span class="kwd">with</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_vlsm_incl">pre_loaded_vlsm_incl</a></span>; <span class="tactic">intros</span>; <span class="tactic">exact</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#I">I</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">Hprev</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM_incl">VLSM_incl</a></span> <span class="id">_</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#mk_vlsm">mk_vlsm</a></span> ?<span class="id">m</span>) =&gt; <span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM_incl_trans">VLSM_incl_trans</a></span> <span class="kwd">with</span> <span class="id">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">assumption</span>| ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Composition.html#free_composite_vlsm">free_composite_vlsm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Composition.html#preloaded_constraint_subsumption_pre_loaded_with_all_messages_incl">preloaded_constraint_subsumption_pre_loaded_with_all_messages_incl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="tactic">intros</span>. <span class="tactic">exact</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#I">I</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Qed.</div>
<br/>
&nbsp;&nbsp;<span class="kwd">End</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation.seeded_composite_vlsm_no_equivocation_definition">seeded_composite_vlsm_no_equivocation_definition</a></span>.<br/>
<br/>
<div class="doc">Adds a no-equivocations condition on top of an existing constraint. </div>
&nbsp;&nbsp;<span class="kwd">Definition</span> <span class="id"><a name="no_equivocations_additional_constraint">no_equivocations_additional_constraint</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">l</span> : <span class="id"><a href="CasperCBC.VLSM.Composition.html#composite_label">composite_label</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation.IM">IM</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">som</span> : <span class="id"><a href="CasperCBC.VLSM.Composition.html#composite_state">composite_state</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation.IM">IM</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_equivocations">no_equivocations</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation.X">X</a></span> <span class="id">l</span> <span class="id">som</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation.constraint">constraint</a></span> <span class="id">l</span> <span class="id">som</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SeededNoeqvFalse</span> := <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#composite_no_equivocation_vlsm_with_pre_loaded">composite_no_equivocation_vlsm_with_pre_loaded</a></span> (<span class="kwd">fun</span> <span class="id">m</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Noeqv</span> := <span class="id"><a href="CasperCBC.VLSM.Composition.html#composite_vlsm">composite_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation.IM">IM</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_equivocations_additional_constraint">no_equivocations_additional_constraint</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="false_composite_no_equivocation_vlsm_with_pre_loaded">false_composite_no_equivocation_vlsm_with_pre_loaded</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM_eq">VLSM_eq</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation.SeededNoeqvFalse">SeededNoeqvFalse</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation.Noeqv">Noeqv</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof301')">Proof.</div>
<div class="proofscript" id="proof301">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#SeededNoeqvFalse">SeededNoeqvFalse</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#composite_no_equivocation_vlsm_with_pre_loaded">composite_no_equivocation_vlsm_with_pre_loaded</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|- <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM_eq">VLSM_eq</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_vlsm">pre_loaded_vlsm</a></span> ?<span class="id">m</span> <span class="id">_</span>) <span class="id">_</span> =&gt; <span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#vlsm_is_pre_loaded_with_False">vlsm_is_pre_loaded_with_False</a></span> <span class="id">m</span>) <span class="kwd">as</span> <span class="id">Heq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM_eq_sym">VLSM_eq_sym</a></span> <span class="kwd">in</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">Heq</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM_eq">VLSM_eq</a></span> <span class="id">_</span> ?<span class="id">v</span> =&gt; <span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM_eq_trans">VLSM_eq_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#machine">machine</a></span> <span class="id">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; [<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM_eq_incl_iff">VLSM_eq_incl_iff</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id"><a href="CasperCBC.VLSM.Composition.html#constraint_subsumption_incl">constraint_subsumption_incl</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation.IM">IM</a></span>) <span class="kwd">as</span> <span class="id">Hincl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">specialize</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hincl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_equivocations_additional_constraint_with_pre_loaded">no_equivocations_additional_constraint_with_pre_loaded</a></span> (<span class="kwd">fun</span> <span class="id">_</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation.message">message</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_equivocations_additional_constraint">no_equivocations_additional_constraint</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hincl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">l</span> <span class="id">som</span>. <span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_equivocations_additional_constraint_with_pre_loaded">no_equivocations_additional_constraint_with_pre_loaded</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> -<span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_equivocations_additional_constraint">no_equivocations_additional_constraint</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_equivocations">no_equivocations</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_equivocations_except_from">no_equivocations_except_from</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">som</span> <span class="kwd">as</span> (<span class="id">s</span>, [<span class="id">m</span>|]); [|<span class="tactic">exact</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#or_assoc">or_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [[<span class="id">H</span>|<span class="id">contra</span>] <span class="id">Hc</span>]; [|<span class="id">contradiction</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">specialize</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hincl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_equivocations_additional_constraint">no_equivocations_additional_constraint</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_equivocations_additional_constraint_with_pre_loaded">no_equivocations_additional_constraint_with_pre_loaded</a></span> (<span class="kwd">fun</span> <span class="id">_</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation.message">message</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hincl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">l</span> <span class="id">som</span>. <span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_equivocations_additional_constraint_with_pre_loaded">no_equivocations_additional_constraint_with_pre_loaded</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> -<span class="id">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_equivocations_additional_constraint">no_equivocations_additional_constraint</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_equivocations">no_equivocations</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#no_equivocations_except_from">no_equivocations_except_from</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">som</span> <span class="kwd">as</span> (<span class="id">s</span>, [<span class="id">m</span>|]); [|<span class="tactic">exact</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#id">id</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#or_assoc">or_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">H</span> <span class="id">Hc</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#seeded_composite_vlsm_no_equivocation">seeded_composite_vlsm_no_equivocation</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="has_been_sent_irrelevance">has_been_sent_irrelevance</a></span>.<br/>
<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Context</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">message</span> : <span class="kwd">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">X</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#VLSM">VLSM</a></span> <span class="id">message</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hbs1</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_capability">has_been_sent_capability</a></span> <span class="id">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hbs2</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_capability">has_been_sent_capability</a></span> <span class="id">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_been_sent1</span> := @<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent">has_been_sent</a></span> <span class="id">_</span> <span class="id">X</span> <span class="id">Hbs1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">has_been_sent2</span> := @<span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent">has_been_sent</a></span> <span class="id">_</span> <span class="id">X</span> <span class="id">Hbs2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;.<br/>
<br/>
&nbsp;&nbsp;<span class="kwd">Lemma</span> <span class="id"><a name="has_been_sent_irrelevance">has_been_sent_irrelevance</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span> : <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_irrelevance.message">message</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hs</span> : <span class="id"><a href="CasperCBC.VLSM.Common.html#protocol_state_prop">protocol_state_prop</a></span> (<span class="id"><a href="CasperCBC.VLSM.Common.html#pre_loaded_with_all_messages_vlsm">pre_loaded_with_all_messages_vlsm</a></span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_irrelevance.X">X</a></span>) <span class="id">s</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_irrelevance.has_been_sent1">has_been_sent1</a></span> <span class="id">s</span> <span class="id">m</span> -&gt; <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_irrelevance.has_been_sent2">has_been_sent2</a></span> <span class="id">s</span> <span class="id">m</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof302')">Proof.</div>
<div class="proofscript" id="proof302">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_sent">proper_sent</a></span> <span class="kwd">in</span> <span class="id">H</span>; [|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#proper_sent">proper_sent</a></span>; [<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="CasperCBC.VLSM.Equivocation.html#has_been_sent_irrelevance">has_been_sent_irrelevance</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
